
<!DOCTYPE html>


  <!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="pt-BR" xmlns:mml="http://www.w3.org/1998/Math/MathML" > <![endif]-->
  <!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang="pt-BR"        xmlns:mml="http://www.w3.org/1998/Math/MathML"> <![endif]-->
  <!--[if IE 8]>         <html class="no-js lt-ie9" lang="pt-BR"               xmlns:mml="http://www.w3.org/1998/Math/MathML"> <![endif]-->
  <!--[if gt IE 8]><!--> <html class="no-js" lang="pt-BR" xmlns:mml="http://www.w3.org/1998/Math/MathML"> <!--<![endif]-->

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0">
    <title>SciELO -  Brasil - Bosons vs. Fermions – A computational complexity perspective Bosons vs. Fermions – A computational complexity perspective </title>

    
  

<!-- social share tags -->
<meta property="og:url" content="http://www.scielo.br/j/rbef/a/JDtGnH8jDn8yCKwXBfFXMpR/?format=html"/>
<meta property="og:type" content="article"/>
<meta property="og:title" content="Bosons vs. Fermions – A computational complexity perspective"/>
<meta property="og:description" content="Recent years have seen a flurry of activity in the fields of quantum computing and quantum..."/>
<meta property="og:image" content="http://www.scielo.br/media/images/rbef_glogo.gif"/>
<!-- social share tags -->

<meta name="citation_author" content="Brod, Daniel Jost">
        
            <meta name="citation_author_affiliation" content="Universidade Federal Fluminense">
        
        
            <meta name="citation_author_orcid" content="http://orcid.org/0000-0002-5925-4158">
        <meta name="citation_journal_title" content="Revista Brasileira de Ensino de Física"></meta>
<meta name="citation_journal_abbrev" content="Rev. Bras. Ensino Fís."></meta>
<meta name="citation_journal_abbrev" content="Rev. Bras. Ens. Fis."></meta>
<meta name="citation_publisher" content="Sociedade Brasileira de Física"></meta>
<meta name="citation_volume" content="43"></meta>
<meta name="citation_pdf_url" content="https://www.scielo.br/j/rbef/a/JDtGnH8jDn8yCKwXBfFXMpR/?lang=en&amp;format=pdf"></meta>
<meta name="citation_xml_url" content="https://www.scielo.br/j/rbef/a/JDtGnH8jDn8yCKwXBfFXMpR/?format=xml&amp;lang=en"></meta>
<meta name="citation_doi" content="10.1590/1806-9126-RBEF-2020-0403"></meta>

<meta name="citation_fulltext_world_readable" content=""></meta>

<meta name="citation_issn" content="1806-1117"></meta>
<meta name="citation_issn" content="1806-9126"></meta>
<meta name="citation_title" content="
            Bosons vs. Fermions – A computational complexity perspective
            "></meta>

<meta name="citation_language" content="en"></meta>

<meta name="citation_abstract" content="Recent years have seen a flurry of activity in the fields of quantum computing and quantum complexity theory, which aim to understand the computational capabilities of quantum systems by applying the toolbox of computational complexity theory. This paper explores the conceptually rich and technologically useful connection between the dynamics of free quantum particles and complexity theory. I review results on the computational power of two simple quantum systems, built out of noninteracting bosons (linear optics) or noninteracting fermions. These rudimentary quantum computers display radically different capabilities—while free fermions are easy to simulate on a classical computer, and therefore devoid of nontrivial computational power, a free-boson computer can perform tasks expected to be classically intractable. To build the argument for these results, I introduce concepts from computational complexity theory. I describe some complexity classes, starting with P and NP and building up to the less common #P and polynomial hierarchy, and the relations between them. I identify how probabilities in free-bosonic and free-fermionic systems fit within this classification, which then underpins their difference in computational power. This paper is aimed at graduate or advanced undergraduate students with a Physics background, hopefully serving as a soft introduction to this exciting and highly evolving field."></meta>
<meta name="citation_article_type" content="research-article"></meta>
<meta name="citation_publication_date" content="2021-03-05"></meta>
<meta name="citation_keywords" content="Quantum computing"></meta><meta name="citation_keywords" content="quantum complexity theory"></meta><meta name="citation_keywords" content="linear optics"></meta><meta name="citation_keywords" content="free fermions"></meta>


    <link rel="icon" href="/static/img/favicon.ico" />
    <link rel="stylesheet" href="/static/css/scielo-bundle.css?v=">
    <link rel="stylesheet" href="/static/css/scielo-bundle-print.css?v=" media="print">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="/static/js/vendor/html5-3.6-respond-1.1.0.min.js"></script>
    <![endif]-->

    
    <!-- Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-MKLVK7B5B6"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-MKLVK7B5B6');
      </script>
      <!-- End Google Analytics -->
    

    
  <link rel="stylesheet" href="/static/css/scielo-article.css" type="text/css" async/>


  </head>
  <body class="journal article">
    <a name="top"></a>

    

  <header>
    <div class="container">
        <div class="topFunction">
            <div class="col-md-2 col-sm-3 mainNav">
                <div class="mainMenu" id="mainMenu">
                    <div class="row">
                        <div class="col-md-7 col-md-offset-2 col-sm-7 col-sm-offset-2 logo"></div>
                    </div>
                    

<nav>
  <ul>
    <li>
      <a href="/">
        <strong>Brasil</strong>
      </a>
      <ul>
          <li>
            <a href="/journals/alpha?status=current" class="tab_link">
              Lista alfabética de periódicos
            </a>
          </li>
          <li>
            <a href="/journals/thematic?status=current" class="tab_link">
              Lista temática de periódicos
            </a>
          </li>
          <li>
            <a href="//search.scielo.org/?q=*&lang=pt&filter[in][]=scl">
              Busca
            </a>
          </li>
          <li>
            <a target="_blank" href="http://analytics.scielo.org/?collection=scl">
              Métricas
            </a>
          </li>
          <li>
            <a href="/about/">
              Sobre: Brasil
            </a>
          </li>
          <li>
            <a href="/about/">
              Contatos
            </a>
          </li>
      </ul>
    </li>
    <li>
      <a target="_blank" href="//www.scielo.org">
        <strong>SciELO.org - Rede SciELO</strong>
      </a>
      <ul>
        <li>
          <a target="_blank" href="//www.scielo.org">
            Coleções nacionais e temáticas
          </a>
        </li>
        <li>
          <a target="_blank" href="//www.scielo.org/pt/periodicos/listar-por-ordem-alfabetica/">
              Lista alfabética de periódicos
          </a>
        </li>
        <li>
          <a target="_blank" href="//www.scielo.org/pt/periodicos/listar-por-assunto/">
              Lista de periódicos por assunto
          </a>
        </li>
        <li>
          <a target="_blank" href="//search.scielo.org/">
            Busca
          </a>
        </li>
        <li>
          <a target="_blank" href="http://analytics.scielo.org">
            Métricas
          </a>
        </li>
        <li>
          <a target="_blank" href="//www.scielo.org/pt/sobre-o-scielo/acesso-via-oai-e-rss/">
              Acesso OAI e RSS
          </a>
        </li>
        <li>
          <a target="_blank" href="//www.scielo.org/pt/sobre-o-scielo/">
              Sobre a Rede SciELO
          </a>
        </li>
        <li>
          <a target="_blank" href="//www.scielo.org/pt/sobre-o-scielo/contato/">
            Contatos
          </a>
        </li>
      </ul>
    </li>
    <li>
      
        <a target="_blank" href="//blog.scielo.org">
      
          <strong>Blog SciELO em Perspectiva</strong>
        </a>
    </li>
  </ul>
</nav>
                </div>
            </div>
        </div>
    </div>
</header>

  


<div class="alternativeHeader hidden-xs">
  <div class="container">
    <div class="col-md-2 col-sm-3 mainNav">
      <a href="" class="menu" data-rel="#alternativeMainMenu" title="Abrir menu">Abrir menu</a>
      <h2 class="logo-svg-mini">
        <a href="/" title="Ir para a homepage da coleção: Brasil">
          <span class="logo-collection logo-collection-svg-mini"><strong>Brasil</strong></span>
        </a>
      </h2>
      <div class="mainMenu" id="alternativeMainMenu">
          <div class="row">
              <div class="col-md-7 col-md-offset-2 col-sm-7 col-sm-offset-2 logo logo-svg"></div>
          </div>
          <nav>
            <ul>
            </ul>
          </nav>
      </div>
    </div>
    <div class="col-md-6 col-sm-6 journalInfo">
      <ul>
        <li>
          <a href="" class="dropdown-toggle" data-toggle="dropdown"><span class="text"><span class="truncate">Revista Brasileira de Ensino de Física </span><span class="sci-ico-arrowDown"></span></a>
          <ul class="dropdown-menu" role="menu">
            <div class="col-md-9 col-sm-8 brandLogo">
              <div class="row">
                <a href="/j/rbef/">
                  
                    <img src="/media/images/rbef_glogo.gif" class="image" alt="Logomarca do periódico: Revista Brasileira de Ensino de Física" />
                  
                </a>
              </div>
            </div>
            <div class="col-md-3 col-sm-4 journalMenu">
              <ul>
                
                  <li>
                    <a href="http://mc04.manuscriptcentral.com/rbef-scielo" target="_blank">
                      <span class="glyphBtn submission"></span> Submissão de manuscritos
                    </a>
                  </li>
                
                <li>
                  <a href="/journal/rbef/about/#about">
                    <span class="glyphBtn about"></span> Sobre o periódico
                  </a>
                </li>
                <li>
                  <a href="/journal/rbef/about/#editors">
                    <span class="glyphBtn editorial"></span> Corpo Editorial
                  </a>
                </li>
                <li>
                  <a href="/journal/rbef/about/#instructions">
                    <span class="glyphBtn authorInstructions"></span> Instruções aos autores
                  </a>
                </li>
                <li>
                  <a href="/journal/rbef/about/#contact">
                    <span class="glyphBtn contact"></span> Contato
                  </a>
                </li>
              </ul>
            </div>
          </ul>
        </li>
      </ul>
    </div>
    <div class="col-md-2 col-md-offset-2 col-sm-3 journalMenu">
      <div class="language">
        
  <a href="/set_locale/es/" class="lang-es" lang="es">Español</a>
  <a href="/set_locale/en/" class="lang-en" lang="en">English</a>





      </div>
    </div>
  </div>
</div>



<div class="alternativeHeader alternativeHeader-xs hidden-sm hidden-md hidden-lg">
  <div class="container">
    <div class="row no-gutter">
      
      <div class="col-xs-2 mainNav">
        <a href="" class="menu" data-rel="#alternativeMainMenu" title="Abrir menu">  Abrir menu
        </a>
        <div class="mainMenu" id="alternativeMainMenu">
          <div class="row">
            <div class="col-md-7 col-md-offset-2 col-sm-7 col-sm-offset-2 logo logo-svg"></div>
          </div>
          <nav>
            <ul>
            </ul>
          </nav>
        </div>
      </div>
      <div class="col-xs-6 text-center">
        
        <h2 class="logo-svg-mini">
          <a href="/" title="Ir para a homepage da coleção: Brasil">
            <span class="logo-collection logo-collection-svg-mini"><strong>Brasil</strong></span>
          </a>
        </h2>

      </div>
      <div class="col-xs-4 language">
        
  <a href="/set_locale/es/" class="lang-es" lang="es">Español</a>
  <a href="/set_locale/en/" class="lang-en" lang="en">English</a>





      </div>

    </div>
    <div class="row">
      
      <div class="col-xs-12 text-center journalNameMobile">
        
        <a href="" class="dropdown-toggle" data-toggle="dropdown"><span class="text"><span class="truncate">Revista Brasileira de Ensino de Física </span><span class="sci-ico-arrowDown"></span></a>

        <ul class="dropdown-menu" role="menu">
            <div class="col-md-9 col-sm-8 brandLogo">
              <div class="row">
                <div class="col-xs-12">
                  <a href="/j/rbef/">
                    
                      <img src="/media/images/rbef_glogo.gif" class="image" alt="Logomarca do periódico: Revista Brasileira de Ensino de Física" />
                    
                  </a>
                </div>
                <div class="col-xs-12">
                  
                  <ul class="JournalMenuMobile">
                    
                      <li>
                        <a href="http://mc04.manuscriptcentral.com/rbef-scielo" target="_blank">
                          <span class="glyphBtn submission"></span> Submissão de manuscritos
                        </a>
                      </li>
                    
                    <li>
                      <a href="/journal/rbef/about/#about">
                        <span class="glyphBtn about"></span> Sobre o periódico
                      </a>
                    </li>
                    <li>
                      <a href="/journal/rbef/about/#editors">
                        <span class="glyphBtn editorial"></span> Corpo Editorial
                      </a>
                    </li>
                    <li>
                      <a href="/journal/rbef/about/#instructions">
                        <span class="glyphBtn authorInstructions"></span> Instruções aos autores
                      </a>
                    </li>
                    <li>
                      <a href="/journal/rbef/about/#contact">
                        <span class="glyphBtn contact"></span> Contato
                      </a>
                    </li>
                  </ul>

                </div>
              </div>
            </div>
        </ul>
        <!--
        <a href="/j/rbef/">
          
            <img src="/media/images/rbef_glogo.gif" class="image" alt="Logomarca do periódico: Revista Brasileira de Ensino de Física" />
          
        </a>
        -->

      </div>

    </div>
  </div>
</div>











  

    <!-- Exibe para todos dispositivos menos mobile -->
<section class="levelMenu hidden-xs">
    <div class="container">
        
        <div class="col-lg-6 col-md-6 col-sm-5">

          <div class="btn-group">
            <a href="/j/rbef/" class="btn">
              <span class="sci-ico-home"></span>
            </a>
            
            
            <a href="/j/rbef/i/2021.v43suppl1/" class="btn group">
                sumário
            </a>

            
              
                <a href="/j/rbef/a/JDtGnH8jDn8yCKwXBfFXMpR/?lang=en&amp;goto=previous" class="btn group hidden-sm">
                
                <span class="hidden-md">&laquo; anterior</span>
                <span class="sci-ico-arrowLeft hidden-lg"></span>
              </a>

            
            <a href="#" class="btn group disabled hidden-sm">
                atual
            </a>

            
            <a href="/j/rbef/a/JDtGnH8jDn8yCKwXBfFXMpR/?lang=en&amp;goto=next" class="btn group hidden-sm">
              <span class="hidden-md">seguinte &raquo;</span>
              <span class="sci-ico-arrowRight hidden-lg"></span>
            </a>

          </div>
        </div>

        <div class="col-lg-4 col-md-5 col-sm-6">
          

    <div class="dropdown">
      <button class="btn dropdown-toggle" type="button" data-toggle="dropdown">
      <span>Resumo
        
          
        
          
        
      </span>
      <span class="caret"></span></button>
      <ul class="dropdown-menu">
        
          <li>
              
                  <a href="/j/rbef/a/JDtGnH8jDn8yCKwXBfFXMpR/abstract/?lang=en">
                    Resumo 
                    
                      (Inglês)
                    
                  </a>
              
          <li>
        
          <li>
              
                  <a href="/j/rbef/a/JDtGnH8jDn8yCKwXBfFXMpR/abstract/?lang=pt">
                    Resumo 
                    
                      (Português)
                    
                  </a>
              
          <li>
        
      </ul>
    </div>


          

    <div class="dropdown">
      <button class="btn dropdown-toggle" type="button" data-toggle="dropdown">
      <span>Texto
        
                  
            
              (EN)
            
          
        
      </span>
      <span class="caret"></span></button>
      <ul class="dropdown-menu">
        
        <li>
          
            <!-- página de texto -->
            <a href="#" class="current"> 
                Texto
                
                  (Inglês)
                
            </a>
        
        </li>
        
      </ul>
    </div>


                    
            <!--
            <a target='_blank' href="/j/rbef/a/JDtGnH8jDn8yCKwXBfFXMpR/?format=pdf&amp;lang=en" class="btn">
              <span class="sci-ico-filePDF"></span> PDF
            </a>
            -->

            <div class="dropdown">
              <button class="btn dropdown-toggle" type="button" data-toggle="dropdown">
              <span class="sci-ico-filePDF"></span>
              <span>PDF</span>
              <span class="caret"></span></button>
              <ul class="dropdown-menu menu-share-mobile">
                
                  <li>
                    <a target='_blank' href="/j/rbef/a/JDtGnH8jDn8yCKwXBfFXMpR/?format=pdf&amp;lang=en">
                      
                        Download PDF (Inglês)
                      
                    </a>
                  </li>
                
              </ul>
            </div>
          

          

          
        </div>

        <div class="col-lg-2 col-md-1 col-sm-1 share">
          <span class="hidden-sm">Compartilhe</span>
            <a href="javascript:;" class="btn dropdown-toggle" data-toggle="dropdown">
              <span class="sci-ico-socialOther"></span><span class="caret"></span>
            </a>
            <ul class="dropdown-menu menu-share-mobile" role="menu">
              <li class="dropdown-header">
                Compartilhe
              </li>
              <li>
                <a href="#" class="share_modal_id">
                  <span class="sci-ico-socialEmail"></span> E-mail
                </a>
              </li>
              <li>
                <a href="#" class="shareFacebook">
                  <span class="sci-ico-socialFacebook"></span> Facebook
                </a>
              </li>
              <li>
                <a href="#" class="shareTwitter">
                  <span class="sci-ico-socialTwitterSingle"></span> Twitter
                </a>
              </li>
              <li>
                <a href="#" class="shareGooglePlus">
                  <span class="glyphBtn googlePlus"></span> Google+
                </a>
              </li>
              <li>
                <a href="#" class="shareLinkedIn">
                  <span class="glyphBtn linkedIn"></span> LinkedIn
                </a>
              </li>
              <li>
                <a href="#" class="shareReddit">
                  <span class="glyphBtn reddit"></span> Reddit
                </a>
              </li>
              <li>
                <a href="#" class="shareStambleUpon">
                  <span class="glyphBtn stambleUpon"></span> StambleUpon
                </a>
              </li>
              <li>
                <a href="#" class="shareCiteULike">
                  <span class="glyphBtn citeULike"></span> CiteULike
                </a>
              </li>
              <li>
                <a href="#" class="shareMendeley">
                  <span class="glyphBtn mendeley"></span> Mendeley
                </a>
              </li>
            </ul>
        </div>

    </div>
</section>


<!-- Exibe somente no mobile -->
<section class="levelMenu levelMenu-xs hidden-sm hidden-md hidden-lg">
    <div class="container">
      <div class="row">
        <div class="col-xs-12">
          <div class="btn-group btn-group-nav-mobile" role="group">
            
            <a href="/j/rbef/" class="btn">
              <span class="sci-ico-home"></span>
            </a>
            <a href="/j/rbef/i/2021.v43suppl1/" class="btn no-ico-util">
              Sumário
            </a>
            <a href="javascript:;" class="btn dropdown-toggle" data-toggle="dropdown">
              <span class="sci-ico-socialOther"></span><span class="caret"></span>
            </a>
            <ul class="dropdown-menu menu-share-mobile" role="menu">
              <li class="dropdown-header">
                Compartilhe
              </li>
              <li>
                <a href="#" class="share_modal_id">
                  <span class="sci-ico-socialEmail"></span> E-mail
                </a>
              </li>
              <li>
                <a href="#" class="shareFacebook">
                  <span class="sci-ico-socialFacebook"></span> Facebook
                </a>
              </li>
              <li>
                <a href="#" class="shareTwitter">
                  <span class="sci-ico-socialTwitterSingle"></span> Twitter
                </a>
              </li>
              <li>
                <a href="#" class="shareGooglePlus">
                  <span class="glyphBtn googlePlus"></span> Google+
                </a>
              </li>
              <li>
                <a href="#" class="shareLinkedIn">
                  <span class="glyphBtn linkedIn"></span> LinkedIn
                </a>
              </li>
              <li>
                <a href="#" class="shareReddit">
                  <span class="glyphBtn reddit"></span> Reddit
                </a>
              </li>
              <li>
                <a href="#" class="shareStambleUpon">
                  <span class="glyphBtn stambleUpon"></span> StambleUpon
                </a>
              </li>
              <li>
                <a href="#" class="shareCiteULike">
                  <span class="glyphBtn citeULike"></span> CiteULike
                </a>
              </li>
              <li>
                <a href="#" class="shareMendeley">
                  <span class="glyphBtn mendeley"></span> Mendeley
                </a>
              </li>
            </ul>

          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-xs-12">
          <div class="btn-group btn-group-nav-mobile-content" role="group">
            

    <div class="dropdown">
      <button class="btn dropdown-toggle" type="button" data-toggle="dropdown">
      <span>Resumo
        
          
        
          
        
      </span>
      <span class="caret"></span></button>
      <ul class="dropdown-menu">
        
          <li>
              
                  <a href="/j/rbef/a/JDtGnH8jDn8yCKwXBfFXMpR/abstract/?lang=en">
                    Resumo 
                    
                      (Inglês)
                    
                  </a>
              
          <li>
        
          <li>
              
                  <a href="/j/rbef/a/JDtGnH8jDn8yCKwXBfFXMpR/abstract/?lang=pt">
                    Resumo 
                    
                      (Português)
                    
                  </a>
              
          <li>
        
      </ul>
    </div>


            

    <div class="dropdown">
      <button class="btn dropdown-toggle" type="button" data-toggle="dropdown">
      <span>Texto
        
                  
            
              (EN)
            
          
        
      </span>
      <span class="caret"></span></button>
      <ul class="dropdown-menu">
        
        <li>
          
            <!-- página de texto -->
            <a href="#" class="current"> 
                Texto
                
                  (Inglês)
                
            </a>
        
        </li>
        
      </ul>
    </div>


                      
            <!--
            <a target='_blank' href="/j/rbef/a/JDtGnH8jDn8yCKwXBfFXMpR/?format=pdf&amp;lang=en" class="btn">
              <span class="sci-ico-filePDF"></span> PDF
            </a>
            -->

            <div class="dropdown">
              <button class="btn dropdown-toggle" type="button" data-toggle="dropdown">
              <span class="sci-ico-filePDF"></span>
              <span>PDF</span>
              <span class="caret"></span></button>
              <ul class="dropdown-menu menu-share-mobile">
                
                  <li>
                    <a target='_blank' href="/j/rbef/a/JDtGnH8jDn8yCKwXBfFXMpR/?format=pdf&amp;lang=en">
                      
                        Download PDF (Inglês)
                      
                    </a>
                  </li>
                
              </ul>
            </div>
          

          

          
          </div>
        </div>
      </div>
    </div>
</section>

    <!-- PID: S1806-11172021000500217 -->
      <!-- Verificando se é versão HTML ou XML -->
      
        
          <div id="standalonearticle">
<section class="articleCtt"><div class="container"><div class="articleTxt">
<div class="articleBadge-editionMeta-doi-copyLink">
<span class="_articleBadge">Special Section</span><span class="_separator"> • </span><span class="_editionMeta">Rev. Bras. Ensino Fís. 43 
                (Suppl 1)
            <span class="_separator"> • </span>2021</span><span class="_separator"> • </span><span class="group-doi"><a href="https://doi.org/10.1590/1806-9126-RBEF-2020-0403" class="_doi" target="_blank">https://doi.org/10.1590/1806-9126-RBEF-2020-0403</a>
         
        <a class="copyLink" data-clipboard-text="https://doi.org/10.1590/1806-9126-RBEF-2020-0403"><span class="sci-ico-link"></span>copy</a></span>
</div>
<h1 class="article-title">
<span class="sci-ico-openAccess showTooltip" data-toggle="tooltip" data-original-title="by 4.0 deed.en"></span>Bosons vs. Fermions – A computational complexity perspective<a id="shorten" href="#" class="short-link"><span class="sci-ico-link"></span></a>
</h1>
<h2 class="article-title">Bósons e Férmions sob a perspectiva da complexidade computacional</h2>
<div class="articleMeta"></div>
<div class="contribGroup">
<span class="dropdown"><a id="contribGroupTutor1" class="dropdown-toggle" data-toggle="dropdown"><span> Daniel Jost Brod </span></a><ul class="dropdown-menu" role="menu" aria-labelledby="contribGrupoTutor1">
<strong></strong><div class="corresp">* Correspondence email address: <a href="mailto:danieljostbrod@id.uff.br">danieljostbrod@id.uff.br</a> </div>Universidade Federal Fluminense, Instituto de Física, Niterói, RJ, Brasil<a href="http://orcid.org/0000-0002-5925-4158" class="btnContribLinks orcid">http://orcid.org/0000-0002-5925-4158</a>
</ul></span><a href="" class="outlineFadeLink" data-toggle="modal" data-target="#ModalTutors">About the author</a>
</div>
<div class="row">
<ul class="col-md-2 hidden-sm articleMenu"></ul>
<article id="articleText" class="col-md-10 col-md-offset-2 col-sm-12 col-sm-offset-0"><div class="articleSection" data-anchor="Abstracts"><h1 class="articleSectionTitle">Abstracts</h1></div>
<div>
<p>Recent years have seen a flurry of activity in the fields of quantum computing and quantum complexity theory, which aim to understand the computational capabilities of quantum systems by applying the toolbox of computational complexity theory.</p>
<p>This paper explores the conceptually rich and technologically useful connection between the dynamics of free quantum particles and complexity theory. I review results on the computational power of two simple quantum systems, built out of noninteracting bosons (linear optics) or noninteracting fermions. These rudimentary quantum computers display radically different capabilities—while free fermions are easy to simulate on a classical computer, and therefore devoid of nontrivial computational power, a free-boson computer can perform tasks expected to be classically intractable.</p>
<p>To build the argument for these results, I introduce concepts from computational complexity theory. I describe some complexity classes, starting with <b>P</b> and <b>NP</b> and building up to the less common #<b>P</b> and polynomial hierarchy, and the relations between them. I identify how probabilities in free-bosonic and free-fermionic systems fit within this classification, which then underpins their difference in computational power.</p>
<p>This paper is aimed at graduate or advanced undergraduate students with a Physics background, hopefully serving as a soft introduction to this exciting and highly evolving field.</p>
<p><strong>Keywords</strong><br>Quantum computing; quantum complexity theory; linear optics; free fermions</p>
</div>
<hr>
<div>
<p>Os últimos anos presenciaram uma atividade crescente nas áreas de computação quântica e teoria de complexidade quântica. Essas áreas têm como objetivo analisar a complexidade e as capacidades computacionais de diversos sistemas quânticos através do uso das ferramentas desenvolvidas, ao longo das últimas décadas, no contexto da teoria de complexidade computacional.</p>
<p>Este artigo explora as conexões conceitualmente ricas e tecnologicamente úteis entre a dinâmica de partículas quânticas livres e a teoria da complexidade. Eu reviso resultados sobre a complexidade computacional da simulação de dois sistemas quânticos simples, construídos com bósons não interagentes (ou seja, óptica linear), ou com férmions não interagentes. Tais sistemas podem ser vistos como tipos rudimentares de computadores quânticos, com potencialidades radicalmente distintas: por um lado, sabe-se que férmions livres são facilmente simulados por um computador clássico e, portanto, desprovidos de poder computacional não trivial; por outro lado, existe forte evidência de que um computador construído a partir de bósons livres pode realizar uma tarefa que é classicamente intratável (ou seja, é capaz de demonstrar vantagem ou supremacia quântica).</p>
<p>A fim de construir os argumentos que fundamentam esses resultados, este artigo oferece uma introdução básica a alguns conceitos do campo da teoria da complexidade computacional. Para isso, eu descrevo algumas classes de complexidade e as relações entre elas, partindo das bem conhecidas <b>P</b> e <b>NP</b>, e avançando para as classes #<b>P</b> e a hierarquia polinomial. Identifico então como as probabilidades de transição nos sistemas de bósons livres e de férmions livres se encaixam nessa classificação, o que fundamenta a diferença em seu poder computacional.</p>
<p>Este artigo foi pensado para estudantes no fim da graduação e na pós-graduação, com formação em Física. Espero que ele sirva como uma introdução leve a este campo fascinante e em rápido desenvolvimento.</p>
<p><strong>Palavras-chaves</strong><br>Computação quâtica; teoria de complexidade quântica; óptica linear; férmions livres</p>
</div>
<hr>
<div class="articleSection" data-anchor="Text">
      <h1 class="articleSectionTitle">1. Introduction</h1>
      <p>Computational complexity theory and quantum mechanics lie at the hearts of two major fields of human study. Computational complexity theory [<span class="ref"><sup class="xref xrefblue">1</sup><span class="refCtt closed"><span>1. S. Arora and B. Barak, Computational Complexity: A Modern Approach (Cambridge University Press, Cambridge, 2009).</span></span></span>] is the subfield of computer science that aims to understand the fundamental nature of computational problems by classifying them according to e.g. how long they take to solve. Its central open question is whether the ability to efficiently <i>check</i> that a solution to a problem is correct implies that a solution is easy to find (the <b>P</b> vs. <b>NP</b> question). This is one of the most important questions in mathematics, and one of the seven Millennium Prize Problems [<span class="ref"><sup class="xref xrefblue">2</sup><span class="refCtt closed"><span>2. https://www.claymath.org/millennium-problems.</span><br><a href="https://www.claymath.org/millennium-problems" target="_blank">https://www.claymath.org/millennium-prob...
            </a></span></span>]. The classes <b>P</b> and <b>NP</b>, though particularly famous, are just two among a rich landscape of complexity classes [<span class="ref"><sup class="xref xrefblue">3</sup><span class="refCtt closed"><span>3. https://complexityzoo.net/Complexity_Zoo.</span><br><a href="https://complexityzoo.net/Complexity_Zoo" target="_blank">https://complexityzoo.net/Complexity_Zoo...
            </a></span></span>] which lay the foundation for our understanding of the notions of computability and computational efficiency. In essence, computational complexity theory aims to understand the limits of what computers can do, a worthwhile goal given how ubiquitous computers are in our daily life and society.</p>
      <p>Quantum mechanics, on the other hand, forms the basis for most of our understanding of the physical world, the standard model of fundamental particles. Despite that, some aspects of it remain not fully understood—even though its mathematical previsions are trusted and sound, there is no consensus on how to interpret them, or how classical mechanics ultimately emerges as its limit. In order to understand this transition better, quantum mechanics has been progressively tested in the limits of large masses [<span class="ref"><sup class="xref xrefblue">4</sup><span class="refCtt closed"><span>4. S. Eibenberger, S. Gerlich, M. Arndt, M. Mayor and J. Tüxen, Phys. Chem. Chem.Phys. 15, 14696 (2013).</span></span></span>], large distances [<span class="ref"><sup class="xref xrefblue">5</sup><span class="refCtt closed"><span>5. D. Salart, A. Baas, J.A.W. van Houwelingen, N. Gisin, and H. Zbinden, Phys. Rev.Lett. 100, 220404 (2008).</span></span></span>] and so on.</p>
      <p>From the intersection of these two fields arose the subfield of quantum computing, and its more abstract cousin, quantum complexity theory [<span class="ref"><sup class="xref xrefblue">6</sup><span class="refCtt closed"><span>6. A.Y. Kitaev, A.H. Shen and M.N. Vyalyi, Classical and Quantum Computation (American Mathematical Society, Rhode Island, 2002).</span></span></span>, <span class="ref"><sup class="xref xrefblue">7</sup><span class="refCtt closed"><span>7. M.A. Nielsen and I.L. Chuang, Quantum Computation and Quantum Information (Cambridge University Press, Cambridge, 2000).</span></span></span>]. Quantum mechanics predicts that quantum computers will be able to solve some computational problems (e.g. factoring large integers) very efficiently [<span class="ref"><sup class="xref xrefblue">8</sup><span class="refCtt closed"><span>8. P.W. Shor, SIAM J. Comput. 26, 1484 (1997).</span></span></span>], whereas complexity theory gives us evidence that these problems cannot be solved efficiently by classical computers [<span class="ref"><sup class="xref xrefblue">1</sup><span class="refCtt closed"><span>1. S. Arora and B. Barak, Computational Complexity: A Modern Approach (Cambridge University Press, Cambridge, 2009).</span></span></span>]. The combination of these two facts has launched the field of quantum computing into rapid growth over the last few decades, and more recently shifted it from a purely academic to an industrial endeavor [<span class="ref"><sup class="xref xrefblue">9</sup><span class="refCtt closed"><span>9. F. Arute, K. Arya, R. Babbush, D. Bacon, J.C. Bardin, R. Barends, R. Biswas, S.Boixo, F.G.S.L. Brandao, D.A. Buell, et al., Nature 574, 505 (2019).</span></span></span>].</p>
      <p>However, the field of quantum computing is still subject to an amount of skepticism, mostly (but not exclusively!) from the side of some computer scientists [<span class="ref"><sup class="xref xrefblue">10</sup><span class="refCtt closed"><span>10. G. Kalai, arXiv:0904.3265 (2009).</span></span></span>, <span class="ref"><sup class="xref xrefblue">11</sup><span class="refCtt closed"><span>11. G. Kalai, arXiv:1106.0485 (2011).</span></span></span>]. Prior to the proposal of quantum computers, a central tenet of complexity theory was the Extended Church-Turing thesis, which states (informally) that all problems efficiently solvable by any realistic model of computation are efficiently solvable by a Turing machine (i.e. by classical computers). This is a useful principle, since it allows us to build a theory of computation that is abstract, and in a sense robust against different definitions of computational models. It will also, of course, be threatened by the construction of a full-purpose large-scale quantum computer. Quantum computing skeptics often argue that, despite all the progress made so far, unavoidable levels of experimental noise will defeat any practical attempt at a large-scale quantum computer.</p>
      <p>This skepticism has motivated the concept of quantum computational advantage, or quantum supremacy [<span class="ref"><sup class="xref xrefblue">12</sup><span class="refCtt closed"><span>12. A.W. Harrow and A. Montanaro, Nature 549, 203 (2017).</span></span></span>, <span class="ref"><sup class="xref xrefblue">13</sup><span class="refCtt closed"><span>13. A.P. Lund, M.J. Bremner and T.C. Ralph, npj Quantum Information 3, 15(2017).</span></span></span>]. This is an approach where the usefulness or applications of quantum computers are temporarily left aside, in favor of constructing the simplest quantum experiment capable of performing some computational task much faster than any classical computer. In a sense, it is the exploration of yet another frontier of quantum mechanics—rather than large masses or distances, it is the frontier of large <i>computational complexity</i>. This has seen impressive recent progress, culminating in an experiment on a 54-qubit quantum computer that allegedly performs a task tens of thousands times faster than the best classical supercomputer [<span class="ref"><sup class="xref xrefblue">9</sup><span class="refCtt closed"><span>9. F. Arute, K. Arya, R. Babbush, D. Bacon, J.C. Bardin, R. Barends, R. Biswas, S.Boixo, F.G.S.L. Brandao, D.A. Buell, et al., Nature 574, 505 (2019).</span></span></span>].</p>
      <p>The main approach in the paradigm of quantum computational advantage is to consider a <i>restricted</i> quantum system, e.g. one that has some limitations in its allowed dynamics which might make it weaker than a full-fledged quantum computer, but still stronger than a classical one, in some sense, and easier to implement in near-future experiments. One of the first examples of such a restricted system was linear optics. A simple experiment, consisting of preparation of single photons, followed by a sequence of beam splitters and culminating in a round of photon number detections, was shown [<span class="ref"><sup class="xref xrefblue">14</sup><span class="refCtt closed"><span>14. S. Aaronson and A. Arkhipov, Theory of Computing 4, 143 (2013).</span></span></span>] to sample from a probability distribution that cannot be reproduced efficiently by a classical computer (modulo some complexity-theoretic conjectures which we will describe in due time). Interestingly, the fermionic analogue of this system, where “beam splitters” are replaced by Hamiltonians quadratic in the fermionic operators (such as hopping Hamiltonians on a lattice), does not have the same complexity—free fermion dynamics is easy to simulate on a classical computer [<span class="ref"><sup class="xref xrefblue">15</sup><span class="refCtt closed"><span>15. B.M. Terhal and D.P. DiVincenzo, Phys. Rev. A 65, 032325 (2002).</span></span></span>, <span class="ref"><sup class="xref xrefblue">16</sup><span class="refCtt closed"><span>16. L.G. Valiant, SIAM J. Comput. 31, 1229 (2002).</span></span></span>].</p>
      <p>In this paper, I review the main results that separate free-boson and free-fermion dynamics (both of which I will refer to as linear optics for simplicity) from a computational complexity theory point of view. It is aimed at graduate or advanced undergraduate students with a Physics background, but no familiarity with computational complexity theory is assumed.</p>
      <p>In section <strong>2</strong>, I review the formalism of second quantization. I suggest that even readers familiar with the formalism take a quick glance at this section, as it defines the assumptions, the physical system and the dynamics we consider, as well as some notation. In section <strong>3</strong>, I give a basic introduction to computational complexity theory and some of the main complexity classes. It is not comprehensive, as I focus only on a cross-section of the theory that I use in the rest of the paper, but it is introductory.</p>
      <p>Section <strong>4</strong> contains the main results I wish to review. In section <strong>4.1</strong>, I define formally what it means, for our purposes, to simulate a quantum system. This definition, together with the structure of complexity classes described previously, culminate in section <strong>4.2</strong>, where I discuss the classical simulability of free fermions, and section <strong>4.3</strong>, where I outline the evidence that (bosonic) linear optics is not classically simulable. Sections <strong>4.2</strong> to <strong>4.3</strong> are the most technical sections of the paper, and can also be of interest to more advanced readers entering the field of quantum computing. In section <strong>4.4</strong> we return to a more leisurely speed, and I discuss the paradigm of quantum computational advantage, or quantum supremacy, reviewing some of its most recent advances. Finally, in section <strong>4.5</strong>, I move briefly beyond linear optics to give some other examples where computational complexity theory and quantum mechanics have interacted, in particular in the context of computing ground states of (interacting) bosonic and fermionic Hamiltonians, and the well-known sign problem from condensed matter and quantum field theory.</p>
      <p><b>Notation:</b> Throughout this paper, I represent by {0,1}<sup><i>n</i></sup> the set of all binary strings of length <i>n</i>. I assume that any mathematical object of interest (an integer, a matrix, a graph) can be encoded in some binary string (see [<span class="ref"><sup class="xref xrefblue">1</sup><span class="refCtt closed"><span>1. S. Arora and B. Barak, Computational Complexity: A Modern Approach (Cambridge University Press, Cambridge, 2009).</span></span></span>], chapter 0, for a careful discussion). If real numbers are involved, we can assume they have been truncated to some desired precision. A Boolean function <i>f</i>(<i>x</i>) is a function that takes as input a binary string <i>x</i> and outputs a single bit. I denote as poly(<i>n</i>) any quantity which is a polynomial in <i>n</i> but whose details are unimportant. We refer to the number of elements of a set <i>S</i> as |<i>S</i>|.</p>
      <p>Here I also assume that ℏ = 1 for simplicity. Though ℏ is an important fundamental constant that sets the scales for many quantum phenomena, from the point of view of computational complexity it is just a constant that does not change e.g. the asymptotic behavior of algorithmic runtimes.</p>
    
      <h1 class="articleSectionTitle">2. The formalism of second quantization</h1>
      <p>Let us begin with a quick review of the formalism used to describe identical quantum particles. This review will serve also to fix notation and situate the readers of various backgrounds on details of the systems I will consider here and the underlying assumptions. For an in-depth discussion of this formalism, see e.g. [<span class="ref"><sup class="xref xrefblue">17</sup><span class="refCtt closed"><span>17. L.E. Ballentine, Quantum Mechanics: A Modern Development (WorldScientific, Singapura, 1998).</span></span></span>].</p>
      <p>In this paper, I will describe bosonic or fermionic systems in the language of second quantization. We are interested only in the particles’ bosonic or fermionic nature, and none of our conclusions depend on other properties such as mass, charge, spin, and so on. Our discussion will be valid for any particle for which the corresponding dynamics, to be described shortly, can be realized.</p>
      
        <h2>2.1. The states</h2>
        <p>Consider a set of creation operators, <math id="INEQ6"><msub><mrow><mo stretchy="false">{</mo><msubsup><mi>a</mi><mi>i</mi><mo>†</mo></msubsup><mo stretchy="false">}</mo></mrow><mrow><mi>i</mi><mo>=</mo><mrow><mn>1</mn><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><mi>m</mi></mrow></mrow></msub></math>, labeled by some discrete index <i>i</i>. We use the letter <i>a</i> for particle operators that can be either bosonic or fermionic. When the situation requires distinction between them, we replace <i>a</i> by <i>b</i>, for bosons, or <i>f</i>, for fermions. Borrowing terminology from quantum optics, we refer to labels <i>i</i> as <i>modes</i>. Physically, these modes could represent any degree of freedom of the particles, such as polarization, wave vector, or time-of-arrival at a detector, for photons, spin or momentum, for an electron, and so on. They could <i>a priori</i> be discrete or continuous but, for the applications we have in mind, we assume that they are discrete.<span class="ref footnote"><sup class="xref">1</sup><span class="refCtt closed"><span class="refCttPadding">
        <strong class="fn-title">1</strong>
        If we refer to a degree of freedom that is continuous, such as direction of propagation, the reader can assume that we are using some suitable coarse-grained discretization of it.
      </span></span></span></p>
        <p>All characteristic bosonic or fermionic behaviors, of which we will see some examples shortly, follow from the canonical commutation relations, given by</p>
        <div class="row formula" id="eS2_Ex1">
<a name="S2_Ex1"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mo stretchy="false">[</mo>
                  <msub>
                    <mi>b</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>,</mo>
                  <msubsup>
                    <mi>b</mi>
                    <mi>j</mi>
                    <mo>†</mo>
                  </msubsup>
                  <mo stretchy="false">]</mo>
                </mrow>
                <mo>=</mo>
                <msub>
                  <mi>δ</mi>
                  <mrow>
                    <mi>i</mi>
                    <mo>⁢</mo>
                    <mi>j</mi>
                  </mrow>
                </msub>
              </mrow>
              <mo>,</mo>
            </mrow>
            <mrow>
              <mrow>
                <mi></mi>
                <mo>=</mo>
                <mn>0</mn>
                <mo>=</mo>
                <mrow>
                  <mo stretchy="false">[</mo>
                  <msubsup>
                    <mi>b</mi>
                    <mi>i</mi>
                    <mo>†</mo>
                  </msubsup>
                  <mo>,</mo>
                  <msubsup>
                    <mi>b</mi>
                    <mi>j</mi>
                    <mo>†</mo>
                  </msubsup>
                  <mo stretchy="false">]</mo>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <div class="row formula" id="eS2_Ex3">
<a name="S2_Ex3"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mi mathvariant="normal">{</mi>
              <msub>
                <mi>f</mi>
                <mi>i</mi>
              </msub>
              <mo>,</mo>
              <msubsup>
                <mi>f</mi>
                <mi>j</mi>
                <mo>†</mo>
              </msubsup>
              <mo stretchy="false">}</mo>
              <mo>=</mo>
              <mi>δ</mi>
              <msub>
                <mi></mi>
                <mrow>
                  <mi>i</mi>
                  <mo>⁢</mo>
                  <mi>j</mi>
                </mrow>
              </msub>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <div class="row formula" id="eS2_Ex4">
<a name="S2_Ex4"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mi mathvariant="normal">{</mi>
              <msub>
                <mi>f</mi>
                <mi>i</mi>
              </msub>
              <mo>,</mo>
              <msub>
                <mi>f</mi>
                <mi>j</mi>
              </msub>
              <mo stretchy="false">}</mo>
              <mo>=</mo>
              <mn>0</mn>
              <mo>=</mo>
              <mo stretchy="false">{</mo>
              <msubsup>
                <mi>f</mi>
                <mi>i</mi>
                <mo>†</mo>
              </msubsup>
              <mo>,</mo>
              <msubsup>
                <mi>f</mi>
                <mi>j</mi>
                <mo>†</mo>
              </msubsup>
              <mo stretchy="false">}</mo>
              <mo>.</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>Suppose now that we have a single mode. From the creation operators we can construct the <i>single-mode</i> Fock states. For bosons, these states are constructed as</p>
        <div class="row formula" id="eS2_Ex5">
<a name="S2_Ex5"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msup>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <msup>
                        <mi>b</mi>
                        <mo>†</mo>
                      </msup>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mi>n</mi>
                  </msup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>0</mn>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msqrt>
                    <mrow>
                      <mi>n</mi>
                      <mo lspace="0pt" rspace="3.5pt">!</mo>
                    </mrow>
                  </msqrt>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>whereas for fermions we have</p>
        <div class="row formula" id="eS2_Ex6">
<a name="S2_Ex6"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msup>
                      <mi>f</mi>
                      <mo>†</mo>
                    </msup>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>0</mn>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mo fence="true" stretchy="false">|</mo>
                  <mn>1</mn>
                  <mo stretchy="false">⟩</mo>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>In both cases |0⟩ is the corresponding vacuum state, defined by the fact that <i>a</i>|0⟩ = 0. The bosonic Fock states satisfy</p>
        <div class="row formula" id="eS2_E1_1">
<a name="S2_E1_1"></a><div class="col-md-12"><div class="formula-container">
          <span class="label">(1a)</span>
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msup>
                    <mi>b</mi>
                    <mo>†</mo>
                  </msup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msqrt>
                    <mrow>
                      <mi>n</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                  </msqrt>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mrow>
                      <mi>n</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <div class="row formula" id="eS2_E1_2">
<a name="S2_E1_2"></a><div class="col-md-12"><div class="formula-container">
          <span class="label">(1b)</span>
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mi>b</mi>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msqrt>
                    <mi>n</mi>
                  </msqrt>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>while for fermionic ones we have</p>
        <div class="row formula" id="eS2_E2_1">
<a name="S2_E2_1"></a><div class="col-md-12"><div class="formula-container">
          <span class="label">(2a)</span>
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msup>
                    <mi>f</mi>
                    <mo>†</mo>
                  </msup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <mi>n</mi>
                      <mo>,</mo>
                      <mn>0</mn>
                    </mrow>
                  </msub>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mrow>
                      <mi>n</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <div class="row formula" id="eS2_E2_2">
<a name="S2_E2_2"></a><div class="col-md-12"><div class="formula-container">
          <span class="label">(2b)</span>
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mi>f</mi>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <mi>n</mi>
                      <mo>,</mo>
                      <mn>1</mn>
                    </mrow>
                  </msub>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>In both cases, we have that</p>
        <div class="row formula" id="eS2_Ex7">
<a name="S2_Ex7"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msup>
                    <mi>a</mi>
                    <mo>†</mo>
                  </msup>
                  <mo>⁢</mo>
                  <mi>a</mi>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mi>n</mi>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>From the above equations it is clear why <i>a</i><sup>†</sup>, <i>a</i> and <i>n</i>:=<i>a</i><sup>†</sup><i>a</i> are referred to as creation, annihilation and number operators, respectively.</p>
        <p>When we have <i>m</i> modes in total, these equations are replaced by a natural generalization. If again we define the vacuum state as the unique state for which <i>a</i><sub><i>k</i></sub>|0⟩ = 0 for all <i>k</i>, the bosonic Fock states are constructed as</p>
        <div class="row formula" id="eS2_Ex8">
<a name="S2_Ex8"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <munderover>
                    <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>=</mo>
                      <mn>1</mn>
                    </mrow>
                    <mi>m</mi>
                  </munderover>
                  <mrow>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <msubsup>
                          <mi>b</mi>
                          <mi>i</mi>
                          <mo>†</mo>
                        </msubsup>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <msub>
                        <mi>n</mi>
                        <mi>i</mi>
                      </msub>
                    </msup>
                    <mo>⁢</mo>
                    <mrow>
                      <mo fence="true" stretchy="false">|</mo>
                      <mn>0</mn>
                      <mo stretchy="false">⟩</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msup>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <munderover>
                          <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
                          <mrow>
                            <mi>i</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mi>m</mi>
                        </munderover>
                        <mrow>
                          <msub>
                            <mi>n</mi>
                            <mi>i</mi>
                          </msub>
                          <mo lspace="0pt" rspace="3.5pt">!</mo>
                        </mrow>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mfrac>
                      <mn>1</mn>
                      <mn>2</mn>
                    </mfrac>
                  </msup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>N</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>where <i>N</i> is a shorthand for (<i>n</i><sub>1</sub>,<i>n</i><sub>2</sub>…<i>n</i><sub><i>m</i></sub>). Generalizing equations (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E1_1"><span class="sci-ico-fileFormula"></span>1</a>) to more than one bosonic mode, we have</p>
        <div class="row formula" id="eS2_Ex9">
<a name="S2_Ex9"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msubsup>
                    <mi>b</mi>
                    <mi>i</mi>
                    <mo>†</mo>
                  </msubsup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>N</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msqrt>
                    <mrow>
                      <msub>
                        <mi>n</mi>
                        <mi>i</mi>
                      </msub>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                  </msqrt>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mrow>
                      <msub>
                        <mi>n</mi>
                        <mn>1</mn>
                      </msub>
                      <mo>,</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>,</mo>
                      <mrow>
                        <msub>
                          <mi>n</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>,</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>,</mo>
                      <msub>
                        <mi>n</mi>
                        <mi>m</mi>
                      </msub>
                    </mrow>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <div class="row formula" id="eS2_Ex10">
<a name="S2_Ex10"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msubsup>
                    <mi>b</mi>
                    <mi>i</mi>
                    <mo>†</mo>
                  </msubsup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>N</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msqrt>
                    <msub>
                      <mi>n</mi>
                      <mi>i</mi>
                    </msub>
                  </msqrt>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mrow>
                      <msub>
                        <mi>n</mi>
                        <mn>1</mn>
                      </msub>
                      <mo>,</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>,</mo>
                      <mrow>
                        <msub>
                          <mi>n</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>,</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>,</mo>
                      <msub>
                        <mi>n</mi>
                        <mi>m</mi>
                      </msub>
                    </mrow>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>For fermions, the Fock states are constructed as</p>
        <div class="row formula" id="eS2_Ex11">
<a name="S2_Ex11"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msup>
                    <mrow>
                      <mo>(</mo>
                      <msubsup>
                        <mi>f</mi>
                        <mn>1</mn>
                        <mo>†</mo>
                      </msubsup>
                      <mo>)</mo>
                    </mrow>
                    <msub>
                      <mi>n</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                  <mo>⁢</mo>
                  <msup>
                    <mrow>
                      <mo>(</mo>
                      <msubsup>
                        <mi>f</mi>
                        <mn>2</mn>
                        <mo>†</mo>
                      </msubsup>
                      <mo>)</mo>
                    </mrow>
                    <msub>
                      <mi>n</mi>
                      <mn>2</mn>
                    </msub>
                  </msup>
                  <mo>⁢</mo>
                  <mi mathvariant="normal">…</mi>
                  <mo>⁢</mo>
                  <msup>
                    <mrow>
                      <mo>(</mo>
                      <msubsup>
                        <mi>f</mi>
                        <mi>m</mi>
                        <mo>†</mo>
                      </msubsup>
                      <mo>)</mo>
                    </mrow>
                    <msub>
                      <mi>n</mi>
                      <mi>m</mi>
                    </msub>
                  </msup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>0</mn>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mo fence="true" stretchy="false">|</mo>
                  <mi>N</mi>
                  <mo stretchy="false">⟩</mo>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>Similarly, we can generalize equations (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E2_1"><span class="sci-ico-fileFormula"></span>2</a>) for more than one fermionic mode:</p>
        <div class="row formula" id="eS2_Ex12">
<a name="S2_Ex12"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msubsup>
                    <mi>f</mi>
                    <mi>i</mi>
                    <mo>†</mo>
                  </msubsup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>N</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <msub>
                        <mi>n</mi>
                        <mi>i</mi>
                      </msub>
                      <mo>,</mo>
                      <mn>0</mn>
                    </mrow>
                  </msub>
                  <mo>⁢</mo>
                  <msup>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mrow>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mstyle displaystyle="false">
                        <msub>
                          <mo largeop="true" symmetric="true">∑</mo>
                          <mrow>
                            <mi>j</mi>
                            <mo>&lt;</mo>
                            <mi>i</mi>
                          </mrow>
                        </msub>
                      </mstyle>
                      <msub>
                        <mi>n</mi>
                        <mi>j</mi>
                      </msub>
                    </mrow>
                  </msup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mrow>
                      <msub>
                        <mi>n</mi>
                        <mn>1</mn>
                      </msub>
                      <mo>,</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>,</mo>
                      <mrow>
                        <msub>
                          <mi>n</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>,</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>,</mo>
                      <msub>
                        <mi>n</mi>
                        <mi>m</mi>
                      </msub>
                    </mrow>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <div class="row formula" id="eS2_Ex13">
<a name="S2_Ex13"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msub>
                    <mi>f</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>N</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <msub>
                        <mi>n</mi>
                        <mi>i</mi>
                      </msub>
                      <mo>,</mo>
                      <mn>1</mn>
                    </mrow>
                  </msub>
                  <mo>⁢</mo>
                  <msup>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mrow>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mstyle displaystyle="false">
                        <msub>
                          <mo largeop="true" symmetric="true">∑</mo>
                          <mrow>
                            <mi>j</mi>
                            <mo>&lt;</mo>
                            <mi>i</mi>
                          </mrow>
                        </msub>
                      </mstyle>
                      <msub>
                        <mi>n</mi>
                        <mi>j</mi>
                      </msub>
                    </mrow>
                  </msup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mrow>
                      <msub>
                        <mi>n</mi>
                        <mn>1</mn>
                      </msub>
                      <mo>,</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>,</mo>
                      <mrow>
                        <msub>
                          <mi>n</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>,</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>,</mo>
                      <msub>
                        <mi>n</mi>
                        <mi>m</mi>
                      </msub>
                    </mrow>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>In both cases,</p>
        <div class="row formula" id="eS2_Ex14">
<a name="S2_Ex14"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msubsup>
                    <mi>a</mi>
                    <mi>i</mi>
                    <mo>†</mo>
                  </msubsup>
                  <mo>⁢</mo>
                  <msub>
                    <mi>a</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>N</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msub>
                    <mi>n</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>N</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>We refer to the Fock space as the space spanned by all Fock states on these <i>m</i> modes.</p>
        <p>For the benefit of the reader that is more familiar with the language of first quantization, let us give a brief example that connects these two formalisms. Suppose we have particles that can have one of two values for some quantum number. These can represent horizontal or vertical polarizations of a photon, up or down <i>Z</i> components of electron spins, and so on, but let us label them 0 and 1 for simplicity. In a first-quantized notation, if we have a single of these particles, we would represent the two corresponding states as |0⟩<sub>1</sub> and |1⟩<sub>1</sub> (where the label <i>1</i> indicates this state is written in first quantization).</p>
        <p>Suppose now we have two of these particles, and they are in a state where each assumes a different value for this quantum number. If the particles are distinguishable, this could correspond to either state |01⟩<sub>1</sub> or |10⟩<sub>1</sub>, or in fact any superposition of them. However, if the particles are bosons (fermions), then this state must be symmetric (antisymmetric) under particle exchange, so we would write it as:</p>
        <div class="row formula" id="eS2_Ex15">
<a name="S2_Ex15"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mfrac>
                  <mn>1</mn>
                  <msqrt>
                    <mn>2</mn>
                  </msqrt>
                </mfrac>
                <mo>⁢</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <msub>
                      <mrow>
                        <mo fence="true" stretchy="false">|</mo>
                        <mn>01</mn>
                        <mo stretchy="false">⟩</mo>
                      </mrow>
                      <mn>1</mn>
                    </msub>
                    <mo>+</mo>
                    <msub>
                      <mrow>
                        <mo fence="true" stretchy="false">|</mo>
                        <mn>10</mn>
                        <mo stretchy="false">⟩</mo>
                      </mrow>
                      <mn>1</mn>
                    </msub>
                  </mrow>
                  <mo rspace="0.8pt">)</mo>
                </mrow>
              </mrow>
              <mo>,</mo>
              <mtext> for bosons, and</mtext>
            </mrow>
          </math>
        </div></div>
</div>
        <div class="row formula" id="eS2_Ex16">
<a name="S2_Ex16"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mfrac>
                  <mn>1</mn>
                  <msqrt>
                    <mn>2</mn>
                  </msqrt>
                </mfrac>
                <mo>⁢</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <msub>
                      <mrow>
                        <mo fence="true" stretchy="false">|</mo>
                        <mn>01</mn>
                        <mo stretchy="false">⟩</mo>
                      </mrow>
                      <mn>1</mn>
                    </msub>
                    <mo>-</mo>
                    <msub>
                      <mrow>
                        <mo fence="true" stretchy="false">|</mo>
                        <mn>10</mn>
                        <mo stretchy="false">⟩</mo>
                      </mrow>
                      <mn>1</mn>
                    </msub>
                  </mrow>
                  <mo rspace="0.8pt">)</mo>
                </mrow>
              </mrow>
              <mo>,</mo>
              <mtext> for fermions.</mtext>
            </mrow>
          </math>
        </div></div>
</div>
        <p>In the second quantization formalism we reviewed, states are identified instead by the occupation number of each mode. In this example, the modes are identified with the quantum numbers {0,1}. <i>Both</i> states are written simply as |11⟩, and the information about the <i>symmetry</i> of the wave function is encoded in the corresponding bosonic or fermionic commutation relations.</p>
        
          <h3>2.1.1. Fock space dimension</h3>
          <p>What are the dimensions of the Fock spaces described so far? In principle, for fermions the dimension is 2<sup><i>m</i></sup>, while for bosons it is infinite, as there can be arbitrarily many bosons in even a single mode. However, the dynamics we consider here always preserves the total number of particles, and so we can restrict ourselves to the subspaces of fixed total particle number<span class="ref footnote"><sup class="xref">2</sup><span class="refCtt closed"><span class="refCttPadding">
        <strong class="fn-title">2</strong>
        Some readers might object to this, given that second quantization was developed precisely to deal with states with varying particle numbers. Though that might be historically accurate, this does not mean that this formalism cannot prove valuable in other circumstances. Hopefully this paper showcases an example where second quantization is the appropriate description even in the case of fixed particle number, as most of what we discuss would be considerably more complex to write in first quantization.
      </span></span></span>.</p>
          <p>Let us denote the set of all configurations of <i>n</i> fermions in <i>m</i> modes as <i>F</i><sub><i>m,n</i></sub>, and its bosonic analogue as <i>B</i><sub><i>m,n</i></sub>. The size of <i>F</i><sub><i>m,n</i></sub>, which we denote |<i>F</i><sub><i>m</i>,<i>n</i></sub>|, just corresponds to the number of permutations of <i>m</i> objects, out of which <i>n</i> are identical (the occupied modes), and the remaining <i>m-n</i> are also identical (the empty modes). Therefore</p>
          <div class="row formula" id="eS2_Ex17">
<a name="S2_Ex17"></a><div class="col-md-12"><div class="formula-container">
            <math display="block">
              <mrow>
                <mo fence="true">|</mo>
                <msub>
                  <mi>F</mi>
                  <mrow>
                    <mi>m</mi>
                    <mo>,</mo>
                    <mi>n</mi>
                  </mrow>
                </msub>
                <mrow>
                  <mo fence="true" stretchy="false">|</mo>
                  <mo>=</mo>
                  <mfrac>
                    <mrow>
                      <mi>m</mi>
                      <mo lspace="0pt" rspace="3.5pt">!</mo>
                    </mrow>
                    <mrow>
                      <mrow>
                        <mi>n</mi>
                        <mo lspace="0pt" rspace="3.5pt">!</mo>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <mrow>
                            <mi>m</mi>
                            <mo>-</mo>
                            <mi>n</mi>
                          </mrow>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mo lspace="0pt" rspace="3.5pt">!</mo>
                      </mrow>
                    </mrow>
                  </mfrac>
                  <mo>=</mo>
                  <mpadded width="-1.7pt">
                    <mrow>
                      <mo>(</mo>
                      <mfrac linethickness="0pt">
                        <mi>m</mi>
                        <mi>n</mi>
                      </mfrac>
                      <mo>)</mo>
                    </mrow>
                  </mpadded>
                  <mo>.</mo>
                </mrow>
              </mrow>
            </math>
          </div></div>
</div>
          <p>For bosons, we need to count all ways to drop <i>n</i> identical balls in <i>m</i> bins, and so</p>
          <div class="row formula" id="eS2_Ex18">
<a name="S2_Ex18"></a><div class="col-md-12"><div class="formula-container">
            <math display="block">
              <mrow>
                <mo fence="true">|</mo>
                <msub>
                  <mi>B</mi>
                  <mrow>
                    <mi>m</mi>
                    <mo>,</mo>
                    <mi>n</mi>
                  </mrow>
                </msub>
                <mrow>
                  <mo fence="true" stretchy="false">|</mo>
                  <mo>=</mo>
                  <mfrac>
                    <mrow>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mrow>
                          <mrow>
                            <mi>m</mi>
                            <mo>+</mo>
                            <mi>n</mi>
                          </mrow>
                          <mo>-</mo>
                          <mn>1</mn>
                        </mrow>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo lspace="0pt" rspace="3.5pt">!</mo>
                    </mrow>
                    <mrow>
                      <mrow>
                        <mi>n</mi>
                        <mo lspace="0pt" rspace="3.5pt">!</mo>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <mrow>
                            <mi>m</mi>
                            <mo>-</mo>
                            <mn>1</mn>
                          </mrow>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mo lspace="0pt" rspace="3.5pt">!</mo>
                      </mrow>
                    </mrow>
                  </mfrac>
                  <mo>=</mo>
                  <mpadded width="-1.7pt">
                    <mrow>
                      <mo>(</mo>
                      <mfrac linethickness="0pt">
                        <mrow>
                          <mrow>
                            <mi>m</mi>
                            <mo>+</mo>
                            <mi>n</mi>
                          </mrow>
                          <mo>-</mo>
                          <mn>1</mn>
                        </mrow>
                        <mi>n</mi>
                      </mfrac>
                      <mo>)</mo>
                    </mrow>
                  </mpadded>
                  <mo>.</mo>
                </mrow>
              </mrow>
            </math>
          </div></div>
</div>
          <p>For reasons that will become clear in due time, it is sometimes convenient to consider a restriction on the bosonic Fock space to only no-collision states, i.e., those in which <i>n</i><sub><i>i</i></sub>≤1. We denote this space as <math id="INEQ22"><msubsup><mi>B</mi><mrow><mi>m</mi><mo>,</mo><mi>n</mi></mrow><mo>*</mo></msubsup></math>, and note that <math id="INEQ23"><mrow><mo fence="true" stretchy="false">|</mo><msubsup><mi>B</mi><mrow><mi>m</mi><mo>,</mo><mi>n</mi></mrow><mo>*</mo></msubsup><mrow><mo fence="true" stretchy="false">|</mo><mo>=</mo><mrow><mo fence="true" stretchy="false">|</mo><msub><mi>F</mi><mrow><mi>m</mi><mo>,</mo><mi>n</mi></mrow></msub><mo fence="true" stretchy="false">|</mo></mrow></mrow></mrow></math>.</p>
          <p>Unless <i>n</i> is very small (or, for fermions, if either <i>n</i> or <i>m-n</i> is small), both <i>B</i><sub><i>m,n</i></sub> and <i>F</i><sub><i>m,n</i></sub> grow exponentially in dimension as we increase the number of particles and modes. This is identified as one reason why quantum systems are hard to simulate on classical computers, and why quantum computers might be better at this task [<span class="ref"><sup class="xref xrefblue">7</sup><span class="refCtt closed"><span>7. M.A. Nielsen and I.L. Chuang, Quantum Computation and Quantum Information (Cambridge University Press, Cambridge, 2000).</span></span></span>, <span class="ref"><sup class="xref xrefblue">18</sup><span class="refCtt closed"><span>18. R.P. Feynman, Int. J. Theo. Phys. 21, 467 (1982).</span></span></span>]. However, it cannot be the <i>only</i> reason, since a system of <i>n</i> classical particles in <i>m</i> bins also has an exponentially large configuration space (even larger than <i>B</i><sub><i>m,n</i></sub> if we attach labels to the classical particles, such that they are distinguishable!). In order to see complexity arise, let us move to the matter of <i>dynamics</i>.</p>
        
      
      
        <h2>2.2. Bosonic and fermionic linear optics</h2>
        <p>In principle, quantum mechanics allows for arbitrary unitary transformations in Fock space. However, we are interested in the computational complexity of identical particles in a much more restricted settings, that of <i>linear optics</i>.</p>
        <p>Suppose we have <i>m</i> modes associated with either bosonic or fermionic particles. A linear-optical transformation will be defined by an <i>m</i>×<i>m</i> matrix <i>U</i> such that the evolution of the particle operators in the Heisenberg representation is given by</p>
        <div class="row formula" id="eS2_E3">
<a name="S2_E3"></a><div class="col-md-12"><div class="formula-container">
          <span class="label">(3)</span>
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msub>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <msubsup>
                        <mi>a</mi>
                        <mi>i</mi>
                        <mo>†</mo>
                      </msubsup>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mtext>out</mtext>
                      <mtext mathsize="142%"> </mtext>
                    </mrow>
                  </msub>
                  <mo>=</mo>
                  <mrow>
                    <munderover>
                      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                      <mrow>
                        <mi>j</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mi>m</mi>
                    </munderover>
                    <mrow>
                      <msub>
                        <mi>U</mi>
                        <mrow>
                          <mi>i</mi>
                          <mo>⁢</mo>
                          <mi>j</mi>
                        </mrow>
                      </msub>
                      <mo>⁢</mo>
                      <msub>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <msubsup>
                            <mi>a</mi>
                            <mi>j</mi>
                            <mo>†</mo>
                          </msubsup>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mrow>
                          <mtext>in</mtext>
                          <mtext mathsize="142%"> </mtext>
                        </mrow>
                      </msub>
                    </mrow>
                  </mrow>
                </mrow>
                <mo rspace="12.5pt">,</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mrow>
                    <mn>1</mn>
                    <mo>,</mo>
                    <mn>2</mn>
                    <mo>,</mo>
                    <mi mathvariant="normal">…</mi>
                    <mo>,</mo>
                    <mi>m</mi>
                  </mrow>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>Transformations such as equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E3"><span class="sci-ico-fileFormula"></span>3</a>) are also often referred to as Bogoliubov transformations, or free-particle or noninteracting-particle evolutions. We will restrict ourselves to discrete-time transformations, in terms of incoming and outgoing operators, rather than a continuous-time evolution. This is standard practice in the fields of quantum information and quantum optics,<span class="ref footnote"><sup class="xref">3</sup><span class="refCtt closed"><span class="refCttPadding">
        <strong class="fn-title">3</strong>
        It can also be thought of as a discretized version of the standard scattering formalism.
      </span></span></span> and can be done without loss of generality, since every unitary matrix can be written as the complex exponential of some Hamiltonian. The Hamiltonian which generates an arbitrary linear-optical evolution can be written as</p>
        <div class="row formula" id="eS2_E4">
<a name="S2_E4"></a><div class="col-md-12"><div class="formula-container">
          <span class="label">(4)</span>
          <math display="block">
            <mrow>
              <mrow>
                <mi>H</mi>
                <mo>=</mo>
                <mrow>
                  <munder>
                    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>⁢</mo>
                      <mi>j</mi>
                    </mrow>
                  </munder>
                  <mrow>
                    <msub>
                      <mi>h</mi>
                      <mrow>
                        <mi>i</mi>
                        <mo>⁢</mo>
                        <mi>j</mi>
                      </mrow>
                    </msub>
                    <mo>⁢</mo>
                    <msub>
                      <mi>a</mi>
                      <mi>i</mi>
                    </msub>
                    <mo>⁢</mo>
                    <msubsup>
                      <mi>a</mi>
                      <mi>j</mi>
                      <mo>†</mo>
                    </msubsup>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>where <i>h</i> is an <i>m</i>×<i>m</i> Hermitian matrix. These Hamiltonians can represent, for example, beam splitters or phase shifters in linear optics, or hopping terms between sites for particles in a lattice.</p>
        <p>Let us prove that this Hamiltonian gives rise to an evolution as in equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E3"><span class="sci-ico-fileFormula"></span>3</a>) in the bosonic case (the fermionic case is analogous, and we leave the proof for the interested reader). To that end, consider the Heisenberg equation for a set of (time-dependent) operators <math id="INEQ26"><mrow><msubsup><mi>b</mi><mi>i</mi><mo>†</mo></msubsup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow></math>, such that <math id="INEQ27"><mrow><msub><mrow><mo stretchy="false">(</mo><msubsup><mi>b</mi><mi>j</mi><mo>†</mo></msubsup><mo stretchy="false">)</mo></mrow><mrow><mtext>in</mtext><mtext mathsize="142%"> </mtext></mrow></msub><mo>:=</mo><mrow><msubsup><mi>b</mi><mi>i</mi><mo>†</mo></msubsup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></math>:</p>
        <div class="row formula" id="eS2_Ex19">
<a name="S2_Ex19"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mfrac>
                  <mi>d</mi>
                  <mrow>
                    <mi>d</mi>
                    <mo>⁢</mo>
                    <mi>t</mi>
                  </mrow>
                </mfrac>
                <mo>⁢</mo>
                <msubsup>
                  <mi>b</mi>
                  <mi>i</mi>
                  <mo>†</mo>
                </msubsup>
                <mo>⁢</mo>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <mi>t</mi>
                  <mo stretchy="false">)</mo>
                </mrow>
              </mrow>
              <mo>=</mo>
              <mrow>
                <mpadded width="+0.6pt">
                  <mi mathvariant="normal">i</mi>
                </mpadded>
                <mo>⁢</mo>
                <mrow>
                  <mo stretchy="false">[</mo>
                  <mi>H</mi>
                  <mo>,</mo>
                  <mrow>
                    <msubsup>
                      <mi>b</mi>
                      <mi>i</mi>
                      <mo>†</mo>
                    </msubsup>
                    <mo>⁢</mo>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>t</mi>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </mrow>
                  <mo stretchy="false">]</mo>
                </mrow>
              </mrow>
            </mrow>
          </math>
        </div></div>
</div>
        <p>By using the bosonic commutation relations we can write this as</p>
        <div class="row formula" id="eS2_Ex20">
<a name="S2_Ex20"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mfrac>
                  <mi>d</mi>
                  <mrow>
                    <mi>d</mi>
                    <mo>⁢</mo>
                    <mi>t</mi>
                  </mrow>
                </mfrac>
                <mo>⁢</mo>
                <msubsup>
                  <mi>b</mi>
                  <mi>i</mi>
                  <mo>†</mo>
                </msubsup>
                <mo>⁢</mo>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <mi>t</mi>
                  <mo stretchy="false">)</mo>
                </mrow>
              </mrow>
              <mo>=</mo>
              <mrow>
                <mpadded width="+0.6pt">
                  <mi mathvariant="normal">i</mi>
                </mpadded>
                <mo>⁢</mo>
                <mrow>
                  <munder>
                    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                    <mi>j</mi>
                  </munder>
                  <mrow>
                    <msub>
                      <mi>h</mi>
                      <mrow>
                        <mi>i</mi>
                        <mo>⁢</mo>
                        <mi>j</mi>
                      </mrow>
                    </msub>
                    <mo>⁢</mo>
                    <msubsup>
                      <mi>b</mi>
                      <mi>j</mi>
                      <mo>†</mo>
                    </msubsup>
                    <mo>⁢</mo>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>t</mi>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </math>
        </div></div>
</div>
        <p>Since <i>h</i> is Hermitian, the solution to this set of coupled first-order differential equations is simply</p>
        <div class="row formula" id="eS2_Ex21">
<a name="S2_Ex21"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <msubsup>
                  <mi>b</mi>
                  <mi>i</mi>
                  <mo>†</mo>
                </msubsup>
                <mo>⁢</mo>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <mi>t</mi>
                  <mo stretchy="false">)</mo>
                </mrow>
              </mrow>
              <mo>=</mo>
              <mrow>
                <munder>
                  <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                  <mi>j</mi>
                </munder>
                <mrow>
                  <msub>
                    <mi>U</mi>
                    <mrow>
                      <mi>i</mi>
                      <mo>⁢</mo>
                      <mi>j</mi>
                    </mrow>
                  </msub>
                  <mo>⁢</mo>
                  <msubsup>
                    <mi>b</mi>
                    <mi>j</mi>
                    <mo>†</mo>
                  </msubsup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <mn>0</mn>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </math>
        </div></div>
</div>
        <p>where <i>U</i> = <i>exp</i>⁡(i<i>ht</i>) ∈ <i>SU</i>(<i>m</i>). Since <i>t</i> is just a parameter, we can set it to 1 such that <math id="INEQ29"><mrow><msub><mrow><mo stretchy="false">(</mo><msubsup><mi>b</mi><mi>j</mi><mo>†</mo></msubsup><mo stretchy="false">)</mo></mrow><mrow><mtext>out</mtext><mtext mathsize="142%"> </mtext></mrow></msub><mo>:=</mo><mrow><msubsup><mi>b</mi><mi>i</mi><mo>†</mo></msubsup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></mrow></math>. This shows we can generate the whole of <i>SU</i>(<i>m</i>) by tuning <i>h</i> in equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E4"><span class="sci-ico-fileFormula"></span>4</a>).</p>
        <p>Note that <i>U</i> is <b>not</b> an unitary evolution operator acting on the Fock space, it is simply a matrix that describes the linear evolution of the creation operators as per equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E3"><span class="sci-ico-fileFormula"></span>3</a>). In particular, while the Fock spaces for <i>n</i> particles in <i>m</i> modes are exponentially large, <i>U</i> has only roughly <i>m</i><sup>2</sup> free parameters. This shows that considering only linear-optical dynamics is a very restrictive setting. Furthermore, these transformations cover only an exponentially small corner of the space they inhabit, which creates a tension with the argument, from the previous section, of hardness of simulation based on the <i>dimensionality</i> of the Fock space.</p>
        <p>As we will see, the complexity of these systems is dictated neither by the Fock space being too large nor by the operator space of linear optics being too small. In order to understand the actual complexity of these systems, we need to look more closely at how their transition probabilities behave.</p>
        
          <h3>2.2.1. Elementary linear-optical elements</h3>
          <p>Let us now illustrate the use of the second quantization formalism by analyzing simple two-mode transformations. We consider, as elementary transformations, the <i>beam splitter</i> and the <i>phase shifter</i> (borrowing nomenclature from linear optics). The phase shifter acts on a single mode and is defined by the following Hamiltonian</p>
          <div class="row formula" id="eS2_Ex22">
<a name="S2_Ex22"></a><div class="col-md-12"><div class="formula-container">
            <math display="block">
              <mrow>
                <mrow>
                  <msub>
                    <mi>H</mi>
                    <mrow>
                      <mi>P</mi>
                      <mo>⁢</mo>
                      <mi>S</mi>
                    </mrow>
                  </msub>
                  <mo>=</mo>
                  <mrow>
                    <mi>ϕ</mi>
                    <mo>⁢</mo>
                    <msup>
                      <mi>a</mi>
                      <mo>†</mo>
                    </msup>
                    <mo>⁢</mo>
                    <mi>a</mi>
                  </mrow>
                </mrow>
                <mo>,</mo>
              </mrow>
            </math>
          </div></div>
</div>
          <p>or correspondingly</p>
          <div class="row formula" id="eS2_Ex23">
<a name="S2_Ex23"></a><div class="col-md-12"><div class="formula-container">
            <math display="block">
              <mrow>
                <mrow>
                  <msub>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <msup>
                        <mi>a</mi>
                        <mo>†</mo>
                      </msup>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mtext>out</mtext>
                      <mtext mathsize="142%"> </mtext>
                    </mrow>
                  </msub>
                  <mo>=</mo>
                  <mrow>
                    <msup>
                      <mi>e</mi>
                      <mrow>
                        <mpadded width="+0.6pt">
                          <mi mathvariant="normal">i</mi>
                        </mpadded>
                        <mo>⁢</mo>
                        <mi>ϕ</mi>
                      </mrow>
                    </msup>
                    <mo>⁢</mo>
                    <msub>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <msup>
                          <mi>a</mi>
                          <mo>†</mo>
                        </msup>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mrow>
                        <mtext>in</mtext>
                        <mtext mathsize="142%"> </mtext>
                      </mrow>
                    </msub>
                  </mrow>
                </mrow>
                <mo>.</mo>
              </mrow>
            </math>
          </div></div>
</div>
          <p>Physically, the phase shifter corresponds to one mode where particles gain a phase relative to the others. This can happen, for example, due to a difference in optical length of two paths, for photons, or to a difference in the local magnetic field acting on two distant electron spins. We represent its action as in Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS2_F1"><span class="sci-ico-fileFigure"></span>1</a>(a).</p>
          <div class="row fig" id="S2_F1">
<a name="S2_F1"></a><div class="col-md-4 col-sm-4"><a href="" data-toggle="modal" data-target="#ModalFigS2_F1"><div class="thumbImg">
<img src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/ab150b3aa9a423d1f0bfa480dc5da2360bdca55e.jpg"><div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8 col-sm-8">
<strong>Figure 1</strong><br>
              Elementary two-mode linear-optical transformations. (a) A phase shifter. (b) A beam splitter. (c) An arbitrary SU(2) element, with three free parameters.
            <br>
</div>
</div>
          <p>The beam splitter is defined as</p>
          <div class="row formula" id="eS2_Ex24">
<a name="S2_Ex24"></a><div class="col-md-12"><div class="formula-container">
            <math display="block">
              <mrow>
                <mrow>
                  <msub>
                    <mi>H</mi>
                    <mrow>
                      <mi>B</mi>
                      <mo>⁢</mo>
                      <mi>S</mi>
                    </mrow>
                  </msub>
                  <mo>=</mo>
                  <mrow>
                    <mi>θ</mi>
                    <mo>⁢</mo>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mrow>
                        <mrow>
                          <msubsup>
                            <mi>a</mi>
                            <mn>1</mn>
                            <mo>†</mo>
                          </msubsup>
                          <mo>⁢</mo>
                          <msub>
                            <mi>a</mi>
                            <mn>2</mn>
                          </msub>
                        </mrow>
                        <mo>+</mo>
                        <mrow>
                          <msubsup>
                            <mi>a</mi>
                            <mn>2</mn>
                            <mo>†</mo>
                          </msubsup>
                          <mo>⁢</mo>
                          <msub>
                            <mi>a</mi>
                            <mn>1</mn>
                          </msub>
                        </mrow>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>,</mo>
              </mrow>
            </math>
          </div></div>
</div>
          <p>with corresponding action on the particle operators</p>
          <div class="row formula" id="eS2_Ex25">
<a name="S2_Ex25"></a><div class="col-md-12"><div class="formula-container">
            <math display="block">
              <mrow>
                <msub>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msubsup>
                      <mi>a</mi>
                      <mn>1</mn>
                      <mo>†</mo>
                    </msubsup>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mrow>
                    <mtext>out</mtext>
                    <mtext mathsize="142%"> </mtext>
                  </mrow>
                </msub>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <mrow>
                      <mi>cos</mi>
                      <mo>⁡</mo>
                      <mi>θ</mi>
                    </mrow>
                    <mo>⁢</mo>
                    <msub>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <msubsup>
                          <mi>a</mi>
                          <mn>1</mn>
                          <mo>†</mo>
                        </msubsup>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mrow>
                        <mtext>in</mtext>
                        <mtext mathsize="142%"> </mtext>
                      </mrow>
                    </msub>
                  </mrow>
                  <mo>-</mo>
                  <mrow>
                    <mpadded width="+0.6pt">
                      <mi mathvariant="normal">i</mi>
                    </mpadded>
                    <mo>⁢</mo>
                    <mrow>
                      <mi>sin</mi>
                      <mo>⁡</mo>
                      <mi>θ</mi>
                    </mrow>
                    <mo>⁢</mo>
                    <msub>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <msubsup>
                          <mi>a</mi>
                          <mn>2</mn>
                          <mo>†</mo>
                        </msubsup>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mrow>
                        <mtext>in</mtext>
                        <mtext mathsize="142%"> </mtext>
                      </mrow>
                    </msub>
                  </mrow>
                </mrow>
              </mrow>
            </math>
          </div></div>
</div>
          <div class="row formula" id="eS2_Ex26">
<a name="S2_Ex26"></a><div class="col-md-12"><div class="formula-container">
            <math display="block">
              <mrow>
                <mrow>
                  <msub>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <msubsup>
                        <mi>a</mi>
                        <mn>2</mn>
                        <mo>†</mo>
                      </msubsup>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mtext>out</mtext>
                      <mtext mathsize="142%"> </mtext>
                    </mrow>
                  </msub>
                  <mo>=</mo>
                  <mrow>
                    <mrow>
                      <mo>-</mo>
                      <mrow>
                        <mpadded width="+0.6pt">
                          <mi mathvariant="normal">i</mi>
                        </mpadded>
                        <mo>⁢</mo>
                        <mrow>
                          <mi>sin</mi>
                          <mo>⁡</mo>
                          <mi>θ</mi>
                        </mrow>
                        <mo>⁢</mo>
                        <msub>
                          <mrow>
                            <mo stretchy="false">(</mo>
                            <msubsup>
                              <mi>a</mi>
                              <mn>1</mn>
                              <mo>†</mo>
                            </msubsup>
                            <mo stretchy="false">)</mo>
                          </mrow>
                          <mrow>
                            <mtext>in</mtext>
                            <mtext mathsize="142%"> </mtext>
                          </mrow>
                        </msub>
                      </mrow>
                    </mrow>
                    <mo>+</mo>
                    <mrow>
                      <mrow>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <mi>θ</mi>
                      </mrow>
                      <mo>⁢</mo>
                      <msub>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <msubsup>
                            <mi>a</mi>
                            <mn>2</mn>
                            <mo>†</mo>
                          </msubsup>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mrow>
                          <mtext>in</mtext>
                          <mtext mathsize="142%"> </mtext>
                        </mrow>
                      </msub>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>.</mo>
              </mrow>
            </math>
          </div></div>
</div>
          <p>Physically it can correspond to a semi-reflective mirror for optical propagation modes, a wave-plate for polarization modes, or a lattice hopping term for massive particles, where in each case the parameter θ regulates the transmission probability. We represent its action as in Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS2_F1"><span class="sci-ico-fileFigure"></span>1</a>(b).</p>
          <p>An arbitrary 2-mode linear-optical transformation can be obtained by alternated application of phase shifters and beam splitters. To see that, recall that a general SU(2) element has three free parameters, and can be always written as [<span class="ref"><sup class="xref xrefblue">7</sup><span class="refCtt closed"><span>7. M.A. Nielsen and I.L. Chuang, Quantum Computation and Quantum Information (Cambridge University Press, Cambridge, 2000).</span></span></span>]:</p>
          <div class="row formula" id="eS2_Ex27">
<a name="S2_Ex27"></a><div class="col-md-12"><div class="formula-container">
            <math display="block">
              <mrow>
                <mrow>
                  <mi>U</mi>
                  <mo>=</mo>
                  <mpadded width="-1.7pt">
                    <mrow>
                      <mo>(</mo>
                      <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                        <mtr>
                          <mtd columnalign="center">
                            <mrow>
                              <msup>
                                <mi>e</mi>
                                <mrow>
                                  <mrow>
                                    <mpadded width="+0.6pt">
                                      <mi mathvariant="normal">i</mi>
                                    </mpadded>
                                    <mo>⁢</mo>
                                    <mrow>
                                      <mo stretchy="false">(</mo>
                                      <mrow>
                                        <msub>
                                          <mi>ϕ</mi>
                                          <mn>1</mn>
                                        </msub>
                                        <mo>+</mo>
                                        <msub>
                                          <mi>ϕ</mi>
                                          <mn>2</mn>
                                        </msub>
                                      </mrow>
                                      <mo stretchy="false">)</mo>
                                    </mrow>
                                  </mrow>
                                  <mo>/</mo>
                                  <mn>2</mn>
                                </mrow>
                              </msup>
                              <mo>⁢</mo>
                              <mrow>
                                <mi>cos</mi>
                                <mo>⁡</mo>
                                <mi>θ</mi>
                              </mrow>
                            </mrow>
                          </mtd>
                          <mtd columnalign="center">
                            <mrow>
                              <mo>-</mo>
                              <mrow>
                                <mpadded width="+0.6pt">
                                  <mi mathvariant="normal">i</mi>
                                </mpadded>
                                <mo>⁢</mo>
                                <msup>
                                  <mi>e</mi>
                                  <mrow>
                                    <mrow>
                                      <mpadded width="+0.6pt">
                                        <mi mathvariant="normal">i</mi>
                                      </mpadded>
                                      <mo>⁢</mo>
                                      <mrow>
                                        <mo stretchy="false">(</mo>
                                        <mrow>
                                          <msub>
                                            <mi>ϕ</mi>
                                            <mn>2</mn>
                                          </msub>
                                          <mo>-</mo>
                                          <msub>
                                            <mi>ϕ</mi>
                                            <mn>1</mn>
                                          </msub>
                                        </mrow>
                                        <mo stretchy="false">)</mo>
                                      </mrow>
                                    </mrow>
                                    <mo>/</mo>
                                    <mn>2</mn>
                                  </mrow>
                                </msup>
                                <mo>⁢</mo>
                                <mrow>
                                  <mi>sin</mi>
                                  <mo>⁡</mo>
                                  <mi>θ</mi>
                                </mrow>
                              </mrow>
                            </mrow>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd columnalign="center">
                            <mrow>
                              <mo>-</mo>
                              <mrow>
                                <mpadded width="+0.6pt">
                                  <mi mathvariant="normal">i</mi>
                                </mpadded>
                                <mo>⁢</mo>
                                <msup>
                                  <mi>e</mi>
                                  <mrow>
                                    <mrow>
                                      <mpadded width="+0.6pt">
                                        <mi mathvariant="normal">i</mi>
                                      </mpadded>
                                      <mo>⁢</mo>
                                      <mrow>
                                        <mo stretchy="false">(</mo>
                                        <mrow>
                                          <msub>
                                            <mi>ϕ</mi>
                                            <mn>1</mn>
                                          </msub>
                                          <mo>-</mo>
                                          <msub>
                                            <mi>ϕ</mi>
                                            <mn>2</mn>
                                          </msub>
                                        </mrow>
                                        <mo stretchy="false">)</mo>
                                      </mrow>
                                    </mrow>
                                    <mo>/</mo>
                                    <mn>2</mn>
                                  </mrow>
                                </msup>
                                <mo>⁢</mo>
                                <mrow>
                                  <mi>sin</mi>
                                  <mo>⁡</mo>
                                  <mi>θ</mi>
                                </mrow>
                              </mrow>
                            </mrow>
                          </mtd>
                          <mtd columnalign="center">
                            <mrow>
                              <msup>
                                <mi>e</mi>
                                <mrow>
                                  <mrow>
                                    <mpadded width="+0.6pt">
                                      <mi mathvariant="normal">i</mi>
                                    </mpadded>
                                    <mo>⁢</mo>
                                    <mrow>
                                      <mo stretchy="false">(</mo>
                                      <mrow>
                                        <mrow>
                                          <mo>-</mo>
                                          <msub>
                                            <mi>ϕ</mi>
                                            <mn>1</mn>
                                          </msub>
                                        </mrow>
                                        <mo>-</mo>
                                        <msub>
                                          <mi>ϕ</mi>
                                          <mn>2</mn>
                                        </msub>
                                      </mrow>
                                      <mo stretchy="false">)</mo>
                                    </mrow>
                                  </mrow>
                                  <mo>/</mo>
                                  <mn>2</mn>
                                </mrow>
                              </msup>
                              <mo>⁢</mo>
                              <mrow>
                                <mi>cos</mi>
                                <mo>⁡</mo>
                                <mi>θ</mi>
                              </mrow>
                            </mrow>
                          </mtd>
                        </mtr>
                      </mtable>
                      <mo>)</mo>
                    </mrow>
                  </mpadded>
                </mrow>
                <mo>.</mo>
              </mrow>
            </math>
          </div></div>
</div>
          <p>where <i>θ</i> ∈ [0,<i>π</i>] and <i>ϕ</i><sub>1</sub>,<i>ϕ</i><sub>2</sub> ∈ [0,2<i>π</i>]. This corresponds to the decomposition depicted in Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS2_F1"><span class="sci-ico-fileFigure"></span>1</a>(c), up to an irrelevant global phase.</p>
          <p>Imagine now an experiment where we input particles in such a two-mode transformation, or <i>interferometer</i>. Let us write the interferometer matrix generically as</p>
          <div class="row formula" id="eS2_Ex28">
<a name="S2_Ex28"></a><div class="col-md-12"><div class="formula-container">
            <math display="block">
              <mrow>
                <mrow>
                  <mi>U</mi>
                  <mo>=</mo>
                  <mpadded width="-1.7pt">
                    <mrow>
                      <mo>(</mo>
                      <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                        <mtr>
                          <mtd columnalign="center">
                            <mi>α</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>β</mi>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd columnalign="center">
                            <mi>γ</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>δ</mi>
                          </mtd>
                        </mtr>
                      </mtable>
                      <mo>)</mo>
                    </mrow>
                  </mpadded>
                </mrow>
                <mo>.</mo>
              </mrow>
            </math>
          </div></div>
</div>
          <p>If we input a single particle in mode 1 then, according to equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E3"><span class="sci-ico-fileFormula"></span>3</a>), the output is</p>
          <div class="row formula" id="eS2_Ex29">
<a name="S2_Ex29"></a><div class="col-md-12"><div class="formula-container">
            <math display="block">
              <mrow>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <mrow>
                    <mrow>
                      <mi>α</mi>
                      <mo>⁢</mo>
                      <msubsup>
                        <mi>a</mi>
                        <mn>1</mn>
                        <mo>†</mo>
                      </msubsup>
                    </mrow>
                    <mo>+</mo>
                    <mrow>
                      <mi>β</mi>
                      <mo>⁢</mo>
                      <msubsup>
                        <mi>a</mi>
                        <mn>2</mn>
                        <mo>†</mo>
                      </msubsup>
                    </mrow>
                  </mrow>
                  <mo stretchy="false">)</mo>
                </mrow>
                <mo>⁢</mo>
                <mrow>
                  <mo fence="true" stretchy="false">|</mo>
                  <mn>0</mn>
                  <mo stretchy="false">⟩</mo>
                </mrow>
              </mrow>
            </math>
          </div></div>
</div>
          <p>and this is independent of whether the particle is a boson or fermion, as there is no distinction at the single-particle level.</p>
          <p>Suppose now we input one particle in each arm of this two-mode transformation, i.e., input state <math id="INEQ36"><mrow><mrow><mo fence="true" stretchy="false">|</mo><mn>11</mn><mo stretchy="false">⟩</mo></mrow><mo>=</mo><mrow><msubsup><mi>a</mi><mn>1</mn><mo>†</mo></msubsup><mo>⁢</mo><msubsup><mi>a</mi><mn>2</mn><mo>†</mo></msubsup><mo>⁢</mo><mrow><mo fence="true" stretchy="false">|</mo><mn>0</mn><mo stretchy="false">⟩</mo></mrow></mrow></mrow></math>. What do we observe at the output?</p>
          <p>Consider first the bosonic case. Using the bosonic commutation relations, it follows that the output state is given by</p>
          <div class="row formula" id="eS2_E5">
<a name="S2_E5"></a><div class="col-md-12"><div class="formula-container">
            <span class="label">(5)</span>
            <math display="block">
              <mrow>
                <mrow>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <mrow>
                      <mrow>
                        <mi>α</mi>
                        <mo>⁢</mo>
                        <msubsup>
                          <mi>b</mi>
                          <mn>1</mn>
                          <mo>†</mo>
                        </msubsup>
                      </mrow>
                      <mo>+</mo>
                      <mrow>
                        <mi>β</mi>
                        <mo>⁢</mo>
                        <msubsup>
                          <mi>b</mi>
                          <mn>2</mn>
                          <mo>†</mo>
                        </msubsup>
                      </mrow>
                    </mrow>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <mrow>
                      <mrow>
                        <mi>γ</mi>
                        <mo>⁢</mo>
                        <msubsup>
                          <mi>b</mi>
                          <mn>1</mn>
                          <mo>†</mo>
                        </msubsup>
                      </mrow>
                      <mo>+</mo>
                      <mrow>
                        <mi>δ</mi>
                        <mo>⁢</mo>
                        <msubsup>
                          <mi>b</mi>
                          <mn>2</mn>
                          <mo>†</mo>
                        </msubsup>
                      </mrow>
                    </mrow>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>0</mn>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <mi mathvariant="normal"> </mi>
                    <mo>⁢</mo>
                    <msqrt>
                      <mn>2</mn>
                    </msqrt>
                    <mo>⁢</mo>
                    <mi>α</mi>
                    <mo>⁢</mo>
                    <mi>γ</mi>
                    <mo>⁢</mo>
                    <mrow>
                      <mo fence="true" stretchy="false">|</mo>
                      <mrow>
                        <mn>2</mn>
                        <mo>,</mo>
                        <mn>0</mn>
                      </mrow>
                      <mo stretchy="false">⟩</mo>
                    </mrow>
                  </mrow>
                  <mo>+</mo>
                  <mrow>
                    <msqrt>
                      <mn>2</mn>
                    </msqrt>
                    <mo>⁢</mo>
                    <mi>β</mi>
                    <mo>⁢</mo>
                    <mi>δ</mi>
                    <mo>⁢</mo>
                    <mrow>
                      <mo fence="true" stretchy="false">|</mo>
                      <mrow>
                        <mn>0</mn>
                        <mo>,</mo>
                        <mn>2</mn>
                      </mrow>
                      <mo stretchy="false">⟩</mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
              <mrow>
                <mrow>
                  <mtext>£</mtext>
                  <mo>+</mo>
                  <mrow>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mrow>
                        <mrow>
                          <mi>α</mi>
                          <mo>⁢</mo>
                          <mi>δ</mi>
                        </mrow>
                        <mo>+</mo>
                        <mrow>
                          <mi>β</mi>
                          <mo>⁢</mo>
                          <mi>γ</mi>
                        </mrow>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mrow>
                      <mo fence="true" stretchy="false">|</mo>
                      <mrow>
                        <mn>1</mn>
                        <mo>,</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo stretchy="false">⟩</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>.</mo>
              </mrow>
            </math>
          </div></div>
</div>
          <p>For the fermionic case, we have</p>
          <div class="row formula" id="eS2_E6">
<a name="S2_E6"></a><div class="col-md-12"><div class="formula-container">
            <span class="label">(6)</span>
            <math display="block">
              <mrow>
                <mrow>
                  <mrow>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mrow>
                        <mrow>
                          <mi>α</mi>
                          <mo>⁢</mo>
                          <msubsup>
                            <mi>f</mi>
                            <mn>1</mn>
                            <mo>†</mo>
                          </msubsup>
                        </mrow>
                        <mo>+</mo>
                        <mrow>
                          <mi>β</mi>
                          <mo>⁢</mo>
                          <msubsup>
                            <mi>f</mi>
                            <mn>2</mn>
                            <mo>†</mo>
                          </msubsup>
                        </mrow>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mrow>
                        <mrow>
                          <mi>γ</mi>
                          <mo>⁢</mo>
                          <msubsup>
                            <mi>f</mi>
                            <mn>1</mn>
                            <mo>†</mo>
                          </msubsup>
                        </mrow>
                        <mo>+</mo>
                        <mrow>
                          <mi>δ</mi>
                          <mo>⁢</mo>
                          <msubsup>
                            <mi>f</mi>
                            <mn>2</mn>
                            <mo>†</mo>
                          </msubsup>
                        </mrow>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mrow>
                      <mo fence="true" stretchy="false">|</mo>
                      <mn>0</mn>
                      <mo stretchy="false">⟩</mo>
                    </mrow>
                  </mrow>
                  <mo>=</mo>
                  <mrow>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mrow>
                        <mrow>
                          <mi>α</mi>
                          <mo>⁢</mo>
                          <mi>δ</mi>
                        </mrow>
                        <mo>-</mo>
                        <mrow>
                          <mi>β</mi>
                          <mo>⁢</mo>
                          <mi>γ</mi>
                        </mrow>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mrow>
                      <mo fence="true" stretchy="false">|</mo>
                      <mrow>
                        <mn>1</mn>
                        <mo>,</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo stretchy="false">⟩</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>,</mo>
              </mrow>
            </math>
          </div></div>
</div>
          <p>Note that the application of the second quantization formalism is very similar in both cases. Only at the very end do we use the commutation or anti-commutation relations, as appropriate, and the expressions differ.</p>
          <p>To see how equations (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E5"><span class="sci-ico-fileFormula"></span>5</a>, <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E6"><span class="sci-ico-fileFormula"></span>6</a>) lead to inherent bosonic and fermionic behaviors, suppose that the interferometer is a 50:50 beam splitter (i.e. <i>θ</i> = <i>π</i>/4):</p>
          <div class="row formula" id="eS2_E7">
<a name="S2_E7"></a><div class="col-md-12"><div class="formula-container">
            <span class="label">(7)</span>
            <math display="block">
              <mrow>
                <mi>U</mi>
                <mo>=</mo>
                <mrow>
                  <mfrac>
                    <mn>1</mn>
                    <msqrt>
                      <mn>2</mn>
                    </msqrt>
                  </mfrac>
                  <mo>⁢</mo>
                  <mrow>
                    <mo>(</mo>
                    <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                      <mtr>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mi mathvariant="normal">i</mi>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <mi mathvariant="normal">i</mi>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                      </mtr>
                    </mtable>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </math>
          </div></div>
</div>
          <p>By plugging equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E7"><span class="sci-ico-fileFormula"></span>7</a>) into equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E5"><span class="sci-ico-fileFormula"></span>5</a>), we obtain the output state</p>
          <div class="row formula" id="eS2_Ex31">
<a name="S2_Ex31"></a><div class="col-md-12"><div class="formula-container">
            <math display="block">
              <mrow>
                <mrow>
                  <mrow>
                    <mfrac>
                      <mpadded width="+0.6pt">
                        <mi mathvariant="normal">i</mi>
                      </mpadded>
                      <msqrt>
                        <mn>2</mn>
                      </msqrt>
                    </mfrac>
                    <mo>⁢</mo>
                    <mrow>
                      <mo fence="true" stretchy="false">|</mo>
                      <mrow>
                        <mn>2</mn>
                        <mo>,</mo>
                        <mn>0</mn>
                      </mrow>
                      <mo stretchy="false">⟩</mo>
                    </mrow>
                  </mrow>
                  <mo>+</mo>
                  <mrow>
                    <mfrac>
                      <mpadded width="+0.6pt">
                        <mi mathvariant="normal">i</mi>
                      </mpadded>
                      <msqrt>
                        <mn>2</mn>
                      </msqrt>
                    </mfrac>
                    <mo>⁢</mo>
                    <mrow>
                      <mo fence="true" stretchy="false">|</mo>
                      <mrow>
                        <mn>0</mn>
                        <mo>,</mo>
                        <mn>2</mn>
                      </mrow>
                      <mo stretchy="false">⟩</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>,</mo>
              </mrow>
            </math>
          </div></div>
</div>
          <p>and so the two photons have zero probability of exiting in separate modes. This is known as the Hong-Ou-Mandel effect [<span class="ref"><sup class="xref xrefblue">19</sup><span class="refCtt closed"><span>19. C.K. Hong, Z.Y. Ou and L. Mandel, Phys. Rev. Lett. 59, 2044 (1987).</span></span></span>], and is a small-scale manifestation of the natural tendency of bosons to bunch together. Equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E6"><span class="sci-ico-fileFormula"></span>6</a>), on the other hand, tells us that fermions always exit in separate modes, no matter what <i>U</i> is, which of course is due to the Pauli exclusion principle. Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS2_F2"><span class="sci-ico-fileFigure"></span>2</a> summarizes the different behaviors on a balanced beam splitter.</p>
          <div class="row fig" id="S2_F2">
<a name="S2_F2"></a><div class="col-md-4 col-sm-4"><a href="" data-toggle="modal" data-target="#ModalFigS2_F2"><div class="thumbImg">
<img src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/ec33dbc9ae1b604b040556fcb4e08571149c12a3.jpg"><div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8 col-sm-8">
<strong>Figure 2</strong><br>
              Effect of a 50:50 beam splitter on different particle types. In each diagram, the circles represent particles, which are input on the left of the beamsplitter. At the output, columns represent possible outcomes with their correct relative frequencies. (a) For a single particle (yellow), there is no difference in behavior between bosons and fermions. (b) The Hong-Ou-Mandel effect, where two photons (blue) impinging on a balanced beam splitter always leave it together. (c) The Pauli exclusion principle, which states that two fermions (red) cannot occupy the same mode. (d) For comparison, the behavior of distinguishable particles (white), which exit the beam splitter together or separately with equal probabilities.
            <br>
</div>
</div>
          <p>Let us look more carefully now at the amplitude of the |1,1⟩ outcomes in equations (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E5"><span class="sci-ico-fileFormula"></span>5</a>, <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E6"><span class="sci-ico-fileFormula"></span>6</a>). The combinations (<i>αδ</i> + <i>βγ</i>) and (<i>αδ</i>−<i>βγ</i>) are well-known matrix functions of <i>U</i>, the <i>permanent</i> and the <i>determinant</i>, respectively. Let us now see what these expressions look like for scaled-up experiments.</p>
        
        
          <h3>2.2.2. <i>m</i>–ports</h3>
          <p>We now define the paradigmatic large-scale linear-optical experiment. Suppose that we have a system of <i>n</i> particles in <i>m</i> modes, and they are prepared in some initial state</p>
          <div class="row formula" id="eS2_Ex32">
<a name="S2_Ex32"></a><div class="col-md-12"><div class="formula-container">
            <math display="block">
              <mrow>
                <mrow>
                  <mo fence="true" stretchy="false">|</mo>
                  <mi>S</mi>
                  <mo stretchy="false">⟩</mo>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mo fence="true" stretchy="false">|</mo>
                  <mrow>
                    <msub>
                      <mi>s</mi>
                      <mn>1</mn>
                    </msub>
                    <mo>,</mo>
                    <msub>
                      <mi>s</mi>
                      <mn>2</mn>
                    </msub>
                    <mo>,</mo>
                    <mi mathvariant="normal">…</mi>
                    <mo>,</mo>
                    <msub>
                      <mi>s</mi>
                      <mi>m</mi>
                    </msub>
                  </mrow>
                  <mo stretchy="false">⟩</mo>
                </mrow>
              </mrow>
            </math>
          </div></div>
</div>
          <p>such that ∑<sub><i>i</i></sub><i>s</i><sub><i>i</i></sub> = <i>n</i>. These particles will be input in an <i>m</i>-mode interferometer <i>U</i>, or <i>m</i>-port, which acts as per equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E3"><span class="sci-ico-fileFormula"></span>3</a>). It was shown by Reck et al. [<span class="ref"><sup class="xref xrefblue">20</sup><span class="refCtt closed"><span>20. M. Reck, A. Zeilinger, H.J. Bernstein and P. Bertani, Phys. Rev. Lett. 73, 58 (1994).</span></span></span>] that an arbitrary <i>m</i>-port can be decomposed in terms of <i>m</i>(<i>m</i>−1)/2 two-mode transformations, as shown in the main circuit of Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS2_F3"><span class="sci-ico-fileFigure"></span>3</a>. Finally, we place detectors at all output ports of the interferometer to measure the occupation number of each mode, repeating the experiment many times to build statistics. The full setup is represented in Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS2_F3"><span class="sci-ico-fileFigure"></span>3</a>.</p>
          <div class="row fig" id="S2_F3">
<a name="S2_F3"></a><div class="col-md-4 col-sm-4"><a href="" data-toggle="modal" data-target="#ModalFigS2_F3"><div class="thumbImg">
<img src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/db501ff6b8067cbe8cc29cd1ca30613bab62719d.jpg"><div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8 col-sm-8">
<strong>Figure 3</strong><br>
              The standard linear-optical setup we consider, composed of (i) Fock state input with <i>n</i> particles (bosons or fermions) in <i>m</i> modes, (ii) arbitrary <i>m</i>-mode linear-optical transformations (which can be decomposed as a circuit of <i>m</i>(<i>m</i>−1) elementary transformations [<span class="ref"><sup class="xref xrefblue">20</sup><span class="refCtt closed"><span>20. M. Reck, A. Zeilinger, H.J. Bernstein and P. Bertani, Phys. Rev. Lett. 73, 58 (1994).</span></span></span>]), and (iii) detection of occupation number at all output ports, repeated to build statistics.
            <br>
</div>
</div>
          <p>We now consider the probability of observing an output state |<i>T</i>⟩ = |<i>t</i><sub>1</sub>,<i>t</i><sub>2</sub>,…,<i>t</i><sub><i>m</i></sub>⟩. To that end, we need to define a submatrix of <i>U</i>, which we call <i>U</i><sub><i>S,T</i></sub>, by the following procedure. First, we take <i>t</i><sub><i>i</i></sub> identical copies of the <i>i</i>th column of <i>U</i> and construct an intermediate <i>m</i>×<i>n</i> matrix <i>U</i><sub><i>T</i></sub>. Then, we take each <i>s</i><sub><i>j</i></sub> identical copies of each <i>j</i>th row of <i>U</i><sub><i>T</i></sub> to obtain the <i>n</i>×<i>n</i> matrix <i>U</i><sub><i>S,T</i></sub>. For example, suppose</p>
          <div class="row formula" id="eS2_Ex33">
<a name="S2_Ex33"></a><div class="col-md-12"><div class="formula-container">
            <math display="block">
              <mrow>
                <mrow>
                  <mi>U</mi>
                  <mo>=</mo>
                  <mpadded width="-1.7pt">
                    <mrow>
                      <mo>(</mo>
                      <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                        <mtr>
                          <mtd columnalign="center">
                            <mi>α</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>β</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>γ</mi>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd columnalign="center">
                            <mi>δ</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>ϵ</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>ζ</mi>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd columnalign="center">
                            <mi>η</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>θ</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>ι</mi>
                          </mtd>
                        </mtr>
                      </mtable>
                      <mo>)</mo>
                    </mrow>
                  </mpadded>
                </mrow>
                <mo>,</mo>
              </mrow>
            </math>
          </div></div>
</div>
          <p>and suppose that |<i>S</i>⟩ = |011⟩ and |<i>T</i>⟩ = |200⟩. Then we obtain</p>
          <div class="row formula" id="eS2_Ex34">
<a name="S2_Ex34"></a><div class="col-md-12"><div class="formula-container">
            <math display="block">
              <mrow>
                <mrow>
                  <msub>
                    <mi>U</mi>
                    <mi>T</mi>
                  </msub>
                  <mo>=</mo>
                  <mpadded width="-1.7pt">
                    <mrow>
                      <mo>(</mo>
                      <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                        <mtr>
                          <mtd columnalign="center">
                            <mi>α</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>α</mi>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd columnalign="center">
                            <mi>δ</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>δ</mi>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd columnalign="center">
                            <mi>η</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>η</mi>
                          </mtd>
                        </mtr>
                      </mtable>
                      <mo>)</mo>
                    </mrow>
                  </mpadded>
                </mrow>
                <mo>,</mo>
                <mrow>
                  <mrow>
                    <mtext> </mtext>
                    <mtext>and</mtext>
                    <mtext> </mtext>
                    <mo>⁢</mo>
                    <msub>
                      <mi>U</mi>
                      <mrow>
                        <mi>S</mi>
                        <mo>,</mo>
                        <mi>T</mi>
                      </mrow>
                    </msub>
                  </mrow>
                  <mo>=</mo>
                  <mrow>
                    <mo>(</mo>
                    <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                      <mtr>
                        <mtd columnalign="center">
                          <mi>δ</mi>
                        </mtd>
                        <mtd columnalign="center">
                          <mi>δ</mi>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <mi>η</mi>
                        </mtd>
                        <mtd columnalign="center">
                          <mi>η</mi>
                        </mtd>
                      </mtr>
                    </mtable>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </math>
          </div></div>
</div>
          <p>The transition probabilities can now be written as the generalizations of equations (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E5"><span class="sci-ico-fileFormula"></span>5</a>, <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E6"><span class="sci-ico-fileFormula"></span>6</a>) as follows:</p>
          <div class="row formula" id="eS2_E8_1">
<a name="S2_E8_1"></a><div class="col-md-12"><div class="formula-container">
            <span class="label">(8a)</span>
            <math display="block">
              <mrow>
                <mtext>Pr</mtext>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <mi>S</mi>
                  <mo>→</mo>
                  <mi>T</mi>
                  <mo stretchy="false">)</mo>
                </mrow>
                <mo>=</mo>
                <mstyle displaystyle="true">
                  <mfrac>
                    <mrow>
                      <mo fence="true">|</mo>
                      <mtext>per</mtext>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <msub>
                          <mi>U</mi>
                          <mrow>
                            <mi>S</mi>
                            <mo>,</mo>
                            <mi>T</mi>
                          </mrow>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <msup>
                        <mo fence="true" stretchy="false">|</mo>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                    <mrow>
                      <msub>
                        <mo largeop="true" symmetric="true">∏</mo>
                        <mi>i</mi>
                      </msub>
                      <mrow>
                        <mrow>
                          <msub>
                            <mi>s</mi>
                            <mi>i</mi>
                          </msub>
                          <mo lspace="0pt" rspace="3.5pt">!</mo>
                        </mrow>
                        <mo>⁢</mo>
                        <mrow>
                          <msub>
                            <mo largeop="true" symmetric="true">∏</mo>
                            <mi>j</mi>
                          </msub>
                          <mrow>
                            <msub>
                              <mi>t</mi>
                              <mi>j</mi>
                            </msub>
                            <mo lspace="0pt" rspace="3.5pt">!</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                    </mrow>
                  </mfrac>
                </mstyle>
                <mtext>for bosons,</mtext>
              </mrow>
            </math>
          </div></div>
</div>
          <div class="row formula" id="eS2_E8_2">
<a name="S2_E8_2"></a><div class="col-md-12"><div class="formula-container">
            <span class="label">(8b)</span>
            <math display="block">
              <mrow>
                <mtext>Pr</mtext>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <mi>S</mi>
                  <mo>→</mo>
                  <mi>T</mi>
                  <mo stretchy="false">)</mo>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mo fence="true">|</mo>
                  <mo movablelimits="false">det</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>U</mi>
                      <mrow>
                        <mi>S</mi>
                        <mo>,</mo>
                        <mi>T</mi>
                      </mrow>
                    </msub>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <msup>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>2</mn>
                  </msup>
                </mrow>
                <mtext>for fermions.</mtext>
              </mrow>
            </math>
          </div></div>
</div>
          <p>The functions per (<i>A</i>) and det⁡ (<i>A</i>) are the permanent and determinant, respectively, given by</p>
          <div class="row formula" id="eS2_E9_1">
<a name="S2_E9_1"></a><div class="col-md-12"><div class="formula-container">
            <span class="label">(9a)</span>
            <math display="block">
              <mrow>
                <mrow>
                  <mrow>
                    <mo movablelimits="false">det</mo>
                    <mo>⁡</mo>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>A</mi>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </mrow>
                  <mo>=</mo>
                  <mrow>
                    <mstyle displaystyle="true">
                      <munder>
                        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                        <mrow>
                          <mi>σ</mi>
                          <mo>∈</mo>
                          <msub>
                            <mi>S</mi>
                            <mi>n</mi>
                          </msub>
                        </mrow>
                      </munder>
                    </mstyle>
                    <mrow>
                      <mtext>sgn</mtext>
                      <mo>⁢</mo>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>σ</mi>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mstyle displaystyle="true">
                          <munderover>
                            <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
                            <mrow>
                              <mi>i</mi>
                              <mo>=</mo>
                              <mn>1</mn>
                            </mrow>
                            <mi>n</mi>
                          </munderover>
                        </mstyle>
                        <msub>
                          <mi>A</mi>
                          <mrow>
                            <mi>i</mi>
                            <mo>,</mo>
                            <msub>
                              <mi>σ</mi>
                              <mi>i</mi>
                            </msub>
                          </mrow>
                        </msub>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>,</mo>
              </mrow>
            </math>
          </div></div>
</div>
          <div class="row formula" id="eS2_E9_2">
<a name="S2_E9_2"></a><div class="col-md-12"><div class="formula-container">
            <span class="label">(9b)</span>
            <math display="block">
              <mrow>
                <mrow>
                  <mrow>
                    <mtext>per</mtext>
                    <mo>⁢</mo>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>A</mi>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </mrow>
                  <mo>=</mo>
                  <mrow>
                    <mstyle displaystyle="true">
                      <munder>
                        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                        <mrow>
                          <mi>σ</mi>
                          <mo>∈</mo>
                          <msub>
                            <mi>S</mi>
                            <mi>n</mi>
                          </msub>
                        </mrow>
                      </munder>
                    </mstyle>
                    <mrow>
                      <mstyle displaystyle="true">
                        <munderover>
                          <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
                          <mrow>
                            <mi>i</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mi>n</mi>
                        </munderover>
                      </mstyle>
                      <msub>
                        <mi>A</mi>
                        <mrow>
                          <mi>i</mi>
                          <mo>,</mo>
                          <msub>
                            <mi>σ</mi>
                            <mi>i</mi>
                          </msub>
                        </mrow>
                      </msub>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>,</mo>
              </mrow>
            </math>
          </div></div>
</div>
          <p>where <i>S</i><sub><i>n</i></sub> is the set of all permutations of the set {1,2,…,<i>n</i>}, and sgn(<i>σ</i>) is the signature of the permutation, equal to + 1 if the permutation is even and –1 if it is odd. Notice that the only difference in these expressions is the minus signs in the determinant for odd permutations. That can be traced directly to the fermionic anti-commutation relations. From this also follows the Pauli exclusion principle, since any outcome with two fermions in the same mode would correspond to a matrix <i>U</i><sub><i>S,T</i></sub> with repeated columns, whose determinant is always zero. I invite the interested reader to use equations (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E9_1"><span class="sci-ico-fileFormula"></span>9</a>) to verify equations (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E5"><span class="sci-ico-fileFormula"></span>5</a>, <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E6"><span class="sci-ico-fileFormula"></span>6</a>).</p>
          <p>The connection between the transition probabilities and equations (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E9_1"><span class="sci-ico-fileFormula"></span>9</a>) is somewhat intuitive. The determinant and permanents are sums over all possible choices of one matrix element from each distinct row and column. Each term in this sum corresponds to one trajectory that the <i>n</i> input particles might have taken to end up as the <i>n</i> output particles – though, since particles are identical, these possibilities are all summed coherently. For a proof of these expressions, see [<span class="ref"><sup class="xref xrefblue">14</sup><span class="refCtt closed"><span>14. S. Aaronson and A. Arkhipov, Theory of Computing 4, 143 (2013).</span></span></span>, <span class="ref"><sup class="xref xrefblue">21</sup><span class="refCtt closed"><span>21. S. Scheel, arXiv:quant-ph/0406127 (2004).</span></span></span>].</p>
          <p>For completeness, we should point out that transition probabilities for classical (i.e. distinguishable) particles can also be written similarly. Of course, <i>a priori</i> classical particles can have labels, so their configuration space is larger. For particles labeled <i>a</i> and <i>b</i>, state |<i>ab</i>⟩ is different from state |<i>ba</i>⟩. However, imagine we perform an experiment, but forget the particle labels at the output (alternatively, imagine we perform an experiment with particles that are all in mutually orthogonal states of some internal, undetectable degree of freedom). Then the configuration space coincides with that of bosons, and the transition probabilities are given by</p>
          <div class="row formula" id="eS2_Ex35">
<a name="S2_Ex35"></a><div class="col-md-12"><div class="formula-container">
            <span class="label">(10)</span>
            <math display="block">
              <mrow>
                <mtext>Pr</mtext>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <mi>S</mi>
                  <mo>→</mo>
                  <mi>T</mi>
                  <mo stretchy="false">)</mo>
                </mrow>
                <mo>=</mo>
                <mstyle displaystyle="true">
                  <mfrac>
                    <mrow>
                      <mtext>per</mtext>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mrow>
                          <mo fence="true">|</mo>
                          <msub>
                            <mi>U</mi>
                            <mrow>
                              <mi>S</mi>
                              <mo>,</mo>
                              <mi>T</mi>
                            </mrow>
                          </msub>
                          <mrow>
                            <msup>
                              <mo fence="true" stretchy="false">|</mo>
                              <mn>2</mn>
                            </msup>
                            <mo stretchy="false">)</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mrow>
                      <msub>
                        <mo largeop="true" symmetric="true">∏</mo>
                        <mi>i</mi>
                      </msub>
                      <mrow>
                        <mrow>
                          <msub>
                            <mi>s</mi>
                            <mi>i</mi>
                          </msub>
                          <mo lspace="0pt" rspace="3.5pt">!</mo>
                        </mrow>
                        <mo>⁢</mo>
                        <mrow>
                          <msub>
                            <mo largeop="true" symmetric="true">∏</mo>
                            <mi>j</mi>
                          </msub>
                          <mrow>
                            <msub>
                              <mi>t</mi>
                              <mi>j</mi>
                            </msub>
                            <mo lspace="0pt" rspace="3.5pt">!</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                    </mrow>
                  </mfrac>
                </mstyle>
                <mtext> for classical particles,</mtext>
              </mrow>
            </math>
          </div></div>
</div>
          <p>where |<i>U</i><sub><i>S</i>,<i>T</i></sub>|<sup>2</sup> is obtained from <i>U</i><sub><i>S,T</i></sub> by taking element-wise absolute value squared.</p>
          <p>With such similar expressions, one might think that bosonic and fermionic probabilities can be computed with similar computational cost. That is not the case, but to give a full justification we need to take a detour into the territory of computational complexity theory.</p>
        
      
    
      <h1 class="articleSectionTitle">3. Computational complexity theory</h1>
      <p>The distinction between the determinant and the permanent (which will translate into a difference between bosons and fermions) seems, at first glance, a trivial minus sign in some terms of equations (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E9_1"><span class="sci-ico-fileFormula"></span>9</a>). Both expressions seem to require computing sums with the same number of very similar terms (<i>n</i>!, in fact, for <i>n</i>×<i>n</i> matrices), which might suggest that they should be equally easy or hard to compute. This impression is misleading–computing the permanent is in fact typically much harder than the determinant. In order to give a robust justification for this claim we need employ the toolbox of <i>computational complexity theory</i>, which aims to classify computational problems based on their hardness. This theory is quite extensive and technical, so here we only look at a cross section of it that serves our purposes. We direct the interested reader to the excellent textbook by Arora and Barak [<span class="ref"><sup class="xref xrefblue">1</sup><span class="refCtt closed"><span>1. S. Arora and B. Barak, Computational Complexity: A Modern Approach (Cambridge University Press, Cambridge, 2009).</span></span></span>].</p>
      
        <h2>3.1. P and NP</h2>
        <p>Let us begin our foray into the field of computational complexity theory with an example:</p>
        <p>
          <b>Problem 1.</b>
          <i>Suppose you, a famous archaeologist, discovered an ancient tablet of a forgotten civilization. After some work in deciphering the tablet, you realize that it is a geographical document: it contains a list of <i>n</i> cities, together with a list of all pairs of cities which share a common border. Wanting to understand more about this civilization, you decide to figure out: did they inhabit a single island<span class="ref footnote"><sup class="xref">4</sup><span class="refCtt closed"><span class="refCttPadding">
        In the jargon of graph theory, this problem is called GRAPH CONNECTIVITY.
      </span></span></span> ?</i>
        </p>
        <p>
          <i>How should you proceed?</i>
        </p>
        <p>This problem has two notable features prominent for our discussion. The first is that it is a <i>decision problem</i>, i.e., it has a definite yes or no answer. The second is that there exists a procedure to solve this problem which takes a number of steps that grows as a <i>polynomial</i> in the size of the problem (<i>n</i>). One simple such procedure, based on a strategy known as <i>breadth-first search</i>, is the following:</p>
        <ol type="1">
<li>
            1.
            <p>Choose any city in the list, number it 1.</p>
          </li>
<li>
            2.
            <p>Go through the list of borders, identifying the neighbors of city 1. Label them as 2.</p>
          </li>
<li>
            3.
            <p>Repeat the previous step, identifying (yet unlabeled) neighbors of all cities labeled 2. Label them as 3.</p>
          </li>
<li>
            4.
            <p>Repeat the previous step, incrementing the labels, until the procedure stops and no new cities receive labels. If every city receives a label, then they are all in a single island. Any cities left unlabeled are not in the same island as city 1.</p>
          </li>
</ol>
        <p>We represent this procedure in Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS3_F4"><span class="sci-ico-fileFigure"></span>4</a>. Clearly it solves the problem, but how long does it take? If there are <i>n</i> cities, then the procedure will iterate for at most <i>n</i> steps. In each step, we may need to parse through a list containing at most <i>n</i>(<i>n</i>−1)/2 elements, corresponding to the maximum number of pairwise borders that can exist. Therefore, if we were to write an algorithm implementing this procedure in our preferred programming language, its runtime would grow more slowly than <i>n</i>3<span class="ref footnote"><sup class="xref">5</sup><span class="refCtt closed"><span class="refCttPadding">
        <strong class="fn-title">5</strong>
        In complexity theory and algorithm analysis this is denoted as O(n3). Given two functions f(n) and g(n), then f = O(g) means that f(n) is upper bounded by some positive multiple of g(n) in the limit n→∞. Note that a similar notation is used in the physics literature with a similar spirit but different technical meaning. We refer the reader to chapter 0 of [1].
      </span></span></span>. This is definitely not optimal, but crucially it is a polynomial in the size of the problem.</p>
        <div class="row fig" id="S3_F4">
<a name="S3_F4"></a><div class="col-md-4 col-sm-4"><a href="" data-toggle="modal" data-target="#ModalFigS3_F4"><div class="thumbImg">
<img src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/dbaf2feaf0916202d5b7249ef106715a9d9f91fd.jpg"><div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8 col-sm-8">
<strong>Figure 4</strong><br>
            On the left, two ancient tablets, one with a list of cities and the other with a list of borders. To decide whether all cities are in the same island, you represent this data as a graph, on the right, where cities are vertices and edges correspond to shared borders. This does not yield a visual answer to the problem, so you resort to the procedure described in the text. You choose one city and label it as 1, its neighbors as 2, subsequent neighbors as 3, and so on. As the procedure terminates, you realize that three cities have not been labeled, and you conclude they are located on a second island.
          <br>
</div>
</div>
        <p>Decision problems for which there exist a polynomial-time classical algorithm can be collected in what is probably the most well-known <i>complexity class</i>, named simply <b>P</b>. This is identified, informally, as the class of problems that a classical computer can solve <i>efficiently</i>. Problems outside of <b>P</b> are those for which the best classical algorithm must take time that grows faster than any polynomial (e.g. exponentially).</p>
        <p>
          <b>Definition 1.</b>
          <i><b>P</b> [informal]: the set of decision problems that can be solved by some classical algorithm that runs in time polynomial in the size of the input.</i>
        </p>
        <p>
          <i>Alternatively, the set of decision problems for which there exists some Boolean function <i>f</i>(<i>x</i>) such that:</i>
        </p>
        <ol type="1">
<li>
            (i)
            <p>
              <i><i>x</i> is an encoding of the problem instance in <i>n</i> bits;</i>
            </p>
          </li>
<li>
            (ii)
            <p><i>if the answer is</i>YES, <i>f</i>(<i>x</i>) = 1<i>, otherwise f</i>(<i>x</i>) = 0<i>; and</i></p>
          </li>
<li>
            (iii)
            <p><i>f</i> (<i>x</i>) <i>can be computed on a classical computer in time poly</i> (<i>n</i>).</p>
          </li>
</ol>
        <p>
          <i>In this case, the decision problem can be formulated as “given <i>x</i>, is <math><mrow><mrow><mi>f</mi><mo mathvariant="italic">⁢</mo><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>x</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></mrow><mo mathvariant="normal">=</mo><mn mathvariant="normal">1</mn></mrow></math>?”</i>
        </p>
        <p>The alternative definition above, in terms of a Boolean function <i>f</i>(<i>x</i>), may sound a bit opaque for now but will be convenient when we consider generalizations of <b>P</b>. In essence, <i>x</i> simply encodes the question (e.g. it is some encoding of the list of cities and borders in problem 1 as a binary vector), whereas <i>f</i>(<i>x</i>) encodes the answer (YES or NO).</p>
        <p>There are objections to this definition of <b>P</b>. In particular, the definition requires the existence of an algorithm that runs in polynomial time for <i>every</i> instance of the problem. What if I develop an algorithm that runs in polynomial time for <i>most</i> instances of a problem? Or for a subclass of instances relevant for a particular practical application? For problem 1, for example, one can easily devise an algorithm that works much faster than what I described above for the particular case of a map where one city borders all others. Also, what if my algorithm had runtime <i>n</i><sup>100</sup>, should we label that as more efficient than an algorithm that has runtime 1.00001<sup><i>n</i></sup>, just because the first is a polynomial while the second is an exponential?</p>
        <p>These are all valid objections. Nonetheless, the definition of <b>P</b> has historically been very useful, laying the foundations for the structure of complexity classes that has proven so far to be quite robust. From now on we take this and subsequent definitions for granted in order to make meaningful claims about the complexity of simulating quantum mechanical particles, but we direct the interested reader to chapter 1 of [<span class="ref"><sup class="xref xrefblue">1</sup><span class="refCtt closed"><span>1. S. Arora and B. Barak, Computational Complexity: A Modern Approach (Cambridge University Press, Cambridge, 2009).</span></span></span>] for a more thorough discussion.</p>
        <p>One complexity class doesn’t quite make up a useful classification scheme, so let us now define another, again with an example.</p>
        <p>
          <b>Problem 2.</b>
          <i>While studying more ancient tablets, you come across the following story.</i>
        </p>
        <p>
          <i>A king ruled the land many years ago. He had two twin children, and it was unclear which of them would inherit the throne. The king thus decided to divide his kingdom between the two. However, he wished to enforce cooperation between his bickering descendants. The king then established the following rule: each town in the kingdom was to be assigned to one of the children, but in such a way that no two neighboring towns could be under the rule of the same person. The overly optimistic monarch reasoned that, in this way, every time one his children wanted to move goods or people between their towns they would be forced to cross territory owned by their sibling, and they would be forced to cooperate.</i>
        </p>
        <p>
          <i>You strongly doubt the king’s reasoning but, in any case, how can you tell whether such a division is possible<span class="ref footnote"><sup class="xref">6</sup><span class="refCtt closed"><span class="refCttPadding">
        This problem is known as 2-COLORING, or more generally k-COLORING if the king had k children.
      </span></span></span> ? You only possess the list of towns and borders, as in the problem 1.</i>
        </p>
        <p>This problem is actually quite easy to solve by a minor modification of the algorithm I described for problem 1, and it is thus also in <b>P</b>. Something interesting happens, however, if we assume that the king had more than just two children. If the king had <i>four</i> children, the answer would always be yes. This follows from the four-color theorem, which states simply that any separation of a planar shape in contiguous regions (i.e. a map) can be colored with four colors in such a way that no two adjacent regions have the same color<span class="ref footnote"><sup class="xref">7</sup><span class="refCtt closed"><span class="refCttPadding">
        <strong class="fn-title">7</strong>
        This is one the first major theorems proven using a computer!
      </span></span></span>.</p>
        <p>What happens if the king instead had three children? In this case, there is no known efficient algorithm to decide whether the distribution of regions desired by the king is possible. Curiously, however, <i>if</i> such a division of the kingdom is possible, and some court magician used their magic powers to find it, they could easily convince the king of this fact. To that end, they could simply provide the king with a list of the cities assigned to each heir. It would be a much easier task to <i>check</i> that the assignment follows the rules imposed by the king than it would be to <i>find</i> such an assignment. Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS3_F5"><span class="sci-ico-fileFigure"></span>5</a> shows an example.</p>
        <div class="row fig" id="S3_F5">
<a name="S3_F5"></a><div class="col-md-4 col-sm-4"><a href="" data-toggle="modal" data-target="#ModalFigS3_F5"><div class="thumbImg">
<img src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/051f0db58daaed985fc93572d8700cc8df284d3c.jpg"><div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8 col-sm-8">
<strong>Figure 5</strong><br>
            A map of the king’s island, which he wishes to divide between his children according to the rules of problem 2. If the king only has two children, this task is impossible, as this map is not 2-colorable. A proof of this fact follows by analyzing the possibilities around the triple border in the center or the map. The map is 3-colorable, so the division is possible if the king has three children, as shown above. (If the king evicts everyone from the green region and removes it from the kingdom, the map does become 2-colorable.)
          <br>
</div>
</div>
        <p>Problems with the above feature—where a solution can be verified efficiently regardless of whether it can be obtained efficiently–define the second most well-known complexity class: <b>NP</b>.</p>
        <p><b>Definition 2.</b><i><b>NP</b> [informal]: the set of decision problems with the property that, when the answer is yes, there exists a certificate which can be used to check this fact efficiently (i.e.</i> verifying<i>the solution is in <b>P</b>).</i></p>
        <p>
          <i>Alternatively, the set of decision problems for which there exists some Boolean function <i>f</i>(<i>x</i>,<i>y</i>) such that:</i>
        </p>
        <ol type="1">
<li>
            (i)
            <p>
              <i><i>x</i> is an encoding of the problem instance in <i>n</i> bits;</i>
            </p>
          </li>
<li>
            (ii)
            <p><i><i>y</i> is an <i>m</i>-bit string (known as a</i>certificate<i>), withm</i> = <i>poly</i>(<i>n</i>)<i>;</i></p>
          </li>
<li>
            (iii)
            <p><i>f</i> (<i>x</i>, <i>y</i>) <i>can be computed on a classical computer in time poly</i><math display="block"><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></math><i>; and</i></p>
          </li>
<li>
            (iv)
            <p><i>if the answer to the decision problem is</i>YES,there exists<i><i>y</i> such that</i><math><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>1</mn></mrow></math><i>. Conversely, if the answer is</i>NO<i>there is no <i>y</i> such thatf</i>(<i>x</i>,<i>y</i>) = 1<i>.</i></p>
          </li>
</ol>
        <p>
          <i>In this case, the decision problem can be formulated as “given <i>x</i>, does there exist <i>y</i> such that <i>f</i>(<i>x</i>,<i>y</i>)= 1?”</i>
        </p>
        <p>There are countless known problems in <b>NP</b>. The version of problem 2 where the king has three children, known as 3-COLORING, is one example. Others including finding the prime factors of some integer (FACTORING), the traveling salesman problem, and many optimization problems. So far the definition of <b>NP</b> may seem a bit loose, simply collecting a variety of unrelated problems. However, it is made much more robust by the notion of <b>NP</b>–completeness.</p>
        <p>An <b>NP</b>–complete problem is an <b>NP</b> problem with the property that every other <b>NP</b> problem <i>reduces</i> to it. We will see concrete examples of reductions in the next section (involving the determinant and the permanent) but, for now, it suffices to say that a reduction from problem <i>A</i> to problem <i>B</i> is a way of <i>efficiently</i> converting an instance of <i>A</i> to an instance of <i>B</i>. If an efficient algorithm for <i>B</i> exists, this then implies that <i>A</i> can be solved efficiently as well, simply by mapping it to <i>B</i> and using the algorithm for <i>B</i> as a subroutine. In other words, a reduction from <i>A</i> to <i>B</i> implies that <i>B</i> has to be <i>at least as hard as A</i>. Consequently, <b>NP</b>–complete problems are the hardest among all <b>NP</b> problems, since an efficient algorithm for one of them could be used as an efficient algorithm for any other.</p>
        <p>The definition makes <b>NP</b>–complete problems sound very useful! One can wonder, then, whether they exist at all—and, if so, are they common? The first question was answered in one of the foundational results of computational complexity theory, known as the Cook-Levin theorem [<span class="ref"><sup class="xref xrefblue">22</sup><span class="refCtt closed"><span>22. S.A. Cook, in Proceedings of the Third Annual ACM Symposium on Theory of Computing (Ohio, 1971).</span></span></span>, <span class="ref"><sup class="xref xrefblue">23</sup><span class="refCtt closed"><span>23. L.A. Levin, Problemy Peredači Informacii 9, 115 (1973).</span></span></span>], which essentially states that <b>NP</b>–complete problems do indeed exist, and provides an example (a problem known as Boolean satisfiability problem, or SAT). Soon after, Karp published 21 additional <b>NP</b>–complete problems [<span class="ref"><sup class="xref xrefblue">24</sup><span class="refCtt closed"><span>24. R.M. Karp, in Complexity of Computer Computations: Proceedings of a Symposium on the Complexity of Computer Computations, edited by R. E. Miller,J. W. Thatcher and J. D. Bohlinger (Plenum Press, Boston, 1972), pp. 85–103.</span></span></span>], and since then thousands more have been discovered [<span class="ref"><sup class="xref xrefblue">25</sup><span class="refCtt closed"><span>25. M.R. Garey and D.S. Johnson, Computers and Intractability; A Guide to theTheory of NP-Completeness (W. H. Freeman and Co., New York, 1990).</span></span></span>].</p>
        <p>Complexity theory is the study of relations between these classes, so how are <b>P</b> and <b>NP</b> related? It is straightforward to see that <b>P</b> ⊆ <b>NP</b>. If the king wants to know whether it is possible to divide the kingdom between his two children to his satisfaction, he can just ignore the solution provided by the court magician and solve the problem himself. The reverse question, whether <b>NP</b> ⊆ <b>P</b> is one of the most important open problems in computer science, and one of the seven Millennium Prize Problems stated by the Clay Mathematics Institute [<span class="ref"><sup class="xref xrefblue">2</sup><span class="refCtt closed"><span>2. https://www.claymath.org/millennium-problems.</span><br><a href="https://www.claymath.org/millennium-problems" target="_blank">https://www.claymath.org/millennium-prob...
            </a></span></span>]. It is impossible to overstate the importance of this question, and I cannot do justice to it here. If it turns out that <b>P</b> = <b>NP</b>, then the mere ability to check the correctness of the solution to a problem would imply the ability to solve it, and our world would likely become a very different place (for an entertaining and nontechnical discussion of the importance of the <b>P</b> vs. <b>NP</b> question, we direct the interested reader to ref. [<span class="ref"><sup class="xref xrefblue">26</sup><span class="refCtt closed"><span>26. L. Fortnow, The Golden Ticket: P, NP and the Search for the Impossible (Princeton University Press, New Jersey, 2017).</span></span></span>]).</p>
        <p>Our interest here is not on the <b>P</b> vs. <b>NP</b> question, our goal lies in higher levels of the structure of complexity classes. However, this digression aims to illustrate the role played by some <i>conjectures</i> in computational complexity theory. Even though it is currently unknown whether <b>NP</b> is contained in <b>P</b>, many researchers consider that the answer is probably negative. There are thousands of <b>NP</b>–complete problems in several fields of knowledge, such as economics, graph theory, number theory, physics, biology and so on. Finding an efficient algorithm for <i>any</i> of them (equivalently, proving that any of them is in <b>P</b>) would cause a collapse and imply that <b>P</b> = <b>NP</b>. As a matter of fact, there are only a handful of problems which are <i>not</i> known to be either <b>NP</b>–complete or in <b>P</b> (the most famous examples being factoring and graph isomorphism [<span class="ref"><sup class="xref xrefblue">25</sup><span class="refCtt closed"><span>25. M.R. Garey and D.S. Johnson, Computers and Intractability; A Guide to theTheory of NP-Completeness (W. H. Freeman and Co., New York, 1990).</span></span></span>]). And yet, decades of research have failed to produce an efficient algorithm for any one of these problems.</p>
        <p>An analogy can be traced between the belief that <b>P</b> ≠ <b>NP</b> and the laws of thermodynamics prior to the invention of statistical mechanics. The laws of thermodynamics are empirical observations about the world, not proven facts. Despite no proof that it was impossible, any early-19th century scientist familiar with thermodynamic theory would be wary of investing in a project of a perpetual motion machine. Similarly, there is no proof that <b>P</b> ≠ <b>NP</b>, but any proposed efficient algorithm for e.g. the traveling salesman problem is regarded with skepticism unless it clearly uses novel ingredients missed by the community for the last several decades.</p>
        <p>Of course, the <b>P</b> vs. <b>NP</b> question is different from the laws of thermodynamics in a fundamental way. Though statistical mechanics subsumes thermodynamics in some sense, it has replaced the latter’s laws by microscopic principles which are still essentially empirical. The question of whether <b>P</b> = <b>NP</b>, on the other hand, is a well-posed mathematical question, which in principle has a definite truth value and presumably can be proven. Nonetheless, I can give two examples to justify why the analogy is apt. The first is the fact that, to date, one of the methods used for public-key cryptography, known as RSA [<span class="ref"><sup class="xref xrefblue">27</sup><span class="refCtt closed"><span>27. R.L. Rivest, A. Shamir and L. Adleman, Commun. ACM 21, 120 (1978).</span></span></span>], depends on the assumption that factoring large integers is a much harder problem than multiplication. The second is that one of the crown jewels of the field of quantum computing is Shor’s algorithm [<span class="ref"><sup class="xref xrefblue">7</sup><span class="refCtt closed"><span>7. M.A. Nielsen and I.L. Chuang, Quantum Computation and Quantum Information (Cambridge University Press, Cambridge, 2000).</span></span></span>, <span class="ref"><sup class="xref xrefblue">8</sup><span class="refCtt closed"><span>8. P.W. Shor, SIAM J. Comput. 26, 1484 (1997).</span></span></span>], which precisely shows how to factor large integers in polynomial time on a quantum computer. Though Shor’s algorithm is no longer the main driving force behind research (and funding) on quantum computing, it certainly holds a special place kick-starting widespread interest in it. Both of these endeavors are predicated on the <i>conjecture</i> that factoring is a hard problem for classical computers—despite the fact that factoring is not even the hardest among <b>NP</b> problems!</p>
        <p>The belief in conjectures such as that <b>P</b> ≠ <b>NP</b> has led to several results in theoretical computer science of the form “if claim X was true, it would imply <b>P</b> = <b>NP</b>, therefore X is probably not true”. The entire field of quantum computing in a sense stands on similar assumptions, given that there is no <i>proof</i> that a quantum computer really is faster than its classical counterpart. In the following section we will use a similar conjecture to give evidence of the large discrepancy in complexity between the determinant and the permanent and, subsequently, between the computational power of bosons and fermions. Hopefully the preceding discussion has made it clear why these conjectures, though still unproven, are not empty or unjustified.</p>
      
      
        <h2>3.2. The polynomial hierarchy and countingproblems</h2>
        <p>Let us now move a few rungs up the complexity ladder to define two new complexity classes, <b>PH</b> and #<b>P</b>, which will be central to our main argument.</p>
        <p>The polynomial hierarchy, or <b>PH</b>, is a tower of generalizations of <b>P</b> and <b>NP</b>, which can be defined as follows.</p>
        <p>
          <b>Definition 3.</b>
          <i><b>PH</b>: The set of decision problems for which there exists some Boolean function <i>f</i>(<i>x</i>,<i>y</i>,<i>z</i>,<i>w</i>,…) such that:</i>
        </p>
        <ol type="1">
<li>
            (i)
            <p>
              <i><i>x</i> is some encoding of the problem instance in <i>n</i> bits;</i>
            </p>
          </li>
<li>
            (ii)
            <p><i>y</i>, <i>z</i>, <i>w are poly</i>(<i>n</i>)<i>-sized strings;</i></p>
          </li>
<li>
            (iii)
            <p>
              
                <math display="inline">
                  <mrow>
                    <mi>f</mi>
                    <mo>⁢</mo>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>x</mi>
                      <mo>,</mo>
                      <mi>y</mi>
                      <mo>,</mo>
                      <mi>z</mi>
                      <mo>,</mo>
                      <mi>w</mi>
                      <mo>,</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </mrow>
                </math>
              
              <i>can be computed on a classical computer in time poly</i>
              
                <math display="inline">
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <mi>n</mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </math>
              
              <i>.</i>
            </p>
          </li>
</ol>
        <p>
          <i>The decision problem can then be formulated as “given input x, does there exist y such that for all z, there exists w such that … <math><mrow><mrow><mi>f</mi><mo mathvariant="italic">⁢</mo><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>x</mi><mo mathvariant="normal">,</mo><mi>y</mi><mo mathvariant="normal">,</mo><mi>z</mi><mo mathvariant="normal">,</mo><mrow><mi>w</mi><mo mathvariant="italic">⁢</mo><mi mathvariant="normal">…</mi></mrow><mo mathvariant="normal" stretchy="false">)</mo></mrow></mrow><mo mathvariant="normal">=</mo><mn mathvariant="normal">1</mn></mrow></math>?”</i>
        </p>
        <p>This formulation of <b>PH</b> justifies our inclusion of the function-based definitions of <b>P</b> and <b>NP</b>, as it is a straightforward generalization of them. Technically, <b>PH</b> is not a complexity class, but rather a union of infinitely many classes. For each number of sequential “there exists” and “for all” quantifiers, the corresponding set of problems defines one <i>level</i> of <b>PH</b>. <b>P</b> corresponds to level 0, <b>NP</b> (and the closely related co-<b>NP</b>, which we have not seen) correspond to level 1, and so on.</p>
        <p>I will not go into further details of the definition, or even examples of problems within higher levels of <b>PH</b>. For us, the polynomial hierarchy will serve simply as a proof mechanism. It can be shown that, if any two levels of <b>PH</b> are equal, then the entire tower collapses to that level. For example, if <b>P</b> = <b>NP</b>, it follows that the tower collapses to its level 0, i.e. <b>PH</b> = <b>P</b>. Our main conclusions will then be predicated on the conjecture that this does not happen, and that the polynomial hierarchy is infinite. This is a very common generalization of the conjecture-based argument described in the previous sections, but now of the form “if X is true the polynomial hierarchy collapses to its <i>n</i>th level, therefore X is probably not true”. This is a reasonable conjecture, as there is no reason to expect the class of problems of the form “given input <i>x</i>, does there exist <i>y</i> such that for all <i>z</i>, there exists <i>w</i>… is <i>f</i>(<i>x</i>,<i>y</i>,<i>z</i>,<i>w</i>…) = 1?” to simply terminate after some number of quantifiers. Note however that it is a strictly <i>weaker</i> conjecture than <b>P</b> ≠ <b>NP</b>, since it is possible for the latter to be true even if <b>PH</b> collapses (e.g. to some level above the second).</p>
        <p>Finally, the last complexity class we will need is #<b>P</b>, which can be defined as follows:</p>
        <p>
          <b>Definition 4.</b>
          <i>#<b>P</b> [informal]: The set of problems of the type “compute the number of solutions to an <b>NP</b> problem”.</i>
        </p>
        <p>Note that #<b>P</b> collects problems of a different nature than the previous classes we encountered, namely <i>counting</i> problems rather than <i>decision</i> problems. One example would be if the king from problem 2 wanted to know not only whether it is <i>possible</i> to divide the kingdom between his children as desired, but rather how many different ways there are to make this division. In the next section we will show <i>how the</i> permanent of a matrix can be cast as a #<b>P</b> problem.</p>
        <p>How does #<b>P</b> relate to the classes we saw previously? First, #<b>P</b> problems must be harder than <b>NP</b> problems by definition. If we can count the number of solutions to an <b>NP</b> problem, we can easily find out whether a solution exists, just by checking whether the number of solutions is larger than 0! On the other hand, even if a solution to a particular problem happens to be easy to find, there might be exponentially many different solutions, and counting all of them might be much harder. A well-known result in complexity theory, Toda’s theorem, establishes that #<b>P</b> is in fact harder than the entire polynomial hierarchy:</p>
        <p>
          <b>Theorem 1.</b>
          <i>Toda’s Theorem [<span class="ref"><sup class="xref xrefblue">28</sup><span class="refCtt closed"><span>28. S. Toda, SIAM J. Comput. 20, 865 (1991).</span></span></span>]: <b>PH</b> ⊆ <b>P</b><sup>#P</sup></i>
        </p>
        <p>Note that, technically, we cannot write <b>PH</b> ⊆#<b>P</b>. This makes no sense, since <b>PH</b> is a set of decision problems, while #<b>P</b> is a set of counting problems, so they are not directly comparable. This is resolved by defining the class <b>P</b><sup>#<b>P</b></sup>, which informally means the set of decision problems that a classical computer could solve efficiently if it had access to an auxiliary machine capable of solving counting problems.</p>
        <p>We have now constructed the cross-section of the structure of complexity classes that we will need, consisting of <b>P</b>, <b>NP</b>, <b>PH</b> and #<b>P</b>. However, this is far from a complete picture of computational complexity theory. In Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS3_F6"><span class="sci-ico-fileFigure"></span>6</a> we represent these classes in relation to a few well-known others, but there are in fact several hundred known complexity classes to date, and we direct the reader to the Complexity Zoo website [<span class="ref"><sup class="xref xrefblue">3</sup><span class="refCtt closed"><span>3. https://complexityzoo.net/Complexity_Zoo.</span><br><a href="https://complexityzoo.net/Complexity_Zoo" target="_blank">https://complexityzoo.net/Complexity_Zoo...
            </a></span></span>] for a full listing.</p>
        <div class="row fig" id="S3_F6">
<a name="S3_F6"></a><div class="col-md-4 col-sm-4"><a href="" data-toggle="modal" data-target="#ModalFigS3_F6"><div class="thumbImg">
<img src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/85dc22b3e4384236b1b514b02ddf7bf80ecf69c6.jpg"><div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8 col-sm-8">
<strong>Figure 6</strong><br>
            Abridged version of the petting zoo of complexity classes [<span class="ref"><sup class="xref xrefblue">3</sup><span class="refCtt closed"><span>3. https://complexityzoo.net/Complexity_Zoo.</span><br><a href="https://complexityzoo.net/Complexity_Zoo" target="_blank">https://complexityzoo.net/Complexity_Zoo...
            </a></span></span>], focusing on the most common classes and those important for this work. The only classes not mentioned in the main text are <b>PSPACE</b>, corresponding to problems solvable by a classical computer with polynomial memory (regardless of how long it takes), and <b>EXP</b>, which corresponds to problems which classical computers can solve given exponential time. Lines indicates inclusions, from bottom to top (e.g. <b>P</b> ⊆ <b>NP</b>), though not necessarily strict inclusions (e.g. it is unknown whether <b>NP</b> ⊆ <b>P</b>).
          <br>
</div>
</div>
      
      
        <h2>3.3. The determinant and the permanent</h2>
        <p>Let us now see how the determinant and permanent functions fit within the classification scheme described in the previous section. Consider first the determinant. Recall its definition:</p>
        <div class="row formula" id="eS3_Ex36">
<a name="S3_Ex36"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mo movablelimits="false">det</mo>
                  <mo>⁡</mo>
                  <mi>A</mi>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <munder>
                    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                    <mrow>
                      <mi>σ</mi>
                      <mo>∈</mo>
                      <msub>
                        <mi>S</mi>
                        <mi>n</mi>
                      </msub>
                    </mrow>
                  </munder>
                  <mrow>
                    <mtext>sgn</mtext>
                    <mo>⁢</mo>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>σ</mi>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mrow>
                      <munderover>
                        <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
                        <mrow>
                          <mi>i</mi>
                          <mo>=</mo>
                          <mn>1</mn>
                        </mrow>
                        <mi>n</mi>
                      </munderover>
                      <mpadded width="-1.7pt">
                        <msub>
                          <mi>A</mi>
                          <mrow>
                            <mi>i</mi>
                            <mo>,</mo>
                            <msub>
                              <mi>σ</mi>
                              <mi>i</mi>
                            </msub>
                          </mrow>
                        </msub>
                      </mpadded>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>where <i>A</i> is an <i>n</i>×<i>n</i> matrix. This expression is a very inefficient way to perform the computation, as it requires the summation of <i>n</i>! terms. This does not mean that there is no better alternative. Recall that the determinant has the following property:</p>
        <div class="row formula" id="eS3_Ex37">
<a name="S3_Ex37"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mo movablelimits="false">det</mo>
                  <mo>⁡</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <mrow>
                      <mi>X</mi>
                      <mo>⁢</mo>
                      <mi>Y</mi>
                    </mrow>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mo movablelimits="false">det</mo>
                  <mo>⁡</mo>
                  <mrow>
                    <mi>X</mi>
                    <mo>⁢</mo>
                    <mrow>
                      <mo movablelimits="false">det</mo>
                      <mo>⁡</mo>
                      <mi>Y</mi>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>This provides a shortcut for computing the determinant. Rather than use the definition, we can instead rewrite <i>A</i> as a product of matrices whose determinants are easy to compute. One example is the standard high school method for computing the determinant and solving linear systems based on Gaussian elimination. This procedure is based on applying three types of transformations on the rows of <i>A</i>: (i) swapping two rows, (ii) multiplying a row by a scalar <i>c</i>, and (iii) adding one row to another. All three steps can be written as multiplying <i>A</i> by particular matrices, whose respective determinants are (i) –1, (ii) the scalar <i>c</i> or (iii) 1. At the end of this procedure, <i>A</i> is taken into another matrix, <i>A</i>′, that is in upper triangular form. In other words, we can write:</p>
        <div class="row formula" id="eS3_Ex38">
<a name="S3_Ex38"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mi>A</mi>
                  <mo>⁢</mo>
                  <msub>
                    <mi>B</mi>
                    <mn>1</mn>
                  </msub>
                  <mo>⁢</mo>
                  <msub>
                    <mi>B</mi>
                    <mn>2</mn>
                  </msub>
                  <mo>⁢</mo>
                  <mi mathvariant="normal">…</mi>
                  <mo>⁢</mo>
                  <msub>
                    <mi>B</mi>
                    <mi>m</mi>
                  </msub>
                </mrow>
                <mo>=</mo>
                <msup>
                  <mi>A</mi>
                  <mo>′</mo>
                </msup>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>where the number of operations is <i>m</i> = <i>n</i>(<i>n</i> + 1)/2 &lt; <i>n</i><sup>2</sup>. Notice that det⁡<i>A</i>′ is easy to compute, since <i>A</i>′ is in upper triangular form, and its determinant is just the product of the diagonal elements. Therefore, we can write</p>
        <div class="row formula" id="eS3_Ex39">
<a name="S3_Ex39"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mo movablelimits="false">det</mo>
                  <mo>⁡</mo>
                  <mi>A</mi>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msup>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mrow>
                        <mo movablelimits="false">det</mo>
                        <mo>⁡</mo>
                        <mrow>
                          <msub>
                            <mi>B</mi>
                            <mn>1</mn>
                          </msub>
                          <mo>⁢</mo>
                          <mi mathvariant="normal">…</mi>
                          <mo>⁢</mo>
                          <mrow>
                            <mo movablelimits="false">det</mo>
                            <mo>⁡</mo>
                            <msub>
                              <mi>B</mi>
                              <mi>m</mi>
                            </msub>
                          </mrow>
                        </mrow>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo movablelimits="false">det</mo>
                    <mo>⁡</mo>
                    <msup>
                      <mi>A</mi>
                      <mo>′</mo>
                    </msup>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>which requires computing less than <i>n</i><sup>2</sup> easy determinants. If we carefully account for all the intermediate steps in the Gaussian elimination, this algorithm requires roughly <i>n</i><sup>3</sup> steps<span class="ref footnote"><sup class="xref">8</sup><span class="refCtt closed"><span class="refCttPadding">
        <strong class="fn-title">8</strong>
        One caveat is that this algorithm can produce intermediate numbers with exponentially many digits [29], but there are better algorithms which are truly polynomial [30].
      </span></span></span>. Since this is polynomial in the size of the matrix, this places computation of the determinant in <b>P</b><span class="ref footnote"><sup class="xref">9</sup><span class="refCtt closed"><span class="refCttPadding">
        <strong class="fn-title">9</strong>
        The alert reader may protest that computing the determinant is not a decision problem, so it cannot be in P. This is technically true, though it is possible to replace the problem of computing det⁡A by a sequence of decision problems of the type “is the nth digit of det⁡A greater than 5?”, which allows us to reconstruct det⁡A to a desired precision. So we stick to standard imprecise terminology and state that the determinant is in P.
      </span></span></span>.</p>
        <p>Having shown that the determinant can be computed efficiently, what about the permanent? Can we use a similar trick? Alas, the answer seems to be no. In general per<i>XY</i>≠per<i>X</i>per<i>Y</i>, so it is not possible to perform an efficient tracking of the permanent during Gaussian elimination, as was done for the determinant. We will now give a stronger argument why it is unlikely that the permanent can be computed efficiently. Before we get to that, however, let us define another useful problem, that of perfect matchings (illustrated in Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS3_F7"><span class="sci-ico-fileFigure"></span>7</a>).</p>
        <div class="row fig" id="S3_F7">
<a name="S3_F7"></a><div class="col-md-4 col-sm-4"><a href="" data-toggle="modal" data-target="#ModalFigS3_F7"><div class="thumbImg">
<img src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/88dccff995a208d31e8e30627ba3bb04aa203428.jpg"><div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8 col-sm-8">
<strong>Figure 7</strong><br>
            The problem of finding a perfect matching between a group of students. Blue and orange dots represent senior and junior students, respectively. For every pair of students that are willing to work together, we draw an edge between them. In blue, we represent one possible solution to this problem. For this example, there are three possible perfect matchings.
          <br>
</div>
</div>
        <p>
          <b>Problem 3.</b>
          <i>Upon finishing your archaeological dig, you return to your regular life as a university professor. On your first class of the semester, you are assigned two groups, one composed of <i>n</i> junior students and the other of <i>n</i> senior students. To improve the performance of the junior students, you decide to pair each of them with one senior student. However, you are aware that some pairs of students simply despise each other, and will refuse to work together. Is it possible to find a pairing of the students, one from each group, such that no student is left to work alone? This is known as a perfect matching.</i>
        </p>
        <p>How hard is this problem? It can be shown that it is in <b>P</b>, and I will now describe a simple procedure that (almost) proves this.</p>
        <p>We begin by labeling the senior students as (<i>s</i><sub>1</sub>,<i>s</i><sub>2</sub>,…<i>s</i><sub><i>n</i></sub>), and the junior students as (<i>j</i><sub>1</sub>,<i>j</i><sub>2</sub>…<i>j</i><sub><i>n</i></sub>). We then construct a matrix <i>A</i> (known as the Edmonds matrix in graph theory [<span class="ref"><sup class="xref xrefblue">31</sup><span class="refCtt closed"><span>31. R. Motwani and P. Raghavan, Randomized Algorithms (Cambridge University Press, Cambridge, 1995).</span></span></span>]) by the following prescription:</p>
        <div class="row formula" id="eS3_E11">
<a name="S3_E11"></a><div class="col-md-12"><div class="formula-container">
          <span class="label">(11)</span>
          <math display="block">
            <mrow>
              <msub>
                <mi>A</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>⁢</mo>
                  <mi>k</mi>
                </mrow>
              </msub>
              <mo>=</mo>
              <mrow>
                <mo>{</mo>
                <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                  <mtr>
                    <mtd columnalign="left">
                      <msub>
                        <mi>x</mi>
                        <mrow>
                          <mi>i</mi>
                          <mo>⁢</mo>
                          <mi>k</mi>
                        </mrow>
                      </msub>
                    </mtd>
                    <mtd columnalign="left">
                      <mrow>
                        <mtext> if </mtext>
                        <mo>⁢</mo>
                        <msub>
                          <mi>s</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>⁢</mo>
                        <mtext> and </mtext>
                        <mo>⁢</mo>
                        <msub>
                          <mi>j</mi>
                          <mi>k</mi>
                        </msub>
                        <mo>⁢</mo>
                        <mtext> would work together,</mtext>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd columnalign="left">
                      <mn>0</mn>
                    </mtd>
                    <mtd columnalign="left">
                      <mrow>
                        <mtext> otherwise</mtext>
                        <mo>.</mo>
                      </mrow>
                    </mtd>
                  </mtr>
                </mtable>
              </mrow>
            </mrow>
          </math>
        </div></div>
</div>
        <p>In principle the variables <i>x</i><sub><i>ik</i></sub> are indeterminates, though for the applications we consider we can assume they can take integer values, for simplicity.</p>
        <p>For the example of Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS3_F7"><span class="sci-ico-fileFigure"></span>7</a>, this matrix is given by</p>
        <div class="row formula" id="eS3_E12">
<a name="S3_E12"></a><div class="col-md-12"><div class="formula-container">
          <span class="label">(12)</span>
          <math display="block">
            <mrow>
              <mrow>
                <mi>A</mi>
                <mo>=</mo>
                <mpadded width="-1.7pt">
                  <mrow>
                    <mo>(</mo>
                    <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                      <mtr>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>12</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>13</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>21</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>22</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>24</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>31</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>34</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>44</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>45</mn>
                          </msub>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>53</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>55</mn>
                          </msub>
                        </mtd>
                      </mtr>
                    </mtable>
                    <mo>)</mo>
                  </mrow>
                </mpadded>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>Now consider the quantity det⁡<i>A</i>, as given in the definition in equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E9_1"><span class="sci-ico-fileFormula"></span>9a</a>). Clearly, it is a polynomial of degree <i>n</i> in {<i>x</i><sub><i>ik</i></sub>}. Each of its monomials contains the product of <i>n</i> elements of <i>A</i> that do not share rows or columns. Therefore, each monomial is directly associated with one way to pair the students, where senior student <i>s</i><sub><i>i</i></sub> is paired to junior student <i>j</i><sub><i>σi</i></sub>. If any of these pairs would refuse to work together, then the corresponding matrix element is 0 and that monomial does not contribute to the sum. Therefore, the only terms of det⁡<i>A</i> that survive are those corresponding to valid perfect matchings of the students! This means that we have reduced the problem of deciding whether <i>some</i> perfect matching exists to the problem of deciding whether det⁡<i>A</i> is the zero polynomial.</p>
        <p>The next step is to decide whether det⁡<i>A</i> is the zero polynomial. We can write it explicitly, e.g. for equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS3_E12"><span class="sci-ico-fileFormula"></span>12</a>) we have</p>
        <div class="row formula" id="eS3_Ex40">
<a name="S3_Ex40"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mi>det</mi>
              <mi>A</mi>
              <mo>=</mo>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>12</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>24</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>31</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>45</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>53</mn>
                </mrow>
              </msub>
              <mo>−</mo>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>12</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>21</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>34</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>45</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>53</mn>
                </mrow>
              </msub>
              <mtext> </mtext>
              <mo>−</mo>
              <mtext> </mtext>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>13</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>22</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>31</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>44</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>55</mn>
                </mrow>
              </msub>
              <mo>.</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>However, writing det⁡<i>A</i> explicitly is not efficient, as it may contain exponentially many monomials. Instead, we can use the following procedure. We first choose random values for the {<i>x</i><sub><i>ik</i></sub>} variables, and then we compute det⁡<i>A</i> for those values, which can be done efficiently, as we argued above. Suppose we repeat this procedure many times, and every time we observe that det⁡<i>A</i> = 0. The more samples we take, the higher our confidence that it is indeed the zero polynomial, since it is unlikely that we chose only roots of det⁡<i>A</i> by chance. Conversely, if det⁡<i>A</i> is not the zero polynomial, we expect to very quickly find one assignment of {<i>x</i><sub><i>ik</i></sub>} for which det⁡<i>A</i>≠0. The success probability of this procedure can be formalized by the Schwartz-Zippel lemma:</p>
        <p><b>Lemma 1</b> (Schwartz-Zippel [<span class="ref"><sup class="xref xrefblue">32</sup><span class="refCtt closed"><span>32. R. Zippel, in Proceedings of the International Symposiumon on Symbolic and Algebraic Computation (Berlin, Heidelberg, 1979).</span></span></span>, <span class="ref"><sup class="xref xrefblue">33</sup><span class="refCtt closed"><span>33. J.T. Schwartz, J. ACM 27, 701 (1980).</span></span></span>, <span class="ref"><sup class="xref xrefblue">34</sup><span class="refCtt closed"><span>34. R.A. Demillo and R.J. Lipton, Information Processing Letters 7, 193(1978).</span></span></span>)] <i>Let <i>P</i>(<i>x</i><sub>1</sub>, <i>x</i><sub>2</sub>…<i>x</i><sub><i>m</i></sub>) be a non-zero polynomial of total degree at most <i>d</i>. Let <i>S</i> be a finite set of integers. Then, if <i>a</i><sub>1</sub>, <i>a</i><sub>2</sub>,…<i>a</i><sub><i>m</i></sub> are randomly chosen from <i>S</i>, then</i></p>
        <div class="row formula" id="eS3_Ex42">
<a name="S3_Ex42"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mtext mathvariant="italic">Pr</mtext>
                <mtext> </mtext>
              </mrow>
              <mrow>
                <mo stretchy="false">[</mo>
                <mi>P</mi>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <msub>
                    <mi>a</mi>
                    <mn>1</mn>
                  </msub>
                  <mo>,</mo>
                  <msub>
                    <mi>a</mi>
                    <mn>2</mn>
                  </msub>
                  <mi mathvariant="normal">…</mi>
                  <msub>
                    <mi>a</mi>
                    <mi>n</mi>
                  </msub>
                  <mo stretchy="false">)</mo>
                </mrow>
                <mo>=</mo>
                <mn>0</mn>
                <mo stretchy="false">]</mo>
              </mrow>
              <mo>≤</mo>
              <mfrac>
                <mi>d</mi>
                <mrow>
                  <mo fence="true" stretchy="false">|</mo>
                  <mi>S</mi>
                  <mo fence="true" stretchy="false">|</mo>
                </mrow>
              </mfrac>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p><i>where</i> |<i>S</i>| <i>is the number of elements of S</i>.</p>
        <p>Clearly, the Schwartz-Zippel lemma guarantees that we can make the probability of failure of the previous procedure arbitrarily small. Therefore, we conclude that the problem of deciding whether a perfect matching of the students exists is at most as hard as computing the determinant, and thus it can be done efficiently on a classical computer.</p>
        <p>The preceding argument does not quite place the problem of perfect matching in <b>P</b>, because the definition of <b>P</b> does not allow for randomness or a tiny (but non-zero) failure probability. It does place the problem in <b>BPP</b>, which is the generalization of <b>P</b> that does allow randomness, but which we have not defined. In any case, there are other ways to prove that perfect matching is in <b>P</b>, both in the versions of deciding whether one exists and actually <i>finding</i> one [<span class="ref"><sup class="xref xrefblue">35</sup><span class="refCtt closed"><span>35. L. Lovász and M.D. Plummer, Matching Theory (North-Holland Mathematics Studies, Holland, 1986), v. 121.</span></span></span>].</p>
        <p>What if we now consider the problem of <i>counting</i> the number of perfect matchings? Interestingly, even though the decision version of the problem is easy, the counting version is actually #<b>P</b>–complete. Recall that an <b>NP</b>–complete problem was one of the hardest <b>NP</b> problems, and the definition of #<b>P</b>–complete is similar. A problem is #<b>P</b>–complete if every other #<b>P</b> problem reduces to it. If there exists an efficient algorithm to count the number of perfect matchings, then every #<b>P</b> problem would also be solvable efficiently. From the discussion of the previous section, this would imply that the entire polynomial hierarchy would come crashing down and collapse to <b>P</b>, due to Theorem 1. This suggests that such an efficient algorithm is very unlikely indeed!</p>
        <p>The #<b>P</b>–completeness of counting the number of perfect matchings in a graph was shown, by Valiant, in the same paper that defined the #<b>P</b> class [<span class="ref"><sup class="xref xrefblue">36</sup><span class="refCtt closed"><span>36. L.G. Valiant, Theoretical Computer Science 8, 189 (1979).</span></span></span>], and where he proved that the permanent is also #<b>P</b>–complete. To see why the latter is true, consider the Edmonds matrix <i>A</i> we constructed in equation <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS3_E11"><span class="sci-ico-fileFormula"></span>11</a>, but set all (nonzero) variables <i>x</i><sub><i>ik</i></sub> to 1, obtaining the following matrix (known as the biadjacency matrix)</p>
        <div class="row formula" id="eS3_E13">
<a name="S3_E13"></a><div class="col-md-12"><div class="formula-container">
          <span class="label">(13)</span>
          <math display="block">
            <mrow>
              <mrow>
                <msup>
                  <mi>A</mi>
                  <mo>′</mo>
                </msup>
                <mo>=</mo>
                <mpadded width="-1.7pt">
                  <mrow>
                    <mo>(</mo>
                    <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                      <mtr>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                      </mtr>
                    </mtable>
                    <mo>)</mo>
                  </mrow>
                </mpadded>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>When computing det⁡<i>A</i>, we argued that every nonzero monomial in that sum corresponded to one valid perfect matching. By the exact same argument, each of the monomials in det <i>A</i>′ takes value 1 for a perfect matching and 0 otherwise. If we now drop the minus signs from the definition of the determinant, the resulting expression <i>counts</i> the number of perfect matchings. But that is simply the definition of per <i>A</i>′</p>
        <div class="row formula" id="eS3_Ex43">
<a name="S3_Ex43"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mpadded width="+5pt">
                    <mtext>per</mtext>
                  </mpadded>
                  <mo>⁢</mo>
                  <msup>
                    <mi>A</mi>
                    <mo>′</mo>
                  </msup>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <munder>
                    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                    <mrow>
                      <mi>σ</mi>
                      <mo>∈</mo>
                      <msub>
                        <mi>S</mi>
                        <mi>n</mi>
                      </msub>
                    </mrow>
                  </munder>
                  <mrow>
                    <munderover>
                      <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
                      <mrow>
                        <mi>i</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mi>n</mi>
                    </munderover>
                    <mpadded width="-1.7pt">
                      <msubsup>
                        <mi>A</mi>
                        <mrow>
                          <mi>i</mi>
                          <mo>,</mo>
                          <msub>
                            <mi>σ</mi>
                            <mi>i</mi>
                          </msub>
                        </mrow>
                        <mo>′</mo>
                      </msubsup>
                    </mpadded>
                  </mrow>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>Since counting perfect matchings is #<b>P</b>–complete, this proves that computing the permanent of a matrix—furthermore, even one whose elements are 0 or 1—is #<b>P</b>–complete as well, since any #<b>P</b> problem can be reduced to counting perfect matchings and subsequently to the permanent.</p>
        <p>Let us summarize the conclusions of this section. First, we argued that the determinant is in <b>P</b>. Then we showed that deciding <i>whether</i> a set of students can be matched perfectly can be reduced to the determinant, and hence it is also easy. We then showed that <i>counting</i> in how many ways we can match these students reduces to the permanent. But this counting is known to be #<b>P</b>–complete, and therefore the permanent is #<b>P</b>–complete. If we now look back at Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS3_F6"><span class="sci-ico-fileFigure"></span>6</a>, this shows us how radically different the permanent and determinant are, in terms of complexity–at least if we assume there are no major collapses in these complexity classes.</p>
        <p>This concludes our review of computational complexity theory. We now have the tools necessary to investigate the difference in complexity of bosons and fermions. The previous paragraph suggests that bosonic linear optics should be computationally more complex, in some sense, than fermionic linear optics, due to the difference between the determinant and the permanent that appear in equations (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E8_1"><span class="sci-ico-fileFormula"></span>8</a>). However, there is more work to be done to justify that claim, because quantum-mechanical probabilities are not directly observable. Therefore, we need to define more formally what does it mean to <i>simulate</i> a quantum system.</p>
      
    
      <h1 class="articleSectionTitle">4. Sampling of bosons and fermions</h1>
      
        <h2>4.1. Classical simulation</h2>
        <p>There are many notions of what it means to simulate a quantum system. We might want to compute its energy levels and describe the corresponding eigenstates, or obtain the expectation value of some observable, or compute the probabilities associated with particular outcomes. Our approach will be to formulate a concrete <i>computational task</i> that we could in principle perform experimentally using fermions or bosons, and then consider how well a classical computer would perform at the <i>same task</i>.</p>
        <p>Suppose initially we want to use a bosonic system to directly compute the permanent of a matrix. If possible, that would be quite astounding, since it would imply quantum computers can solve #<b>P</b>–complete problems—whereas currently we do not believe they can solve even <b>NP</b>–complete ones. An attempt to leverage the bosonic transition probabilities was made by Troyansky and Tishby in [<span class="ref"><sup class="xref xrefblue">37</sup><span class="refCtt closed"><span>37. L. Troyansky and N. Tishby, in Proceedings of Physics and Computation – PhysComp 96 (New England, 1996).</span></span></span>], where they showed how to encode per<i>A</i> for some <i>n</i>×<i>n</i> matrix <i>A</i> as an expectation value of a bosonic observable. Predictably, however, this did not imply an efficient quantum procedure to compute permanents, since the <i>variance</i> of this observable grows exponentially, implying we would need to repeat the measurement exponentially many times to obtain a reasonable precision in the estimate of per<i>A</i><span class="ref footnote"><sup class="xref">10</sup><span class="refCtt closed"><span class="refCttPadding">
        <strong class="fn-title">10</strong>
        Interestingly, they observed that the variance for the corresponding fermionic observable encoding det⁡A was zero.
      </span></span></span>.</p>
        <p>A similar approach would be to directly compute the permanents via equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E8_1"><span class="sci-ico-fileFormula"></span>8a</a>), by repeating the experiment many times and estimating the corresponding probabilities. This suffers from the same problem, however. Recall, from section <strong>2.1</strong>, that the configuration space for <i>n</i> bosons in <i>m</i> modes is exponentially large. As a consequence, for typical transition matrices <i>U</i>, the probabilities of specific events tend to be exponentially small, again requiring an exponential number of repetitions of the experiment to estimate.</p>
        <p>Can there be a smarter way to use bosons to compute permanents? There is no proof that quantum computers cannot solve #<b>P</b>–complete problems–as I argued previously, there rarely is. But let us move towards a more feasible goal, that of providing evidence of complexity of whichever task a linear-optical experiment performs more naturally. To that end, recall the ingredients of our paradigmatic linear-optical experiment (shown in Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS2_F3"><span class="sci-ico-fileFigure"></span>3</a>): (i) a (bosonic or fermionic) Fock input state of <i>n</i> particles in <i>m</i> modes, |<i>S</i>⟩:=|<i>s</i><sub>1</sub><i>s</i><sub>2</sub>…<i>s</i><sub><i>m</i></sub>⟩, such that ∑<i>s</i><sub><i>i</i></sub> = <i>n</i>; (ii) a linear-optical transformation <i>U</i>, or interferometer, acting according to equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E3"><span class="sci-ico-fileFormula"></span>3</a>); and (iii) a final measurement of the occupation number of the output modes. The output is described by the probabilities:</p>
        <div class="row formula" id="eS4_Ex44">
<a name="S4_Ex44"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mtext>Pr</mtext>
              <mrow>
                <mo stretchy="false">(</mo>
                <mi>S</mi>
                <mo>→</mo>
                <mi>T</mi>
                <mo stretchy="false">)</mo>
              </mrow>
              <mo>=</mo>
              <mfrac>
                <mrow>
                  <mo fence="true">|</mo>
                  <mtext>per</mtext>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>U</mi>
                      <mrow>
                        <mi>S</mi>
                        <mo>,</mo>
                        <mi>T</mi>
                      </mrow>
                    </msub>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <msup>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>2</mn>
                  </msup>
                </mrow>
                <mrow>
                  <msub>
                    <mo largeop="true" symmetric="true">∏</mo>
                    <mi>i</mi>
                  </msub>
                  <mrow>
                    <mrow>
                      <msub>
                        <mi>t</mi>
                        <mi>i</mi>
                      </msub>
                      <mo lspace="0pt" rspace="3.5pt">!</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mrow>
                      <msub>
                        <mo largeop="true" symmetric="true">∏</mo>
                        <mi>j</mi>
                      </msub>
                      <mrow>
                        <msub>
                          <mi>s</mi>
                          <mi>j</mi>
                        </msub>
                        <mo lspace="0pt" rspace="3.5pt">!</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
              </mfrac>
              <mtext>, for bosons,</mtext>
            </mrow>
          </math>
        </div></div>
</div>
        <div class="row formula" id="eS4_Ex45">
<a name="S4_Ex45"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mtext>Pr</mtext>
              <mrow>
                <mo stretchy="false">(</mo>
                <mi>S</mi>
                <mo>→</mo>
                <mi>T</mi>
                <mo stretchy="false">)</mo>
              </mrow>
              <mo>=</mo>
              <mrow>
                <mo fence="true">|</mo>
                <mo movablelimits="false">det</mo>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <msub>
                    <mi>U</mi>
                    <mrow>
                      <mi>S</mi>
                      <mo>,</mo>
                      <mi>T</mi>
                    </mrow>
                  </msub>
                  <mo stretchy="false">)</mo>
                </mrow>
                <mrow>
                  <msup>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>2</mn>
                  </msup>
                  <mtext>, for fermions.</mtext>
                </mrow>
              </mrow>
            </mrow>
          </math>
        </div></div>
</div>
        <p>In both cases <i>U</i><sub><i>S,T</i></sub> is a submatrix of <i>U</i> constructed by the prescription just above equations (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E8_1"><span class="sci-ico-fileFormula"></span>8</a>).</p>
        <p>We now make two simplifying assumptions for the bosonic case. First, we assume the input state is such that <i>s</i><sub><i>i</i></sub>≤1, i.e. we only input one particle in each mode. Second, we also ignore output collision states (when two or more bosons exit in the same mode). In other words we assume <i>t</i><sub><i>j</i></sub>≤1, so the output distribution only has support on <math id="INEQ120"><msubsup><mi>B</mi><mrow><mi>m</mi><mo>,</mo><mi>n</mi></mrow><mo>*</mo></msubsup></math>, as defined in section <strong>2.1</strong>. There are two justifications for this assumption. The first is experimental: often, photonic linear-optical experiments use avalanche photo-detectors [<span class="ref"><sup class="xref xrefblue">38</sup><span class="refCtt closed"><span>38. D.J. Brod, E.F. Galvão, A. Crespi, R. Osellame, N. Spagnolo and F. Sciarrino, Advanced Photonics 1, 034001 (2019).</span></span></span>], which can only distinguish whether photons arrived or not, but not how many. In that case, an experimental run is only accepted if <i>n different</i> detectors click, i.e. for no-collision outputs. Luckily, the second justification is based on the bosonic birthday paradox [<span class="ref"><sup class="xref xrefblue">14</sup><span class="refCtt closed"><span>14. S. Aaronson and A. Arkhipov, Theory of Computing 4, 143 (2013).</span></span></span>, <span class="ref"><sup class="xref xrefblue">39</sup><span class="refCtt closed"><span>39. A. Arkhipov and G. Kuperberg, Geometry &amp; Topology Monographs 18, 1 (2012).</span></span></span>], which states that no-collision states dominate the output distribution, and therefore not many experimental runs will be wasted by ignoring collisions. This only holds if <i>m</i>≫<i>n</i><sup>2</sup> and for typical (uniformly random) unitaries <i>U</i>, but this regime is required for other technical reasons anyway, which we will mention in section <strong>4.3</strong>. Fortunately, in this aspect the theoretical limitation happens to match experimental convenience!</p>
        <p>Having made these assumptions, bosons and fermions now inhabit configurations spaces of the same size, namely <math id="INEQ122"><mrow><mo fence="true" stretchy="false">|</mo><msub><mi>F</mi><mrow><mi>m</mi><mo>,</mo><mi>n</mi></mrow></msub><mrow><mo fence="true" stretchy="false">|</mo><mo>=</mo><mrow><mo fence="true" stretchy="false">|</mo><msubsup><mi>B</mi><mrow><mi>m</mi><mo>,</mo><mi>n</mi></mrow><mo>*</mo></msubsup><mrow><mo fence="true" stretchy="false">|</mo><mo>=</mo><mrow><mo>(</mo><mfrac linethickness="0pt"><mi>m</mi><mi>n</mi></mfrac><mo>)</mo></mrow></mrow></mrow></mrow></mrow></math>. Therefore, we can write the output probability distributions of bosonic (<i>ℬ</i>) and fermionic (<i>ℱ</i>) linear optics, as functions of the interferometer matrix <i>U</i>, as follows</p>
        <div class="row formula" id="eS4_E14_1">
<a name="S4_E14_1"></a><div class="col-md-12"><div class="formula-container">
          <span class="label">(14a)</span>
          <math display="block">
            <mrow>
              <munder accentunder="true">
                <mrow>
                  <mtext>Pr</mtext>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <mi>T</mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </mrow>
                <mo class="ltx_font_mathcaligraphic">ℬ</mo>
              </munder>
              <mo>=</mo>
              <mrow>
                <mo fence="true">|</mo>
                <mtext>per</mtext>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <msub>
                    <mi>U</mi>
                    <mrow>
                      <mi>S</mi>
                      <mo>,</mo>
                      <mi>T</mi>
                    </mrow>
                  </msub>
                  <mo stretchy="false">)</mo>
                </mrow>
                <mrow>
                  <msup>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>2</mn>
                  </msup>
                  <mtext>, for bosons,</mtext>
                </mrow>
              </mrow>
            </mrow>
          </math>
        </div></div>
</div>
        <div class="row formula" id="eS4_E14_2">
<a name="S4_E14_2"></a><div class="col-md-12"><div class="formula-container">
          <span class="label">(14b)</span>
          <math display="block">
            <mrow>
              <munder accentunder="true">
                <mrow>
                  <mtext>Pr</mtext>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <mi>T</mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </mrow>
                <mo class="ltx_font_mathcaligraphic">ℱ</mo>
              </munder>
              <mo>=</mo>
              <mrow>
                <mo fence="true">|</mo>
                <mo movablelimits="false">det</mo>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <msub>
                    <mi>U</mi>
                    <mrow>
                      <mi>S</mi>
                      <mo>,</mo>
                      <mi>T</mi>
                    </mrow>
                  </msub>
                  <mo stretchy="false">)</mo>
                </mrow>
                <mrow>
                  <msup>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>2</mn>
                  </msup>
                  <mtext>, for fermions,</mtext>
                </mrow>
              </mrow>
            </mrow>
          </math>
        </div></div>
</div>
        <p>where, in both cases, we can think of <i>T</i> as running over all bit strings with <i>n</i> ones and <i>m-n</i> zeroes.</p>
        <p>We have made some progress in formulating a concrete computational task: since a fermionic or bosonic system behaves according to <i>ℬ</i> or <i>ℱ</i>, our task is now to simulate either probability distribution (given as input a description of <i>U</i>). However, there are a still a few different things we might mean by <i>simulating a probability distribution</i>.</p>
        <p>The first, known as <i>strong simulation</i>, can be defined as follows:</p>
        <p><b>Definition 5</b> (Strong simulation) <i>Given a probability distribution B or F, as in equations (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS4_E14_1"><span class="sci-ico-fileFormula"></span>14</a>), an efficient strong simulation of it consists of a classical algorithm that computes any probability to poly(<i>m</i>,<i>n</i>) digits of precision in time poly(<i>m</i>,<i>n</i>).</i></p>
        <p>Whenever strong simulation can be done efficiently on a classical computer (as we will see happens for fermionic linear optics), there is no reason not to use this definition. However, it is not a good standard of <i>comparison</i> between the computational power of a quantum and a classical device, because a quantum device in general <i>cannot perform this task efficiently</i>. This is because probabilities are not directly observable, and the best that a quantum device can hope to do is produce a sequence of <i>samples</i> drawn from this distribution.</p>
        <p>We could try to estimate the probability of an event by repeating the experiment many times and building a table of relative frequencies, but that does not achieve sufficiently high precision. To see why, suppose an event happens with probability one in 1000, and we wish to estimate this probability from a list of samples. We expect to need around 1000 samples for the event to happen at least once and for us to be able to ascribe it a nonzero probability. But this estimate would have precision of only 3 digits. In general, taking <i>M</i> samples only provides <i>log</i>⁡<i>M</i> digits of precision. Since the definition of strong simulation requires poly(<i>m</i>,<i>n</i>) digits of precision, this in turn requires repeating the experiment exponentially many times. Therefore, a quantum device cannot efficiently strongly simulate itself.</p>
        <p>This gives rise to the notion of <i>weak</i> classical simulation, defined as follows:</p>
        <p><b>Definition 6</b> (Weak simulation) <i>Given a probability distribution <b>B</b> or <b>F</b>, as in equations (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS4_E14_1"><span class="sci-ico-fileFormula"></span>14</a>), an efficient weak simulation of it consists of a classical algorithm that, in time poly(<i>m</i>,<i>n</i>), produces a sample drawn from this distribution.</i></p>
        <p>More simply, a weak simulation is just a procedure by which the classical computer <i>imitates</i> the behavior of the quantum device, in a sense producing the same amount of information we would get by running the experiment the same number of times. Although it is less common, it is the appropriate standard by which to judge a classical competitor that wants to computationally outperform a quantum device<span class="ref footnote"><sup class="xref">11</sup><span class="refCtt closed"><span class="refCttPadding">
        <strong class="fn-title">11</strong>
        Often, in the definition of strong simulation one is also required to computer conditional probabilities. That is, not only the probabilities over the outcomes, as in equations (14), but also quantities like “the probability of observing a particle on mode 2 given that a particle is known to occupy output mode 1”. This is necessary for the notion of strong simulation to be strictly stronger than that of weak simulation.
      </span></span></span>. And, indeed, there are examples of quantum systems for which efficient weak simulation is possible but efficient strong simulation is considered unlikely [<span class="ref"><sup class="xref xrefblue">40</sup><span class="refCtt closed"><span>40. M. Van den Nest, Quant. Inf. Comp. 11, 784 (2011).</span></span></span>, <span class="ref"><sup class="xref xrefblue">41</sup><span class="refCtt closed"><span>41. R. Jozsa and M. Van den Nest, Quant. Inf. Comp. 14, 633 (2014).</span></span></span>]. The two types of simulation are represented in Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS4_F8"><span class="sci-ico-fileFigure"></span>8</a>.</p>
        <div class="row fig" id="S4_F8">
<a name="S4_F8"></a><div class="col-md-4 col-sm-4"><a href="" data-toggle="modal" data-target="#ModalFigS4_F8"><div class="thumbImg">
<img src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/9cf7059db276e5b15620f006cfb066edb4588fa0.jpg"><div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8 col-sm-8">
<strong>Figure 8</strong><br>
            Two notions of classical simulation. (a) A quantum experiment within the setup of Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS2_F3"><span class="sci-ico-fileFigure"></span>3</a> is completely defined by its interferometer matrix <i>U</i>. (b) A strong classical simulator takes as input <i>U</i> and outputs the value of any outcome probability. (c) A weak classical simulator takes as input <i>U</i> and outputs samples from the corresponding distribution.
          <br>
</div>
</div>
        <p>We can now finally define the precise computational task solved by a linear-optical experiment:</p>
        <p>
          <b>Problem 4.</b>
          <i>Given as input an efficient description of the linear-optical transformation <i>U</i>, acting on a state of <i>n</i> bosons, the task of (exact) BosonSampling is to weakly simulate the distribution <b>B</b> given in equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS4_E14_1"><span class="sci-ico-fileFormula"></span>14a</a>), in time poly(<i>m</i>,<i>n</i>). The fermionic analogue, FermionSampling, is defined equivalently in terms of the distribution <b>F</b> from equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS4_E14_2"><span class="sci-ico-fileFormula"></span>14b</a>).</i>
        </p>
        <p>One can make the job of the classical competitor even easier by noticing that a real-world quantum device cannot even provide an <i>exact</i> weak simulation of itself, due to experimental noise. Therefore, we could define notions of <i>approximate</i> weak simulation, where the algorithm is only required to produce samples from a distribution suitably close to the ideal one. I will not use this notion of simulation in detail here, since it is drastically harder to prove meaningful results in this more realistic setting. However, it is the standard used by the field of quantum computational advantage, which we return to in section <strong>4.3</strong>.</p>
      
      
        <h2>4.2. FermionSampling</h2>
        <p>Let us begin with the easiest case, that of FermionSampling. Equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS4_E14_2"><span class="sci-ico-fileFormula"></span>14b</a>) states that transition probabilities in <b>ℱ</b> are proportional to determinants of sub-matrices of <i>U</i>. As we argued in section <strong>3.3</strong>, the determinant can be computed efficiently by a classical computer (it is in <b>P</b>). Therefore, it immediately follows that strong simulation of fermionic linear optics is in <b>P</b> as well.</p>
        <p>What about weak simulation? We can efficiently compute the probability of <i>any</i> outcome, but not of <i>all</i> outcomes, since <i>F</i><sub><i>m,n</i></sub> has exponentially many states. In order to sample from the distribution <b>ℱ</b>, we need to be able to compute conditional or marginal probabilities. Then we can, for example, simulate the outcome of the first detector, then simulate the outcome of the second detector <i>conditioned</i> on the outcome obtained for the first, and so on. By definition this will result in a sample that was obtained according to <b>ℱ</b>. I will not go into the details of how this is done, as it is not particularly illuminating. It requires invoking Wick’s theorem and the Pfaffian (a matrix function related to the determinant), as shown in [<span class="ref"><sup class="xref xrefblue">15</sup><span class="refCtt closed"><span>15. B.M. Terhal and D.P. DiVincenzo, Phys. Rev. A 65, 032325 (2002).</span></span></span>]. This implies that weak classical simulation of FermionSampling is also easy.</p>
        <p>This argument suggests that fermionic linear optics does not display the high level of complexity usually associated with quantum computers. That is not a bug, but a feature, since we can <i>leverage</i> the classical simulability of fermions to simulate efficiently other interesting quantum systems. One way to do this is to use the Jordan-Wigner transformation [<span class="ref"><sup class="xref xrefblue">42</sup><span class="refCtt closed"><span>42. P. Jordan and E. Wigner, Z. Phys. 47, 631 (1928).</span></span></span>], which maps quadratic fermionic Hamiltonians into Hamiltonians of spin-1/2 particles.</p>
        <p>The Jordan-Wigner transformation maps an <i>m</i>-mode fermionic system into a 1D chain of <i>m</i> spins, such that the |0⟩ and |1⟩ states of mode <i>i</i> are identified with the |↑⟩ and |↓⟩ states of the <i>i</i>th spin. Then, it establishes the following correspondence between fermionic and spin operators:</p>
        <div class="row formula" id="eS4_Ex46">
<a name="S4_Ex46"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <msubsup>
                  <mi>f</mi>
                  <mi>j</mi>
                  <mo>†</mo>
                </msubsup>
                <mo>=</mo>
                <mrow>
                  <munder>
                    <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
                    <mrow>
                      <mi>k</mi>
                      <mo>&lt;</mo>
                      <mi>j</mi>
                    </mrow>
                  </munder>
                  <mrow>
                    <mrow>
                      <msub>
                        <mi>Z</mi>
                        <mi>k</mi>
                      </msub>
                      <mo>⁢</mo>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mrow>
                          <msub>
                            <mi>X</mi>
                            <mi>j</mi>
                          </msub>
                          <mo>+</mo>
                          <mrow>
                            <mpadded width="+0.6pt">
                              <mi mathvariant="normal">i</mi>
                            </mpadded>
                            <mo>⁢</mo>
                            <msub>
                              <mi>Y</mi>
                              <mi>j</mi>
                            </msub>
                          </mrow>
                        </mrow>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </mrow>
                    <mo>/</mo>
                    <mn>2</mn>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <div class="row formula" id="eS4_Ex47">
<a name="S4_Ex47"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <msub>
                  <mi>f</mi>
                  <mi>j</mi>
                </msub>
                <mo>=</mo>
                <mrow>
                  <munder>
                    <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
                    <mrow>
                      <mi>k</mi>
                      <mo>&lt;</mo>
                      <mi>j</mi>
                    </mrow>
                  </munder>
                  <mrow>
                    <mrow>
                      <msub>
                        <mi>Z</mi>
                        <mi>k</mi>
                      </msub>
                      <mo>⁢</mo>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mrow>
                          <msub>
                            <mi>X</mi>
                            <mi>j</mi>
                          </msub>
                          <mo>-</mo>
                          <mrow>
                            <mpadded width="+0.6pt">
                              <mi mathvariant="normal">i</mi>
                            </mpadded>
                            <mo>⁢</mo>
                            <msub>
                              <mi>Y</mi>
                              <mi>j</mi>
                            </msub>
                          </mrow>
                        </mrow>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </mrow>
                    <mo>/</mo>
                    <mn>2</mn>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>where <i>X</i><sub><i>j</i></sub>, <i>Y</i><sub><i>j</i></sub> and <i>Z</i><sub><i>j</i></sub> are the conventional Pauli operators acting on spin <i>j</i> (with identity implied on the remaining spins). It is easy to check that, if the particle operators satisfy the proper anti-commutation relations, then the spin operators satisfy the correct algebra for Pauli matrices. This mapping seems very nonlocal at first sight, but it actually maps quadratic operators acting on nearest-neighbor modes into operators on nearest-neighbor spins. For example,</p>
        <div class="row formula" id="eS4_Ex48">
<a name="S4_Ex48"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mo>-</mo>
                  <mrow>
                    <mrow>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mrow>
                          <msub>
                            <mi>X</mi>
                            <mn>3</mn>
                          </msub>
                          <mo>+</mo>
                          <mrow>
                            <mpadded width="+0.6pt">
                              <mi mathvariant="normal">i</mi>
                            </mpadded>
                            <mo>⁢</mo>
                            <msub>
                              <mi>Y</mi>
                              <mn>3</mn>
                            </msub>
                          </mrow>
                        </mrow>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mrow>
                          <msub>
                            <mi>X</mi>
                            <mn>4</mn>
                          </msub>
                          <mo>-</mo>
                          <mrow>
                            <mpadded width="+0.6pt">
                              <mi mathvariant="normal">i</mi>
                            </mpadded>
                            <mo>⁢</mo>
                            <msub>
                              <mi>Y</mi>
                              <mn>4</mn>
                            </msub>
                          </mrow>
                        </mrow>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </mrow>
                    <mo>/</mo>
                    <mn>4</mn>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msubsup>
                    <mi>f</mi>
                    <mn>3</mn>
                    <mo>†</mo>
                  </msubsup>
                  <mo>⁢</mo>
                  <msub>
                    <mi>f</mi>
                    <mn>4</mn>
                  </msub>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>Note how all the extra <i>Z</i><sub><i>i</i></sub> operators for <i>i</i> &lt; 3 cancel since <i>Z</i><sup>2</sup> = <i>I</i>.</p>
        <p>Now recall, from equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E4"><span class="sci-ico-fileFormula"></span>4</a>), that quadratic fermionic Hamiltonians are precisely the generators of fermionic linear optics. If we work out all possibilities for (nearest-neighbor) quadratic operators, we will see that the corresponding spin Hamiltonians are those spanned by the following set:</p>
        <div class="row formula" id="eS4_Ex49">
<a name="S4_Ex49"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mi class="ltx_font_mathcaligraphic">ℳ</mi>
              <mo>=</mo>
              <mrow>
                <mo stretchy="false">{</mo>
                <msub>
                  <mi>X</mi>
                  <mi>i</mi>
                </msub>
                <msub>
                  <mi>Y</mi>
                  <mrow>
                    <mi>i</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
                <mo>,</mo>
                <msub>
                  <mi>Y</mi>
                  <mi>i</mi>
                </msub>
                <msub>
                  <mi>Y</mi>
                  <mrow>
                    <mi>i</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
                <mo>,</mo>
                <msub>
                  <mi>X</mi>
                  <mi>i</mi>
                </msub>
                <msub>
                  <mi>X</mi>
                  <mrow>
                    <mi>i</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
                <mo>,</mo>
              </mrow>
            </mrow>
            <mrow>
              <mtext> </mtext>
              <msub>
                <mi>Y</mi>
                <mi>i</mi>
              </msub>
              <msub>
                <mi>X</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>+</mo>
                  <mn>1</mn>
                </mrow>
              </msub>
              <mo>,</mo>
              <msub>
                <mi>Z</mi>
                <mi>i</mi>
              </msub>
              <mo>,</mo>
              <msub>
                <mi>Z</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>+</mo>
                  <mn>1</mn>
                </mrow>
              </msub>
              <mo stretchy="false">}</mo>
              <msub>
                <mi></mi>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mrow>
                    <mrow>
                      <mn>1</mn>
                      <mo>⁢</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>⁢</mo>
                      <mi>m</mi>
                    </mrow>
                    <mo>-</mo>
                    <mn>1</mn>
                  </mrow>
                </mrow>
              </msub>
              <mo>.</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>The classical simulability of free fermions then directly implies the simulability of any one-dimensional condensed matter system with a Hamiltonian spanned by elements of <b>ℳ</b>, which include, e.g., the Ising and the <i>XY</i> (or anisotropic Heisenberg) interactions.</p>
        <p>Beyond condensed matter applications, unitaries generated by Hamiltonians from <b>ℳ</b> have appeared in the quantum computing literature as <i>matchgate circuits</i> [<span class="ref"><sup class="xref xrefblue">16</sup><span class="refCtt closed"><span>16. L.G. Valiant, SIAM J. Comput. 31, 1229 (2002).</span></span></span>, <span class="ref"><sup class="xref xrefblue">43</sup><span class="refCtt closed"><span>43. R. Jozsa and A. Miyake, Proc. R. Soc. A 464, 3089 (2008).</span></span></span>]. The fact that they are classically simulable has served as a testbed to investigate particular aspects of large restricted quantum computers that would be prohibitive in general. While an arbitrary quantum computer cannot be classically simulated beyond a few dozen particles (a point we will return to in section <strong>4.3</strong>), a computer composed only of matchgates can be simulated up to thousands of qubits. This has been used e.g. to investigate error propagation and benchmark error correcting codes [<span class="ref"><sup class="xref xrefblue">44</sup><span class="refCtt closed"><span>44. S. Bravyi, M. Englbrecht, R. König and N. Peard, npj Quantum Information 4, 1 (2018).</span></span></span>, <span class="ref"><sup class="xref xrefblue">45</sup><span class="refCtt closed"><span>45. Y. Suzuki, K. Fujii and M. Koashi, Phys. Rev. Lett. 119, 190503 (2017).</span></span></span>], or as toy models for holographic duality [<span class="ref"><sup class="xref xrefblue">46</sup><span class="refCtt closed"><span>46. A. Jahn, M. Gluza, F. Pastawski and J. Eisert, Science Advances 5, eaaw0092 (2019).</span></span></span>].</p>
      
      
        <h2>4.3. BosonSampling</h2>
        <p>We now move to the bosonic case where, as we should already expect, the situation is drastically different from that of fermions. The task of BosonSampling was first considered formally (and named) in a seminal paper by Aaronson and Arkhipov [<span class="ref"><sup class="xref xrefblue">14</sup><span class="refCtt closed"><span>14. S. Aaronson and A. Arkhipov, Theory of Computing 4, 143 (2013).</span></span></span>] which is arguably the starting point of the field of quantum computational advantage (or supremacy). In this section, I outline the proof of their simpler result, which provides evidence that the <i>exact</i> version of BosonSampling is hard for classical computers. I also briefly touch on some aspects of their more experimentally-friendly proof that <i>approximate</i> BosonSampling is also expected to be hard<span class="ref footnote"><sup class="xref">12</sup><span class="refCtt closed"><span class="refCttPadding">
        <strong class="fn-title">12</strong>
        The whole argument spans over 80 pages and is much too technical for the scope of this paper.
      </span></span></span>. I leave a more general discussion on the concept of quantum advantage for the next section.</p>
        <p>In previous sections, we identified that transition amplitudes for bosonic linear-optical devices are given by matrix permanents. We also saw how permanents are expected to be extremely hard functions to compute (they are #<b>P</b>–complete, and so outside of the polynomial hierarchy). This already implies that strong simulation of these devices is a #<b>P</b>–complete task. However, this is not enough to attest that the quantum device is performing a computationally hard task, since it cannot strongly simulate itself either. Therefore it might be possible, in principle, to have an efficient classical algorithm that weakly simulates this device. In order to provide evidence that this is not possible, we need some more sophisticated tools.</p>
        <p>The central ingredient we need is a classic result due to Stockmeyer [<span class="ref"><sup class="xref xrefblue">47</sup><span class="refCtt closed"><span>47. L. Stockmeyer, in Proceedings of the Fifteenth Annual ACM Symposium on Theory of Computing (New York, 1983).</span></span></span>]. Below I paraphrase it and use a version adapted for our purposes.</p>
        <p><b>Theorem 2.</b><i>[Stockmeyer [<span class="ref"><sup class="xref xrefblue">47</sup><span class="refCtt closed"><span>47. L. Stockmeyer, in Proceedings of the Fifteenth Annual ACM Symposium on Theory of Computing (New York, 1983).</span></span></span>]] Let <i>D</i> = {<i>p</i><sub><i>x</i></sub>}<sub><i>x</i></sub> be a probability distribution over <i>x</i> ∈ {0, 1}<sup><i>n</i></sup>. Suppose there is an efficient randomized classical algorithm that produces a sample drawn from <i>D</i>. Let <math id="INEQ153"><mrow><mi>g</mi><mo mathvariant="normal">≥</mo><mrow><mn mathvariant="normal">1</mn><mo mathvariant="normal">+</mo><mfrac><mn mathvariant="normal">1</mn><mrow><mrow><mtext mathvariant="italic">poly</mtext><mtext mathsize="142%" mathvariant="italic"></mtext></mrow><mo mathvariant="italic">⁢</mo><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>n</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></mrow></mfrac></mrow></mrow></math>. Then there exists an efficient randomized classical algorithm which, upon receiving <i>x</i> ∈ {0,1}<sup><i>n</i></sup>, and</i> when given access to a machine capable of solving problems within the second level of <i><b>PH</b>, approximates <i>p</i><sub><i>x</i></sub> to multiplicative precision. In other words, outputs <i>q</i><sub><i>x</i></sub> such that</i></p>
        <div class="row formula" id="eS4_E15">
<a name="S4_E15"></a><div class="col-md-12"><div class="formula-container">
          <span class="label">(15)</span>
          <math display="block">
            <mrow>
              <mrow>
                <mfrac>
                  <msub>
                    <mi>p</mi>
                    <mi>x</mi>
                  </msub>
                  <mi>g</mi>
                </mfrac>
                <mo>≤</mo>
                <msub>
                  <mi>q</mi>
                  <mi>x</mi>
                </msub>
                <mo>≤</mo>
                <mrow>
                  <msub>
                    <mi>p</mi>
                    <mi>x</mi>
                  </msub>
                  <mo>⁢</mo>
                  <mi>g</mi>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>This is a powerful theorem because, in general, the task of computing <i>p</i><sub><i>x</i></sub> <i>exactly</i> can be #<b>P</b>–complete. Let us illustrate that with an example. Consider again problem 3, i.e. the problem of finding a perfect matching between the two sets of students. Let <i>M</i> be the set of all possible ways to pair the students, regardless of their preferences. Some of these will be valid perfect matchings (where no student is paired with another they despise), others will not. Consider now the probability distribution <b>𝒫ℳ</b> = {<i>p</i>,1−<i>p</i>}, where <i>p</i> is the probability that, by choosing a pairing of the students uniformly at random, we happen to find a valid one. To produce a sample of this distribution on a classical computer is a very simple task: we just choose a pairing at random, and check whether it is valid, which can be done efficiently. However, the value of <i>p</i> corresponds to the fraction of all pairings that are valid, and so <i>computing p</i> is equivalent to counting the number of perfect matchings, which is #<b>P</b>–complete.</p>
        <p>What Stockmeyer’s theorem then shows is that some #<b>P</b>–complete problems, if we allow a modest amount of error, can be solved <i>approximately</i> within very low levels of the polynomial hierarchy. An alternative formulation [<span class="ref"><sup class="xref xrefblue">14</sup><span class="refCtt closed"><span>14. S. Aaronson and A. Arkhipov, Theory of Computing 4, 143 (2013).</span></span></span>] makes it more transparent that the #<b>P</b> problems amenable to this approximation are those equivalent to estimating the sum of exponentially many <i>nonnegative</i> real numbers. One such example is counting the number of perfect matchings, as described above, or equivalently computing the permanent of a (0,1) matrix.</p>
        <p>It is important to emphasize that theorem 2 does <i>not</i> mean that these #<b>P</b> quantities can be approximated efficiently on a classical computer (though some of them can), only that this can be done within <b>PH</b>, but at a level above <b>NP</b>. Why do we care that approximating these quantities has been moved from the extremely-hard class #<b>P</b> into the still-extremely-hard <b>PH</b>? As we will see, the relations between these unrealistic classes can produce relevant claims for more realistic ones, like <b>P</b>.</p>
        <p>The observant reader might expect that, since we just demoted approximating some permanents to a lower complexity class, this suggests BosonSampling might not be that hard either. However, that is not so. The permanents amenable to Stockmeyer’s theorem are those of matrices with nonnegative entries. In fact, they are even easier to compute than theorem 2 suggests, since it was shown by Jerrum, Sinclair and Vigoda that they can be approximated efficiently on a classical computer. Luckily for bosons, the matrices that describe their transition probabilities [cf. equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS4_E14_1"><span class="sci-ico-fileFormula"></span>14a</a>)], have complex-valued coefficients. And those permanents remain #<b>P</b>–complete even to approximate, in the multiplicative sense of equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS4_E15"><span class="sci-ico-fileFormula"></span>15</a>), as shown in [<span class="ref"><sup class="xref xrefblue">14</sup><span class="refCtt closed"><span>14. S. Aaronson and A. Arkhipov, Theory of Computing 4, 143 (2013).</span></span></span>].</p>
        <p>We now have all the ingredients to describe the seminal result for (exact) BosonSampling.</p>
        <p>
          <b>Theorem 3.</b>
          <i>[Hardness of exact BosonSampling [<span class="ref"><sup class="xref xrefblue">14</sup><span class="refCtt closed"><span>14. S. Aaronson and A. Arkhipov, Theory of Computing 4, 143 (2013).</span></span></span>]] The exact BosonSampling problem is not efficiently solvable by a classical computer, unless <b>P</b><sup># &lt; <i>cps</i>:<i>bf</i> &gt; <i>P</i> &lt; /<i>cps</i>:<i>bf</i> &gt;</sup> = <b>BPP</b><sup><b>NP</b></sup>, in which case the polynomial hierarchy collapses to its third level.</i>
        </p>
        <p>The proof of this result can be outlined as follows<span class="ref footnote"><sup class="xref">13</sup><span class="refCtt closed"><span class="refCttPadding">
        <strong class="fn-title">13</strong>
        Readers familiar with quantum computing might be interested in an alternative version of this argument, based on post-selection and the Knill-Laflamme-Milburn protocol for universal quantum computing with linear optics, see [14, 48].
      </span></span></span>.</p>
        <ol type="1">
<li>
            (i)
            <p>First, it was shown that approximating (per <i>X</i>)<sup>2</sup> to within multiplicative error, for an arbitrary real <i>n</i>×<i>n</i> matrix <i>X</i>, is #<b>P</b>–complete.</p>
          </li>
<li>
            (ii)
            <p>Then, it was shown that it is always possible to find a 2<i>n</i>×2<i>n</i> unitary matrix <i>U</i> that contains <i>ϵX</i> as its top left submatrix (where ϵ is a rescaling factor).</p>
          </li>
<li>
            (iii)
            <p>Now use the matrix <i>U</i> from step (ii) as the interferometer in a linear-optical experiment, and use as input the state where the <i>n</i> photons each occupy one of the first <i>n</i> modes. From equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_E8_1"><span class="sci-ico-fileFormula"></span>8a</a>), the transition probability to the <i>same</i> output state is proportional to (per <i>X</i>)<sup>2</sup>.</p>
          </li>
<li>
            (iv)
            <p>Suppose that there is a classical algorithm that weakly simulates BosonSampling, i.e. that produces a sample from the output distribution predicted for the linear-optical experiment.</p>
          </li>
<li>
            (v)
            <p>By Stockmeyer’s theorem, the existence of the classical algorithm of point (iv) implies that it is possible to compute the transition probability, and hence (per <i>X</i>)<sup>2</sup>, within the third level of the polynomial hierarchy<span class="ref footnote"><sup class="xref">14</sup><span class="refCtt closed"><span class="refCttPadding">
        <strong class="fn-title">14</strong>
        For technical reasons, while Stockmeyer’s algorithm mentions the second level of the hierarchy, the final conclusion refers to its third level. This comes from the fact that we need to compare problems in PH to P#P. This does not change the final conclusion too much.
      </span></span></span>.</p>
          </li>
<li>
            (vi)
            <p>Combining steps (i) and (v), we have concluded that a #<b>P</b>–complete quantity can be computed within the third level of <b>PH</b>. By the discussion of section <strong>3.2</strong>, in particular using Toda’s theorem, we conclude that <b>PH</b> collapses to its third level.</p>
          </li>
</ol>
        <p>This proof outline uses all the ingredients we described up until now, and can be quite dense, so feel free to read it again carefully. In essence it proves that, though linear-optical devices cannot themselves compute #<b>P</b>–complete quantities, the fact that their transition amplitudes are #<b>P</b>–complete implies that they are performing in fact a quite complex task. Since the collapse of <b>PH</b> is considered unlikely, this is regarded as evidence that it is hard for a classical computer to simulate a BosonSampling experiment. As promised, we used the relations between the up-in-the-sky complexity classes to produce a concrete claim about the power of real-world devices, namely classical computers, on one hand, and very rudimentary bosonic computers on the other.</p>
        <p>The contribution of Aaronson and Arkhipov goes much beyond theorem 3. The main limitation of this theorem is that it only considers the task of <i>exact</i> sampling, which a realistic linear-optical device cannot perform either. It can be trivially extended to allow the bosonic and the classical computers to incur some multiplicative errors, as in equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS4_E15"><span class="sci-ico-fileFormula"></span>15</a>). However, since the transition probabilities can be exponentially small, a multiplicative approximation implies an exponentially small error, which is still beyond the capabilities of a realistic device.</p>
        <p>A more realistic notion of approximation is to consider an error in <i>total variation distance</i>. In this case we are satisfied if the weak classical simulator produces samples from some distribution ℬ′ = {<i>q</i><sub><i>x</i></sub>}<sup><i>x</i></sup> such that</p>
        <div class="row formula" id="eS4_Ex51">
<a name="S4_Ex51"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mo>∥</mo>
                  <mrow>
                    <msup>
                      <mi class="ltx_font_mathcaligraphic">ℬ</mi>
                      <mo>′</mo>
                    </msup>
                    <mo>-</mo>
                    <mi class="ltx_font_mathcaligraphic">ℬ</mi>
                  </mrow>
                  <mo>∥</mo>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mfrac>
                    <mn>1</mn>
                    <mn>2</mn>
                  </mfrac>
                  <mo>⁢</mo>
                  <mrow>
                    <munder>
                      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                      <mi>x</mi>
                    </munder>
                    <mrow>
                      <mo stretchy="false">|</mo>
                      <mrow>
                        <msub>
                          <mi>p</mi>
                          <mi>x</mi>
                        </msub>
                        <mo>-</mo>
                        <msub>
                          <mi>q</mi>
                          <mi>x</mi>
                        </msub>
                      </mrow>
                      <mo stretchy="false">|</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>&lt;</mo>
                <mi>ϵ</mi>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>where ℬ = {<i>p</i><sub><i>x</i></sub>}<sup><i>x</i></sup> is the ideal BosonSampling distribution, and <i>ϵ</i> &gt; 0 is a small error parameter. Unfortunately, the proof of theorem 3 is not strong enough to provide hardness that is robust in this sense. The reason is that it relies on the #<b>P</b>–completeness of one <i>particular</i> probability (which we chose to be the transition between |1,…,1,0,…,0⟩ and itself). Suppose now that we have a classical simulator that decides to cheat by declaring that this particular event has zero probability, while estimating the probabilities of all other outcomes very well. This simulator would produce a distribution that is not multiplicatively close to <b>ℬ</b>, but that might be close in total variation distance.</p>
        <p>In order to circumvent this issue, Aaronson and Arkhipov replace the matrix <i>U</i> [obtained by embedding the #<b>P</b>–hard matrix <i>X</i> in step (ii) of the proof], with a uniform (i.e. Haar-random) matrix. They showed that, if the number of modes <i>m</i> is sufficiently larger than the number of photons <i>n</i>, all <i>n</i>×<i>n</i> sub-matrices of <i>U</i> look “identical”, in the sense that they look like matrices of elements drawn independently from a complex Gaussian distribution. This serves as a protection against the cheating classical simulator described in the previous paragraph. Since all sub-matrices look very similar, the classical simulator cannot tell which of them to corrupt. Therefore, in order for it to produce a distribution close to <b>ℬ</b>, it has to get most of the probabilities right, and so it is likely to approximate the one we care about very well.</p>
        <p>The downside of this more experimentally-friendly version of the argument is that it requires considering the complexity of permanents of <i>random</i> matrices, rather than just worst-case matrices, which requires a daunting amount of technical details and two additional conjectures beyond what we describe here.</p>
        <p>To finish this Section, I need to address an issue I have been neglecting until now, namely the fact that classical (distinguishable) particles also evolve according to permanents, as in equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS2_Ex35"><span class="sci-ico-fileFormula"></span>2.2.2</a>). Does this mean that weak simulation of classical particles is also hard for a classical computer? Of course not. The transition probabilities for distinguishable particles are given by permanents of nonnegative elements, and these are in fact easy to approximate, as we discussed just before theorem 3. It is also trivial to perform a weak simulation in this case. To that end, we simply label the <i>n</i> particles, simulate them passing through the interferometer <i>one at a time</i> and reaching the output, and then erase their labels. This will produce a sample from the correct distribution with only a polynomial amount of effort.</p>
      
      
        <h2>4.4. Quantum computational advantage</h2>
        <p>We have seen that bosonic linear optics, in contrast to its fermionic counterpart, cannot be simulated efficiently on a classical computer (unless <b>PH</b> collapses). This is unfortunate if our main interest is to in fact simulate these systems, for example to guide the design of a future experiment or check whether our experimental apparatus is working properly. However, the upside is that this suggests a very simple experiment to test quantum mechanics in the limit of <i>high computational complexity</i>. This is the concept of “quantum computational advantage”, or “quantum computational supremacy”.</p>
        <p>The idea for a universal quantum computer, i.e. one capable of displaying the entire power of quantum computation, has been known in the literature for a few decades [<span class="ref"><sup class="xref xrefblue">49</sup><span class="refCtt closed"><span>49. D. Deutsch, Proc. R. Soc. Lond. A. 400, 97 (1985).</span></span></span>]. However, actually building one has so far proven to be a daunting technological task. It requires very precise control of individual quantum systems, and furthermore of a very large number of them. To illustrate, consider the problem of factoring integers. So far, the record for largest integer factored by a classical computer is a 240-digit number [<span class="ref"><sup class="xref xrefblue">50</sup><span class="refCtt closed"><span>50. F. Boudot, P. Gaudry, A. Guillevic, N. Heninger, E. Thomé and P. Zimmermann, in Proceedings of the 40th Annual International Cryptology Conference (Santa Barbara, 2020).</span></span></span>], while the largest integer factored by a quantum computer is 21 [<span class="ref"><sup class="xref xrefblue">51</sup><span class="refCtt closed"><span>51. E. Martín-López, A. Laing, T. Lawson, R. Alvarez, X.-Q. Zhou and J.L.O’Brien, Nature Photonics 6, 773 (2012).</span></span></span>]. An implementation of Shor’s algorithm that would actually compete with current classical computers would require a quantum computer with millions of qubits [<span class="ref"><sup class="xref xrefblue">52</sup><span class="refCtt closed"><span>52. C. Gidney and M. Ekerå, arXiv:1905.09749 (2019).</span></span></span>], whereas the largest quantum computer ran to date, as far as I know, has 54 qubits [<span class="ref"><sup class="xref xrefblue">9</sup><span class="refCtt closed"><span>9. F. Arute, K. Arya, R. Babbush, D. Bacon, J.C. Bardin, R. Barends, R. Biswas, S.Boixo, F.G.S.L. Brandao, D.A. Buell, et al., Nature 574, 505 (2019).</span></span></span>].</p>
        <p>By the laws of quantum mechanics, quantum computers should be “simply” a technological challenge. However, there are skeptics which claim that the noise present in real-world systems makes quantum computers fundamentally impossible [<span class="ref"><sup class="xref xrefblue">10</sup><span class="refCtt closed"><span>10. G. Kalai, arXiv:0904.3265 (2009).</span></span></span>, <span class="ref"><sup class="xref xrefblue">11</sup><span class="refCtt closed"><span>11. G. Kalai, arXiv:1106.0485 (2011).</span></span></span>, <span class="ref"><sup class="xref xrefblue">53</sup><span class="refCtt closed"><span>53. G. Kalai and G. Kindler, arXiv:1409.3093 (2014).</span></span></span>]. The field of quantum computational advantage arose, in some sense, in response to these claims. It concerns the question of what is the simplest and smallest quantum device that we can build and control that solves some well-defined computational task faster than the best known classical computer. This task does not need to be particularly <i>useful</i>, except as a demonstration of computational strength. The hope then is that, by optimizing for raw computational complexity rather than usefulness, we might be able to give experimental evidence that quantum computers outperform their classical counterparts using substantially fewer than a million qubits.</p>
        <p>The Aaronson-Arkhipov paper on BosonSampling is arguably the first full-fledged proposal of quantum computational advantage. It was not the first paper to propose that rudimentary quantum computers may have computational powers beyond classical computers [<span class="ref"><sup class="xref xrefblue">54</sup><span class="refCtt closed"><span>54. B.M. Terhal and D.P. DiVincenzo, Quant. Inf. Comp. 4, 134 (2004).</span></span></span>, <span class="ref"><sup class="xref xrefblue">55</sup><span class="refCtt closed"><span>55. M.J. Bremner, R. Jozsa and D.J. Shepherd, Proc. R. Soc. A 467, 459(2011).</span></span></span>], but it was done for a very simple and appealing quantum system (namely linear optics) and with the aim of making the argument more relevant for realistic devices.</p>
        <p>How many photons would be needed for a demonstration of quantum computational advantage? Recall that, as far as we know, an <i>n</i>-photon BosonSampling experiment, in order to be simulated, requires computing permanents of <i>n</i>×<i>n</i> matrices. A typical laptop computer struggles with computing permanents for <i>n</i> much above 30. This suggests than a linear-optical experiment with a few dozen photons in a few hundred modes would already be performing a task (namely, sampling from the BosonSampling distribution) that would pose a serious challenge for a classical competitor. Improved classical algorithms and analyses have revised this number up to something like 90 photons [<span class="ref"><sup class="xref xrefblue">56</sup><span class="refCtt closed"><span>56. A.M. Dalzell, A.W. Harrow, D.E. Koh and R.L. La Placa, Quantum 4, 264 (2020).</span></span></span>]. Such an experiment is still a challenge for present-day technology, but is definitely more feasible than using millions of qubits to factor a large number!</p>
        <p>Since the original BosonSampling paper many different candidates of quantum advantage have been proposed. A particularly notable one is the random circuit sampling (RCS) model [<span class="ref"><sup class="xref xrefblue">9</sup><span class="refCtt closed"><span>9. F. Arute, K. Arya, R. Babbush, D. Bacon, J.C. Bardin, R. Barends, R. Biswas, S.Boixo, F.G.S.L. Brandao, D.A. Buell, et al., Nature 574, 505 (2019).</span></span></span>, <span class="ref"><sup class="xref xrefblue">57</sup><span class="refCtt closed"><span>57. S. Aaronson and L. Chen, in Proceedings of the 32nd Computational Complexity Conference (Schloss Dagstuhl – Leibniz-Zentrum fuer Informatik, Dagstuhl, 2017).</span></span></span>]. In the RCS model the hardware is in principle capable of universal quantum computing<span class="ref footnote"><sup class="xref">15</sup><span class="refCtt closed"><span class="refCttPadding">
        <strong class="fn-title">15</strong>
        I should point out that linear optics is also universal for quantum computing. It requires resources beyond BosonSampling, such as the ability to perform projective measurements and change the subsequent circuit depending on the outcome [58]. A natural qubit present in these systems is the polarization of a single photon, though any two modes that a photon may occupy can be used to encode a qubit. This technological platform is also currently being pursued as a viable candidate for quantum computing [59, 60].
      </span></span></span>, but it is only run for a small number of computation cycles. The idea is that the small number of cycles allows for sufficiently high complexity whilst maintaining the experimental errors under control. This idea has already borne fruit. In 2019 a research group used a quantum computer made of 53 qubits to run an instance of the RCS model with a runtime of 200 seconds, performing a task which a current classical supercomputer is expected to take orders of magnitude longer<span class="ref footnote"><sup class="xref">16</sup><span class="refCtt closed"><span class="refCttPadding">
        <strong class="fn-title">16</strong>
        The authors claim that a classical supercomputer would take ten thousand years to simulate this experiment. This has been challenged in the literature, with claims that an optimized classical algorithm would take in fact only a few days instead [61]. Some debate remains whether the latter algorithm is a fair comparison, as it requires such massive amount of data storage that it would not work if the experiment had been a bit larger. In any case, if the best classical supercomputer takes a few days to do what the quantum device did in a few seconds, I would argue that a quantum computational advantage is hard to dismiss.
      </span></span></span> [<span class="ref"><sup class="xref xrefblue">9</sup><span class="refCtt closed"><span>9. F. Arute, K. Arya, R. Babbush, D. Bacon, J.C. Bardin, R. Barends, R. Biswas, S.Boixo, F.G.S.L. Brandao, D.A. Buell, et al., Nature 574, 505 (2019).</span></span></span>].</p>
        <p>On the BosonSampling front, experiments have also been steadily increasing in complexity, ranging from 3–4 photons soon after the original proposal [<span class="ref"><sup class="xref xrefblue">62</sup><span class="refCtt closed"><span>62. M.A. Broome, A. Fedrizzi, S. Rahimi-Keshari, J. Dove, S. Aaronson, T.C. Ralph and A.G. White, Science 339, 794 (2013).</span></span></span>, <span class="ref"><sup class="xref xrefblue">63</sup><span class="refCtt closed"><span>63. J.B. Spring, B.J. Metcalf, P.C. Humphreys, W.S. Kolthammer, X.-M. Jin, M. Barbieri, A. Datta, N. Thomas-Peter, N.K. Langford, D. Kundys, et al., Science 339, 798 (2013).</span></span></span>, <span class="ref"><sup class="xref xrefblue">64</sup><span class="refCtt closed"><span>64. M. Tillmann, B. Dakić, R. Heilmann, S. Nolte, A. Szameit and P. Walther, Nat.Photon. 7, 540 (2013).</span></span></span>, <span class="ref"><sup class="xref xrefblue">65</sup><span class="refCtt closed"><span>65. A. Crespi, R. Osellame, R. Ramponi, D. J. Brod, E. F. Galvão, N. Spagnolo, C.Vitelli, E. Maiorino, P. Mataloni and F. Sciarrino, Nat. Photon. 7, 545 (2013).</span></span></span>], to the largest experiment reported to date with 20 input photons (though only 14 made it to the output) in a 60-mode interferometer [<span class="ref"><sup class="xref xrefblue">66</sup><span class="refCtt closed"><span>66. H. Wang, J. Qin, X. Ding, M.-C. Chen, S. Chen, X. You, Y.-M. He, X. Jiang, L. You,Z. Wang, et al., Phys. Rev. Lett. 123, 250503 (2019).</span></span></span>].</p>
        <p>Unfortunately, it is beyond the scope of this work to describe in further detail all the developments, both theoretical and experimental, in the field of quantum advantage (and BosonSampling in particular). A non-exhaustive list includes strengthened proofs more robust against experimental imperfections [<span class="ref"><sup class="xref xrefblue">67</sup><span class="refCtt closed"><span>67. S. Aaronson and D.J. Brod, Phys. Rev. A 93, 012335 (2016).</span></span></span>, <span class="ref"><sup class="xref xrefblue">68</sup><span class="refCtt closed"><span>68. A. Arkhipov, Phys. Rev. A 92, 062326 (2015).</span></span></span>, <span class="ref"><sup class="xref xrefblue">69</sup><span class="refCtt closed"><span>69. A. Leverrier and R. García-Patrón, Quantum Information and Computation 15, 489–512 (2015).</span></span></span>], the development of better competing classical algorithms [<span class="ref"><sup class="xref xrefblue">70</sup><span class="refCtt closed"><span>70. P. Clifford and R. Clifford, in Proceedings of the 29th ACM-SIAM Symposiumon Discrete Algorithms (New Orleans, USA, 2018).</span></span></span>, <span class="ref"><sup class="xref xrefblue">71</sup><span class="refCtt closed"><span>71. P. Clifford and R. Clifford, arXiv:2005.04214 (2020).</span></span></span>, <span class="ref"><sup class="xref xrefblue">72</sup><span class="refCtt closed"><span>72. A. Neville, C. Sparrow, R. Clifford, E. Johnston, P.M. Birchall, A. Montanaro and A. Laing, Nat. Phys. 13, 1153–1157 (2017).</span></span></span>, <span class="ref"><sup class="xref xrefblue">73</sup><span class="refCtt closed"><span>73. M. Oszmaniec and D.J. Brod, New J. Phys. 20, 092002 (2018).</span></span></span>, <span class="ref"><sup class="xref xrefblue">74</sup><span class="refCtt closed"><span>74. D.J. Brod and M. Oszmaniec, Quantum 4, 267 (2020).</span></span></span>, <span class="ref"><sup class="xref xrefblue">75</sup><span class="refCtt closed"><span>75. J.J. Renema, A. Menssen, W.R. Clements, G. Triginer, W.S. Kolthammer and I.A.Walmsley, Phys. Rev. Lett. 120, 220502 (2018).</span></span></span>, <span class="ref"><sup class="xref xrefblue">76</sup><span class="refCtt closed"><span>76. J. Renema, V. Shchesnovich and R. Garcia-Patron, arXiv:1809.01953 (2018).</span></span></span>, <span class="ref"><sup class="xref xrefblue">77</sup><span class="refCtt closed"><span>77. S. Rahimi-Keshari, T.C. Ralph and C.M. Caves, Phys. Rev. X 6, 021039 (2016).</span></span></span>], the raising of other important issues, such as how to efficiently <i>verify</i> the output data to guarantee that the device is working correctly [<span class="ref"><sup class="xref xrefblue">78</sup><span class="refCtt closed"><span>78. C. Gogolin, M. Kliesch, L. Aolita and J. Eisert, arXiv:1306.3995 (2013).</span></span></span>, <span class="ref"><sup class="xref xrefblue">79</sup><span class="refCtt closed"><span>79. M. Walschaers, J. Kuipers, J.-D. Urbina, K. Mayer, M.C. Tichy, Klaus Richter and A. Buchleitner, New J. Phys. 18, 032001 (2016).</span></span></span>, <span class="ref"><sup class="xref xrefblue">80</sup><span class="refCtt closed"><span>80. J. Carolan, J.D.A. Meinecke, P.J. Shadbolt, N.J. Russell, N. Ismail, K.Wörhoff, T. Rudolph, M.G. Thompson, J.L. O’Brien, J.C.F. Matthews, et al.,Nat. Photon. 8, 621 (2014).</span></span></span>, <span class="ref"><sup class="xref xrefblue">81</sup><span class="refCtt closed"><span>81. N. Spagnolo, C. Vitelli, M. Bentivegna, D.J. Brod, A. Crespi, F. Flamini, S.Giacomini, G. Milani, R. Ramponi, P. Mataloni, et al., Nat. Photon. 8, 615 (2014).</span></span></span>], or proposal of alternative models, such as BosonSampling with Gaussian input states rather than Fock states [<span class="ref"><sup class="xref xrefblue">82</sup><span class="refCtt closed"><span>82. A.P. Lund, A. Laing, S. Rahimi-Keshari, T. Rudolph, J.L. O’Brien and T.C. Ralph, Phys. Rev. Lett. 113, 100502 (2014).</span></span></span>, <span class="ref"><sup class="xref xrefblue">83</sup><span class="refCtt closed"><span>83. C.S. Hamilton, R. Kruse, L. Sansoni, S. Barkhofen, C. Silberhorn and I. Jex, Phys.Rev. Lett. 119, 170501 (2017).</span></span></span>]. We direct the interested reader to recent review articles for more thorough overviews of these developments [<span class="ref"><sup class="xref xrefblue">12</sup><span class="refCtt closed"><span>12. A.W. Harrow and A. Montanaro, Nature 549, 203 (2017).</span></span></span>, <span class="ref"><sup class="xref xrefblue">13</sup><span class="refCtt closed"><span>13. A.P. Lund, M.J. Bremner and T.C. Ralph, npj Quantum Information 3, 15(2017).</span></span></span>, <span class="ref"><sup class="xref xrefblue">38</sup><span class="refCtt closed"><span>38. D.J. Brod, E.F. Galvão, A. Crespi, R. Osellame, N. Spagnolo and F. Sciarrino, Advanced Photonics 1, 034001 (2019).</span></span></span>, <span class="ref"><sup class="xref xrefblue">84</sup><span class="refCtt closed"><span>84. S. Mullane, arXiv:2007.07872 (2020).</span></span></span>].</p>
      
      
        <h2>4.5. Fermions and bosons beyond linear optics</h2>
        <p>So far we have restricted our attention to linear optics, which is the focus of this work. However, there are some interesting connections to complexity theory to be found beyond this setup, in particular when one is interested in computing other quantities such as ground state energies or partition functions. So in this Section I will briefly discuss some of them. In particular, we will see that computing the ground state of Hamiltonians is, in general, a very hard problem, and interestingly it tends to be harder for fermions than for bosons, in contrast to our discussion so far.</p>
        <p>Let us first, however, consider extensions of linear optics. Can we boost the computational power of either bosons or fermions by adding resources beyond those defined in our linear-optical setup shown in Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS2_F3"><span class="sci-ico-fileFigure"></span>3</a>? Recall that linear-optical unitaries acting on <i>m</i> modes inhabit a space of dimension roughly <i>m</i><sup>2</sup>, whereas the Fock space of <i>n</i> particles in <i>m</i> modes, which we denoted by <i>F</i><sub><i>m,n</i></sub> and <i>B</i><sub><i>m,n</i></sub> for fermions and bosons respectively, is exponentially larger. Therefore, there could conceivably be other interesting complexity regimes between linear optics and arbitrary transformations. Interestingly, that does not seem to be the case. It was shown in [<span class="ref"><sup class="xref xrefblue">85</sup><span class="refCtt closed"><span>85. M. Oszmaniec and Z. Zimborás, Phys. Rev. Lett. 119, 220502 (2017).</span></span></span>] that, except for very fringe cases, when we supplement linear optics (either bosonic or fermionic) with any number-preserving Hamiltonian that is not quadratic in the particle operators we already obtain universality, in the sense that we can generate any transformation within either <i>F</i><sub><i>m,n</i></sub> or <i>B</i><sub><i>m,n</i></sub>. That is, even a simple non-linear Hamiltonian such as</p>
        <div class="row formula" id="eS4_Ex52">
<a name="S4_Ex52"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mi>H</mi>
              <mo>=</mo>
              <mrow>
                <mi>χ</mi>
                <mo>⁢</mo>
                <msub>
                  <mi>a</mi>
                  <mn>1</mn>
                </msub>
                <mo>⁢</mo>
                <msubsup>
                  <mi>a</mi>
                  <mn>1</mn>
                  <mo>†</mo>
                </msubsup>
                <mo>⁢</mo>
                <msub>
                  <mi>a</mi>
                  <mn>2</mn>
                </msub>
                <mo>⁢</mo>
                <msubsup>
                  <mi>a</mi>
                  <mn>2</mn>
                  <mo>†</mo>
                </msubsup>
              </mrow>
            </mrow>
          </math>
        </div></div>
</div>
        <p>is able to promote linear optics to all allowed transformations in the corresponding state space. Thus, there might not be anything new in between these two limits, as any supplementation of fermionic or bosonic linear optics makes them equally powerful (and as powerful as a general purpose quantum computer).</p>
        <p>Another ingredient capable of boosting the power of <i>bosonic</i> linear optics are adaptive measurements, which consists of conditioning future beam splitters and phase shifters on the outcomes of intermediate measurements. It was shown in a seminal paper by Knill, Laflamme and Milburn [<span class="ref"><sup class="xref xrefblue">58</sup><span class="refCtt closed"><span>58. E. Knill, R. Laflamme and G.J. Milburn, Nature 409, 46 (2001).</span></span></span>] that this ingredient allows universal quantum computation with linear optics. Interestingly, the same is not true for fermions, as they remain classically simulable even in this case.</p>
        <p>What if we are interested in other questions that do not fit the scattering-based setup we considered so far, such as finding the ground state of a Hamiltonian? To investigate the complexity of this question, let us momentarily set aside bosons and fermions and consider the following problem: given <i>N</i> spins and a <i>k</i>-local Hamiltonian acting on these spins, what is its ground state energy? By <i>k</i>-local Hamiltonian we just mean one that can be written as</p>
        <div class="row formula" id="eS4_E16">
<a name="S4_E16"></a><div class="col-md-12"><div class="formula-container">
          <span class="label">(16)</span>
          <math display="block">
            <mrow>
              <mi>H</mi>
              <mo>=</mo>
              <mrow>
                <munder>
                  <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                  <mi>i</mi>
                </munder>
                <msub>
                  <mi>H</mi>
                  <mi>i</mi>
                </msub>
              </mrow>
            </mrow>
          </math>
        </div></div>
</div>
        <p>where each <i>H</i><sub><i>i</i></sub> acts non-trivially on at most on <i>k</i> spins, though there is <i>a priori</i> no restriction that these spins are <i>physically</i> close to each other.</p>
        <p>How hard should we expect this problem to be? It is easy to show that it must be at least as hard as <b>NP</b> problems. To prove this, consider again problem 2, where the king wants to distribute <i>N</i> regions between his three children. We encode this problem into a collection of <i>N</i> 3-level systems, each encoding one region of the map. For each pair of <i>neighboring</i> regions, the Hamiltonian has a term <i>H</i><sub><i>i</i></sub> given by</p>
        <div class="row formula" id="eS4_Ex53">
<a name="S4_Ex53"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <msub>
                  <mi>H</mi>
                  <mi>i</mi>
                </msub>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>00</mn>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">⟨</mo>
                    <mn>00</mn>
                    <mo fence="true" stretchy="false">|</mo>
                    <mo>+</mo>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>11</mn>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">⟨</mo>
                    <mn>11</mn>
                    <mo fence="true" stretchy="false">|</mo>
                    <mo>+</mo>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>22</mn>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">⟨</mo>
                    <mn>22</mn>
                    <mo fence="true" stretchy="false">|</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>with identity implied on the remaining systems. In other words, this Hamiltonian gives an energy penalty of + 1 whenever two neighboring particles are in the same state. If we now identify the state labels {0,1,2} with the three heirs to the kingdom, it is clear that this Hamiltonian will have a zero energy ground state if and only if it is possible to divide the map such that no two neighboring regions belong to the same person. Since the latter problem is <b>NP</b>–complete, it follows that, in general, deciding whether a Hamiltonian has a zero-energy ground state is at least as hard as <b>NP</b> [<span class="ref"><sup class="xref xrefblue">86</sup><span class="refCtt closed"><span>86. M. Troyer and U.-J. Wiese, Phys. Rev. Lett. 94, 170201 (2005).</span></span></span>].</p>
        <p>Could this problem be even harder than <b>NP</b> in general? The answer in fact seems to be yes. Define the <i>k</i>-local Hamiltonian problem as follows:</p>
        <p>
          <b>Problem 5.</b>
          <i>Given a <i>k</i>-local Hamiltonian<span class="ref footnote"><sup class="xref">17</sup><span class="refCtt closed"><span class="refCttPadding">
        There is a further technical constraint that the norm of each Hi be at most polynomially large in n.
      </span></span></span> as defined in equation (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS4_E16"><span class="sci-ico-fileFormula"></span>16</a>), determine whether</i>
        </p>
        <ol type="1">
<li>
            (i)
            <p>
              <i><b><i>H</i></b> has an eigenvalue less than <i>a</i>, or</i>
            </p>
          </li>
<li>
            (ii)
            <p><i>all eigenvalues of <b>H</b> are larger than b</i>,</p>
          </li>
</ol>
        <p><i>promised that one of these is true, and where b</i>−<i>a</i> ≥ 1/<i>poly</i>(<i>n</i>).</p>
        <p>This problem was proven to be complete for a complexity class called <b>QMA</b>. The class <b>QMA</b> is the quantum analogue of <b>NP</b>. Recall that, in the definition of <b>NP</b>, we required that there exist a certificate <i>y</i> that can be checked in polynomial time on a classical computer. For <b>QMA</b>, we require instead that there exist a <i>quantum state</i> |<i>y</i>⟩ which acts as a certificate that can be checked in polynomial time on a quantum computer (note that, analogous to the case of <b>NP</b>, we might need a court magician to prepare this state as a quantum computer might not be able to do this efficiently).</p>
        <p>The <i>k</i>-local Hamiltonian is a natural candidate for problem in <b>QMA</b>. Whenever <i>H</i> does have a low-energy eigenvalue, we can use the corresponding eigenstate as a certificate. A quantum computer that receives this state as an input can act on it, efficiently estimate the corresponding eigenvalue (a procedure known as phase estimation [<span class="ref"><sup class="xref xrefblue">7</sup><span class="refCtt closed"><span>7. M.A. Nielsen and I.L. Chuang, Quantum Computation and Quantum Information (Cambridge University Press, Cambridge, 2000).</span></span></span>]), and verify that condition (i) is satisfied. In fact, the general <i>k</i>-local Hamiltonian problem was proven by Kitaev [<span class="ref"><sup class="xref xrefblue">6</sup><span class="refCtt closed"><span>6. A.Y. Kitaev, A.H. Shen and M.N. Vyalyi, Classical and Quantum Computation (American Mathematical Society, Rhode Island, 2002).</span></span></span>] to be <b>QMA</b>–complete, and hence one of the hardest problems in the class <b>QMA</b>. This suggests that this problem cannot be <i>solved</i> efficiently by a quantum computer, even though an answer can be checked efficiently, for the same reasons that it is believed that <b>P</b> ≠ <b>NP</b>.</p>
        <p>The result of Kitaev was improved in several subsequent works, most notably by Oliveira and Terhal [<span class="ref"><sup class="xref xrefblue">87</sup><span class="refCtt closed"><span>87. R. Oliveira and B.M. Terhal, Quantum Information and Computation 8, 900 (2008).</span></span></span>], who showed that it still <b>QMA</b>–complete to solve this problem in the case where the Hamiltonians are <i>geometrically</i> 2-local, if the particles are arranged on a 2D square lattice, and if the particles are <i>qubits</i>, i.e. two-level systems. For an overview of <b>QMA</b>–complete problems, see [<span class="ref"><sup class="xref xrefblue">88</sup><span class="refCtt closed"><span>88. A.D. Bookatz, Quantum Information and Computation 14, 361 (2014).</span></span></span>].</p>
        <p>Let us now return to our discussion on bosons and fermions. What happens to the complexity of the <i>k</i>-local Hamiltonian problem when we have (interacting) bosons or fermions? Interestingly, for many cases there is an inversion of complexity compared to what we saw so far. That is, fermionic systems are typically harder to solve than bosonic ones. This is known as the <i>sign problem</i> in Quantum Monte Carlo simulations, so let us give an idea of why this happens.</p>
        <p>Suppose we wish to compute the expectation value of some operator <i>A</i> in a thermal state with inverse temperature β (the <i>k</i>-local Hamiltonian can be thought of as the low-temperature limit of this problem when <i>A = H</i>). This requires computing</p>
        <div class="row formula" id="eS4_Ex54">
<a name="S4_Ex54"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mo stretchy="false">⟨</mo>
                  <mi>A</mi>
                  <mo stretchy="false">⟩</mo>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mfrac>
                    <mn>1</mn>
                    <mi>Z</mi>
                  </mfrac>
                  <mo>⁢</mo>
                  <mtext>tr</mtext>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">[</mo>
                    <mrow>
                      <mi>A</mi>
                      <mo>⁢</mo>
                      <mrow>
                        <mi>exp</mi>
                        <mo>⁡</mo>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <mrow>
                            <mo>-</mo>
                            <mrow>
                              <mi>β</mi>
                              <mo>⁢</mo>
                              <mi>H</mi>
                            </mrow>
                          </mrow>
                          <mo stretchy="false">)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo stretchy="false">]</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <div class="row formula" id="eS4_Ex55">
<a name="S4_Ex55"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mi>Z</mi>
                <mo>=</mo>
                <mrow>
                  <mtext>tr</mtext>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">[</mo>
                    <mrow>
                      <mi>exp</mi>
                      <mo>⁡</mo>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mrow>
                          <mo>-</mo>
                          <mrow>
                            <mi>β</mi>
                            <mo>⁢</mo>
                            <mi>H</mi>
                          </mrow>
                        </mrow>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </mrow>
                    <mo stretchy="false">]</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>where <i>Z</i> is the partition function. One way to perform this computation is to write a series expansion</p>
        <div class="row formula" id="eS4_Ex56">
<a name="S4_Ex56"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mtable columnalign="left">
              <mtr>
                <mtd>
                  <mi>Z</mi>
                  <mo>=</mo>
                  <mtext> </mtext>
                  <mtext>tr</mtext>
                  <mtext> </mtext>
                  <mo stretchy="false">[</mo>
                  <mi>exp</mi>
                  <mo stretchy="false">(</mo>
                  <mo>−</mo>
                  <mi>β</mi>
                  <mi>H</mi>
                  <mo stretchy="false">)</mo>
                  <mo stretchy="false">]</mo>
                  <mo>=</mo>
                  <munder>
                    <mstyle displaystyle="true" mathsize="140%">
                      <mo>∑</mo>
                    </mstyle>
                    <mi>n</mi>
                  </munder>
                  <mfrac>
                    <mrow>
                      <msup>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <mo>−</mo>
                          <mi>β</mi>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mi>n</mi>
                      </msup>
                    </mrow>
                    <mrow>
                      <mi>n</mi>
                      <mo>!</mo>
                    </mrow>
                  </mfrac>
                  <mtext>tr</mtext>
                  <msup>
                    <mi>H</mi>
                    <mi>n</mi>
                  </msup>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mtext> </mtext>
                  <mo>=</mo>
                  <munder>
                    <mstyle displaystyle="true" mathsize="140%">
                      <mo>∑</mo>
                    </mstyle>
                    <mi>n</mi>
                  </munder>
                  <munder>
                    <mstyle displaystyle="true" mathsize="140%">
                      <mo>∑</mo>
                    </mstyle>
                    <mrow>
                      <msub>
                        <mi>i</mi>
                        <mn>1</mn>
                      </msub>
                      <mtext>…</mtext>
                      <msub>
                        <mi>i</mi>
                        <mi>n</mi>
                      </msub>
                    </mrow>
                  </munder>
                  <mfrac>
                    <mrow>
                      <msup>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <mo>−</mo>
                          <mi>β</mi>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mi>n</mi>
                      </msup>
                    </mrow>
                    <mrow>
                      <mi>n</mi>
                      <mo>!</mo>
                    </mrow>
                  </mfrac>
                  <mtext> </mtext>
                  <mtext> </mtext>
                  <mrow>
                    <mo>〈</mo>
                    <mrow>
                      <msub>
                        <mi>i</mi>
                        <mn>1</mn>
                      </msub>
                      <mo>|</mo>
                      <mi>H</mi>
                      <mo>|</mo>
                      <msub>
                        <mi>i</mi>
                        <mn>2</mn>
                      </msub>
                    </mrow>
                    <mo>〉</mo>
                  </mrow>
                  <mtext> </mtext>
                  <mtext>…</mtext>
                  <mtext> </mtext>
                  <mtext> </mtext>
                  <mrow>
                    <mo>〈</mo>
                    <mrow>
                      <msub>
                        <mi>i</mi>
                        <mi>n</mi>
                      </msub>
                      <mo>|</mo>
                      <mi>H</mi>
                      <mo>|</mo>
                      <msub>
                        <mi>i</mi>
                        <mn>1</mn>
                      </msub>
                    </mrow>
                    <mo>〉</mo>
                  </mrow>
                  <mtext> </mtext>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mtext> </mtext>
                  <mo>=</mo>
                  <munder>
                    <mstyle displaystyle="true" mathsize="140%">
                      <mo>∑</mo>
                    </mstyle>
                    <mi>x</mi>
                  </munder>
                  <msub>
                    <mi>p</mi>
                    <mi>x</mi>
                  </msub>
                  <mo>,</mo>
                </mtd>
              </mtr>
            </mtable>
          </math>
        </div></div>
</div>
        <p>where we inserted a resolution of the identity between each copy of <i>H</i> in the second step, and {|<i>i</i>⟩} forms a basis for the entire system. Here, <i>x</i> runs through all sets of configurations {<i>i</i><sub>1</sub>,<i>i</i><sub>2</sub>,…<i>i</i><sub><i>n</i></sub>}. Similarly, we can write</p>
        <div class="row formula" id="eS4_Ex59">
<a name="S4_Ex59"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mo stretchy="false">⟨</mo>
                <mi>A</mi>
                <mo stretchy="false">⟩</mo>
              </mrow>
              <mo>=</mo>
              <mrow>
                <mfrac>
                  <mn>1</mn>
                  <mi>Z</mi>
                </mfrac>
                <mo>⁢</mo>
                <mrow>
                  <munder>
                    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                    <mi>x</mi>
                  </munder>
                  <mrow>
                    <msub>
                      <mi>p</mi>
                      <mi>x</mi>
                    </msub>
                    <mo>⁢</mo>
                    <msub>
                      <mi>A</mi>
                      <mi>x</mi>
                    </msub>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </math>
        </div></div>
</div>
        <p>for some coefficients <i>A<sub>x</sub></i>.</p>
        <p>Suppose, for the moment, that all <i>p</i><sub><i>x</i></sub> were positive. Then we could treat 𝒟 = {<i>p</i><sub><i>x</i></sub>/<i>Z</i>}<sub><i>x</i></sub> as a (classical) probability distribution. There are exponentially many values of <i>x</i>, so we would not be able to compute ⟨<i>A</i>⟩ exactly by the sum above, but we could estimate it via a Monte Carlo [<span class="ref"><sup class="xref xrefblue">89</sup><span class="refCtt closed"><span>89. K. Binder and D. Heermann, Monte Carlo Simulation in Statistical Physics: An Introduction, Graduate Texts in Physics (Springer, Berlin, Heidelberg, 2010).</span></span></span>] method, which consists of choosing a small set of configurations {<i>x</i>} according to <b>𝒟</b>, and estimating ⟨<i>A</i>⟩ using the sample mean from this set.</p>
        <p>The problem, of course, is that the <i>p</i><sub><i>x</i></sub> are not usually all positive. If many of these are negative, then the Monte Carlo procedure can incur an exponentially large error, coming from the fact that the <i>p</i><sub><i>x</i></sub> will tend to cancel each other and <i>Z</i> can be exponentially small. This is the so-called sign problem [<span class="ref"><sup class="xref xrefblue">90</sup><span class="refCtt closed"><span>90. H. Fehske, R. Schneider and A. Weiße, Computational Many-ParticlePhysics, (Springer, Berlin, Heidelberg, 2008).</span></span></span>], an issue well-known in the condensed matter and quantum field theory literatures. Interestingly, this closely resembles our discussion that distinguishable particles are not hard to simulate even though their transition probabilities are given by permanents, since those permanents are of matrices with only positive entries.</p>
        <p>The sign problem is not exclusive to fermions, bosonic Hamiltonians can display negative values of <i>p</i><sub><i>x</i></sub> as well [<span class="ref"><sup class="xref xrefblue">90</sup><span class="refCtt closed"><span>90. H. Fehske, R. Schneider and A. Weiße, Computational Many-ParticlePhysics, (Springer, Berlin, Heidelberg, 2008).</span></span></span>]. However, it is much more prevalent in fermionic Hamiltonians, due to the anti-commutation relations. To illustrate, consider a generic quartic Hamiltonian (either bosonic or fermionic) of the type</p>
        <div class="row formula" id="eS4_Ex60">
<a name="S4_Ex60"></a><div class="col-md-12"><div class="formula-container">
          <math display="block">
            <mrow>
              <mrow>
                <mi>H</mi>
                <mo>=</mo>
                <mrow>
                  <munder>
                    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>⁢</mo>
                      <mi>j</mi>
                      <mo>⁢</mo>
                      <mi>k</mi>
                      <mo>⁢</mo>
                      <mi>l</mi>
                    </mrow>
                  </munder>
                  <mrow>
                    <msub>
                      <mi>H</mi>
                      <mrow>
                        <mi>i</mi>
                        <mo>⁢</mo>
                        <mi>j</mi>
                        <mo>⁢</mo>
                        <mi>k</mi>
                        <mo>⁢</mo>
                        <mi>l</mi>
                      </mrow>
                    </msub>
                    <mo>⁢</mo>
                    <msub>
                      <mi>a</mi>
                      <mi>i</mi>
                    </msub>
                    <mo>⁢</mo>
                    <msub>
                      <mi>a</mi>
                      <mi>j</mi>
                    </msub>
                    <mo>⁢</mo>
                    <msubsup>
                      <mi>a</mi>
                      <mi>k</mi>
                      <mo>†</mo>
                    </msubsup>
                    <mo>⁢</mo>
                    <msubsup>
                      <mi>a</mi>
                      <mi>l</mi>
                      <mo>†</mo>
                    </msubsup>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math>
        </div></div>
</div>
        <p>where all <i>H</i><sub><i>ijkl</i></sub> are positive. The bosonic version of this Hamiltonian does not have a sign problem since, by choosing {|<i>i</i>⟩} as Fock states, when we work out each ⟨<i>i</i><sub>1</sub>|<i>H</i>|<i>i</i><sub>2</sub>⟩ term in the definition of <i>p<sub>x</sub></i>, we will use only commutation of bosonic operators, and there is no step where a minus sign could arise. On the other hand, the equivalent fermionic Hamiltonian does have a sign problem, since the anti-commutation relations can leave residual minus signs in some terms.</p>
        <p>It is possible that, for particular Hamiltonians, the sign problem can be circumvented. For instance, it has recently been shown that for some cases the sign problem can be “cured” by performing a local basis change [<span class="ref"><sup class="xref xrefblue">91</sup><span class="refCtt closed"><span>91. J. Klassen, M. Marvian, S. Piddock, M. Ioannou, I. Hen and B. Terhal, arXiv:1906.08800 (2019).</span></span></span>], though the same authors showed that, in general, even deciding whether this is possible is <b>NP</b>–complete. In any case, it is considered unlikely that a general solution to this problem exists. It was shown that the <i>2</i>-local Hamiltonian problem is, in general, also <b>QMA</b>–complete for both the fermionic [<span class="ref"><sup class="xref xrefblue">92</sup><span class="refCtt closed"><span>92. N. Schuch and F. Verstraete, Nature Physics 5, 732 (2009).</span></span></span>, <span class="ref"><sup class="xref xrefblue">93</sup><span class="refCtt closed"><span>93. J.D. Whitfield, P.J. Love and A. Aspuru-Guzik, Phys. Chem. Chem. Phys. 15, 397 (2012).</span></span></span>] and the bosonic [<span class="ref"><sup class="xref xrefblue">94</sup><span class="refCtt closed"><span>94. T.-C. Wei, M. Mosca and A. Nayak, Phys. Rev. Lett. 104, 040501 (2010).</span></span></span>] cases. Therefore, even though bosonic simulations tend to be easier in practice than fermionic ones, this is not a general feature, as they can be equally hard for generic Hamiltonians.</p>
      
    
      <h1 class="articleSectionTitle">5. Conclusion</h1>
      <p>In this review, we discussed a few ways in which computational complexity theory and quantum mechanics come together. Their intersection leads to a very active subfield, quantum complexity theory, and here we discussed some of its inhabitants.</p>
      <p>We saw how free particle dynamics–both in the bosonic (i.e. linear optics) and in the fermionic cases–defines a natural computational problem, which consists simply of simulating the output distribution of the corresponding experiment. The two problems, known as BosonSampling and FermionSampling, respectively, are quite similar from a physical point of view. In contrast, from a complexity theory perspective, they are surprisingly different, and this difference can be traced back to their dependence on matrix functions of quite disparate complexities. Fermions evolve according to matrix determinants which, as we saw, are easy to compute (in <b>P</b>), whereas bosons evolve according to the much more complex matrix permanents (which as #<b>P</b>–complete). The degree of separation between these complexity classes can be measured by the existence of the polynomial hierarchy (<b>PH</b>) between them, and the very plausible conjecture that <b>PH</b> is infinitely high.</p>
      <p>Leveraging the distinction in complexity between determinants and permanents to obtain meaningful claims for the complexity of free fermions and bosons requires quite a lot of work, since these functions are not computed directly by a real-world experiment either. To give evidence of the complexity of bosonic linear optics, we had to argue that these experiments solve <i>some</i> computational task that is hard for a classical computer—a hardness which follow from the hardness of the permanent even though the experiment cannot actually compute them. This led to the different notions of simulation described in section <strong>4.1</strong>, and ultimately to the main arguments of sections <strong>4.2</strong> and <strong>4.3</strong>.</p>
      <p>Beyond linear optics, in section <strong>4.5</strong> we discussed differences and similarities between bosons and fermions from the point of view of a different question: instead of a scattering experiment, we considered the computational complexity of computing ground state energies (or partition functions). This leads to the well-known <i>sign problem</i> which plagues fermionic simulations (e.g. based on Monte Carlo methods) in condensed matter and quantum field theory. Though conventional wisdom tells us that, in this case, bosons are easier to simulate than fermions, that is not a general rule, as they are both complete for the <b>QMA</b> complexity class.</p>
      <p>The discussion of the <i>k</i>-local Hamiltonian problem also led to an interesting instance where the influence between physics and complexity theory is reversed. Rather than using classical complexity classes to study quantum-mechanical systems, as in the case of FermionSampling and BosonSampling, we now have a complexity class that is directly defined in terms of a quantum-mechanical problem. It is one of many such quantum complexity classes that have earned their place in the Complexity Zoo [<span class="ref"><sup class="xref xrefblue">3</sup><span class="refCtt closed"><span>3. https://complexityzoo.net/Complexity_Zoo.</span><br><a href="https://complexityzoo.net/Complexity_Zoo" target="_blank">https://complexityzoo.net/Complexity_Zoo...
            </a></span></span>], and have since then started to interact with their classical counterparts.</p>
      <p>There are several interesting open problems that remain in bosonic and fermionic complexity theory. The most obvious one, to my mind, is whether we can trace the difference in complexity of free bosons and fermions to some fundamental physical property that distinguishes them. Currently, the most straightforward explanation of this is that fermions evolve according to determinants, and the latter satisfy the property that det⁡(<i>AB</i>) = det⁡<i>A</i>det⁡<i>B</i>. This property provides a shortcut which allows us to compute the determinant (and hence simulate free fermions) in polynomial time. Permanents do not have this property, and so one seems to be stuck taking an exponential time to compute them. Can we trace this property to some interesting physical aspect of fermions? On the physics side, fermions and bosons are distinguished mainly by their commutation relations, but there might be a more compelling connection between this and ease of simulation of fermionic systems.</p>
      <p>As technological progress on quantum computing advances, so does the need for understanding its foundations and limitations. Linear optics provides a testbed for the power of small-scale or restricted quantum devices, a test of quantum theory itself in the limit of increasing complexity, and a conceptual toolbox for investigating foundational aspects of quantum computers. That the bosonic or fermionic nature of the identical particles, a fundamentally quantum property, influences so heavily on the resulting computational complexity is a fascinating connection between two vast and (until recently) mostly independent theories. I hope that these connections continue to be unveiled, contributing to trace the path for the future of quantum technologies, but also benefiting both the communities of Physics and Computer Science.</p>
    </div>
<div class="articleSection" data-anchor="Acknowledgments">
<h1 class="articleSectionTitle">Acknowledgments</h1>
      
      <p>The author would like to acknowledge support from Brazilian funding agencies CNPq and FAPERJ.</p>
    </div>
<div class="articleSection" data-anchor="References">
<h1 class="articleSectionTitle">References</h1>
<div class="ref-list"><ul class="refList">
<li>
<sup class="xref big">1.</sup><div> S. Arora and B. Barak, <i>Computational Complexity: A Modern Approach</i> (Cambridge University Press, Cambridge, 2009).</div>
</li>
<li>
<sup class="xref big">2.</sup><div> https://www.claymath.org/millennium-problems<br><a href="https://www.claymath.org/millennium-problems" target="_blank">» https://www.claymath.org/millennium-problems</a>
</div>
</li>
<li>
<sup class="xref big">3.</sup><div> https://complexityzoo.net/Complexity_Zoo<br><a href="https://complexityzoo.net/Complexity_Zoo" target="_blank">» https://complexityzoo.net/Complexity_Zoo</a>
</div>
</li>
<li>
<sup class="xref big">4.</sup><div> S. Eibenberger, S. Gerlich, M. Arndt, M. Mayor and J. Tüxen, Phys. Chem. Chem.Phys. <b>15</b>, 14696 (2013).</div>
</li>
<li>
<sup class="xref big">5.</sup><div> D. Salart, A. Baas, J.A.W. van Houwelingen, N. Gisin, and H. Zbinden, Phys. Rev.Lett. <b>100</b>, 220404 (2008).</div>
</li>
<li>
<sup class="xref big">6.</sup><div> A.Y. Kitaev, A.H. Shen and M.N. Vyalyi, <i>Classical and Quantum Computation</i> (American Mathematical Society, Rhode Island, 2002).</div>
</li>
<li>
<sup class="xref big">7.</sup><div> M.A. Nielsen and I.L. Chuang, <i>Quantum Computation and Quantum Information</i> (Cambridge University Press, Cambridge, 2000).</div>
</li>
<li>
<sup class="xref big">8.</sup><div> P.W. Shor, SIAM J. Comput. <b>26</b>, 1484 (1997).</div>
</li>
<li>
<sup class="xref big">9.</sup><div> F. Arute, K. Arya, R. Babbush, D. Bacon, J.C. Bardin, R. Barends, R. Biswas, S.Boixo, F.G.S.L. Brandao, D.A. Buell, et al., Nature <b>574</b>, 505 (2019).</div>
</li>
<li>
<sup class="xref big">10.</sup><div> G. Kalai, arXiv:0904.3265 (2009).</div>
</li>
<li>
<sup class="xref big">11.</sup><div> G. Kalai, arXiv:1106.0485 (2011).</div>
</li>
<li>
<sup class="xref big">12.</sup><div> A.W. Harrow and A. Montanaro, Nature <b>549</b>, 203 (2017).</div>
</li>
<li>
<sup class="xref big">13.</sup><div> A.P. Lund, M.J. Bremner and T.C. Ralph, npj Quantum Information <b>3</b>, 15(2017).</div>
</li>
<li>
<sup class="xref big">14.</sup><div> S. Aaronson and A. Arkhipov, Theory of Computing <b>4</b>, 143 (2013).</div>
</li>
<li>
<sup class="xref big">15.</sup><div> B.M. Terhal and D.P. DiVincenzo, Phys. Rev. A <b>65</b>, 032325 (2002).</div>
</li>
<li>
<sup class="xref big">16.</sup><div> L.G. Valiant, SIAM J. Comput. <b>31</b>, 1229 (2002).</div>
</li>
<li>
<sup class="xref big">17.</sup><div> L.E. Ballentine, <i>Quantum Mechanics: A Modern Development</i> (WorldScientific, Singapura, 1998).</div>
</li>
<li>
<sup class="xref big">18.</sup><div> R.P. Feynman, Int. J. Theo. Phys. <b>21</b>, 467 (1982).</div>
</li>
<li>
<sup class="xref big">19.</sup><div> C.K. Hong, Z.Y. Ou and L. Mandel, Phys. Rev. Lett. <b>59</b>, 2044 (1987).</div>
</li>
<li>
<sup class="xref big">20.</sup><div> M. Reck, A. Zeilinger, H.J. Bernstein and P. Bertani, Phys. Rev. Lett. <b>73</b>, 58 (1994).</div>
</li>
<li>
<sup class="xref big">21.</sup><div> S. Scheel, arXiv:quant-ph/0406127 (2004).</div>
</li>
<li>
<sup class="xref big">22.</sup><div> S.A. Cook, in Proceedings of the Third Annual ACM Symposium on Theory of Computing (Ohio, 1971).</div>
</li>
<li>
<sup class="xref big">23.</sup><div> L.A. Levin, Problemy Peredači Informacii <b>9</b>, 115 (1973).</div>
</li>
<li>
<sup class="xref big">24.</sup><div> R.M. Karp, in Complexity of Computer Computations: Proceedings of a Symposium on the Complexity of Computer Computations, edited by R. E. Miller,J. W. Thatcher and J. D. Bohlinger (Plenum Press, Boston, 1972), pp. 85–103.</div>
</li>
<li>
<sup class="xref big">25.</sup><div> M.R. Garey and D.S. Johnson, <i>Computers and Intractability; A Guide to theTheory of NP-Completeness</i> (W. H. Freeman and Co., New York, 1990).</div>
</li>
<li>
<sup class="xref big">26.</sup><div> L. Fortnow, <i>The Golden Ticket: P, NP and the Search for the Impossible</i> (Princeton University Press, New Jersey, 2017).</div>
</li>
<li>
<sup class="xref big">27.</sup><div> R.L. Rivest, A. Shamir and L. Adleman, Commun. ACM <b>21</b>, 120 (1978).</div>
</li>
<li>
<sup class="xref big">28.</sup><div> S. Toda, SIAM J. Comput. <b>20</b>, 865 (1991).</div>
</li>
<li>
<sup class="xref big">29.</sup><div> X.G. Fang and G. Havas, in Proceedings of the 1997 International Symposiumon Symbolic and Algebraic Computation (Hawaii, 1997).</div>
</li>
<li>
<sup class="xref big">30.</sup><div> E.H. Bareiss, Mathematics of Computation <b>22</b>, 565 (1968).</div>
</li>
<li>
<sup class="xref big">31.</sup><div> R. Motwani and P. Raghavan, <i>Randomized Algorithms</i> (Cambridge University Press, Cambridge, 1995).</div>
</li>
<li>
<sup class="xref big">32.</sup><div> R. Zippel, in Proceedings of the International Symposiumon on Symbolic and Algebraic Computation (Berlin, Heidelberg, 1979).</div>
</li>
<li>
<sup class="xref big">33.</sup><div> J.T. Schwartz, J. ACM <b>27</b>, 701 (1980).</div>
</li>
<li>
<sup class="xref big">34.</sup><div> R.A. Demillo and R.J. Lipton, Information Processing Letters <b>7</b>, 193(1978).</div>
</li>
<li>
<sup class="xref big">35.</sup><div> L. Lovász and M.D. Plummer, <i>Matching Theory</i> (North-Holland Mathematics Studies, Holland, 1986), v. 121.</div>
</li>
<li>
<sup class="xref big">36.</sup><div> L.G. Valiant, Theoretical Computer Science <b>8</b>, 189 (1979).</div>
</li>
<li>
<sup class="xref big">37.</sup><div> L. Troyansky and N. Tishby, in Proceedings of Physics and Computation – PhysComp 96 (New England, 1996).</div>
</li>
<li>
<sup class="xref big">38.</sup><div> D.J. Brod, E.F. Galvão, A. Crespi, R. Osellame, N. Spagnolo and F. Sciarrino, Advanced Photonics <b>1</b>, 034001 (2019).</div>
</li>
<li>
<sup class="xref big">39.</sup><div> A. Arkhipov and G. Kuperberg, Geometry &amp; Topology Monographs <b>18</b>, 1 (2012).</div>
</li>
<li>
<sup class="xref big">40.</sup><div> M. Van den Nest, Quant. Inf. Comp. <b>11</b>, 784 (2011).</div>
</li>
<li>
<sup class="xref big">41.</sup><div> R. Jozsa and M. Van den Nest, Quant. Inf. Comp. <b>14</b>, 633 (2014).</div>
</li>
<li>
<sup class="xref big">42.</sup><div> P. Jordan and E. Wigner, Z. Phys. <b>47</b>, 631 (1928).</div>
</li>
<li>
<sup class="xref big">43.</sup><div> R. Jozsa and A. Miyake, Proc. R. Soc. A <b>464</b>, 3089 (2008).</div>
</li>
<li>
<sup class="xref big">44.</sup><div> S. Bravyi, M. Englbrecht, R. König and N. Peard, npj Quantum Information <b>4</b>, 1 (2018).</div>
</li>
<li>
<sup class="xref big">45.</sup><div> Y. Suzuki, K. Fujii and M. Koashi, Phys. Rev. Lett. <b>119</b>, 190503 (2017).</div>
</li>
<li>
<sup class="xref big">46.</sup><div> A. Jahn, M. Gluza, F. Pastawski and J. Eisert, Science Advances <b>5</b>, eaaw0092 (2019).</div>
</li>
<li>
<sup class="xref big">47.</sup><div> L. Stockmeyer, in Proceedings of the Fifteenth Annual ACM Symposium on Theory of Computing (New York, 1983).</div>
</li>
<li>
<sup class="xref big">48.</sup><div> D.J. Brod, arXiv:1412.7637 (2014).</div>
</li>
<li>
<sup class="xref big">49.</sup><div> D. Deutsch, Proc. R. Soc. Lond. A. <b>400</b>, 97 (1985).</div>
</li>
<li>
<sup class="xref big">50.</sup><div> F. Boudot, P. Gaudry, A. Guillevic, N. Heninger, E. Thomé and P. Zimmermann, in Proceedings of the 40th Annual International Cryptology Conference (Santa Barbara, 2020).</div>
</li>
<li>
<sup class="xref big">51.</sup><div> E. Martín-López, A. Laing, T. Lawson, R. Alvarez, X.-Q. Zhou and J.L.O’Brien, Nature Photonics <b>6</b>, 773 (2012).</div>
</li>
<li>
<sup class="xref big">52.</sup><div> C. Gidney and M. Ekerå, arXiv:1905.09749 (2019).</div>
</li>
<li>
<sup class="xref big">53.</sup><div> G. Kalai and G. Kindler, arXiv:1409.3093 (2014).</div>
</li>
<li>
<sup class="xref big">54.</sup><div> B.M. Terhal and D.P. DiVincenzo, Quant. Inf. Comp. <b>4</b>, 134 (2004).</div>
</li>
<li>
<sup class="xref big">55.</sup><div> M.J. Bremner, R. Jozsa and D.J. Shepherd, Proc. R. Soc. A <b>467</b>, 459(2011).</div>
</li>
<li>
<sup class="xref big">56.</sup><div> A.M. Dalzell, A.W. Harrow, D.E. Koh and R.L. La Placa, Quantum <b>4</b>, 264 (2020).</div>
</li>
<li>
<sup class="xref big">57.</sup><div> S. Aaronson and L. Chen, in Proceedings of the 32nd Computational Complexity Conference (Schloss Dagstuhl – Leibniz-Zentrum fuer Informatik, Dagstuhl, 2017).</div>
</li>
<li>
<sup class="xref big">58.</sup><div> E. Knill, R. Laflamme and G.J. Milburn, Nature <b>409</b>, 46 (2001).</div>
</li>
<li>
<sup class="xref big">59.</sup><div> T. Rudolph, arXiv:1607.08535 (2016).</div>
</li>
<li>
<sup class="xref big">60.</sup><div> T.R. Bromley, J.M. Arrazola, S. Jahangiri, J. Izaac, N. Quesada, A.D. Gran, M.Schuld, J. Swinarton, Z. Zabaneh and N. Killoran, Quantum Sci. Technol. <b>5</b>, 034010 (2020).</div>
</li>
<li>
<sup class="xref big">61.</sup><div> E. Pednault, J. A. Gunnels, G. Nannicini, L. Horesh and R. Wisnieff, arXiv:1910.09534 (2019).</div>
</li>
<li>
<sup class="xref big">62.</sup><div> M.A. Broome, A. Fedrizzi, S. Rahimi-Keshari, J. Dove, S. Aaronson, T.C. Ralph and A.G. White, Science <b>339</b>, 794 (2013).</div>
</li>
<li>
<sup class="xref big">63.</sup><div> J.B. Spring, B.J. Metcalf, P.C. Humphreys, W.S. Kolthammer, X.-M. Jin, M. Barbieri, A. Datta, N. Thomas-Peter, N.K. Langford, D. Kundys, et al., Science <b>339</b>, 798 (2013).</div>
</li>
<li>
<sup class="xref big">64.</sup><div> M. Tillmann, B. Dakić, R. Heilmann, S. Nolte, A. Szameit and P. Walther, Nat.Photon. <b>7</b>, 540 (2013).</div>
</li>
<li>
<sup class="xref big">65.</sup><div> A. Crespi, R. Osellame, R. Ramponi, D. J. Brod, E. F. Galvão, N. Spagnolo, C.Vitelli, E. Maiorino, P. Mataloni and F. Sciarrino, Nat. Photon. <b>7</b>, 545 (2013).</div>
</li>
<li>
<sup class="xref big">66.</sup><div> H. Wang, J. Qin, X. Ding, M.-C. Chen, S. Chen, X. You, Y.-M. He, X. Jiang, L. You,Z. Wang, et al., Phys. Rev. Lett. <b>123</b>, 250503 (2019).</div>
</li>
<li>
<sup class="xref big">67.</sup><div> S. Aaronson and D.J. Brod, Phys. Rev. A <b>93</b>, 012335 (2016).</div>
</li>
<li>
<sup class="xref big">68.</sup><div> A. Arkhipov, Phys. Rev. A <b>92</b>, 062326 (2015).</div>
</li>
<li>
<sup class="xref big">69.</sup><div> A. Leverrier and R. García-Patrón, Quantum Information and Computation <b>15</b>, 489–512 (2015).</div>
</li>
<li>
<sup class="xref big">70.</sup><div> P. Clifford and R. Clifford, in Proceedings of the 29th ACM-SIAM Symposiumon Discrete Algorithms (New Orleans, USA, 2018).</div>
</li>
<li>
<sup class="xref big">71.</sup><div> P. Clifford and R. Clifford, arXiv:2005.04214 (2020).</div>
</li>
<li>
<sup class="xref big">72.</sup><div> A. Neville, C. Sparrow, R. Clifford, E. Johnston, P.M. Birchall, A. Montanaro and A. Laing, Nat. Phys. <b>13</b>, 1153–1157 (2017).</div>
</li>
<li>
<sup class="xref big">73.</sup><div> M. Oszmaniec and D.J. Brod, New J. Phys. <b>20</b>, 092002 (2018).</div>
</li>
<li>
<sup class="xref big">74.</sup><div> D.J. Brod and M. Oszmaniec, Quantum <b>4</b>, 267 (2020).</div>
</li>
<li>
<sup class="xref big">75.</sup><div> J.J. Renema, A. Menssen, W.R. Clements, G. Triginer, W.S. Kolthammer and I.A.Walmsley, Phys. Rev. Lett. <b>120</b>, 220502 (2018).</div>
</li>
<li>
<sup class="xref big">76.</sup><div> J. Renema, V. Shchesnovich and R. Garcia-Patron, arXiv:1809.01953 (2018).</div>
</li>
<li>
<sup class="xref big">77.</sup><div> S. Rahimi-Keshari, T.C. Ralph and C.M. Caves, Phys. Rev. X <b>6</b>, 021039 (2016).</div>
</li>
<li>
<sup class="xref big">78.</sup><div> C. Gogolin, M. Kliesch, L. Aolita and J. Eisert, arXiv:1306.3995 (2013).</div>
</li>
<li>
<sup class="xref big">79.</sup><div> M. Walschaers, J. Kuipers, J.-D. Urbina, K. Mayer, M.C. Tichy, Klaus Richter and A. Buchleitner, New J. Phys. <b>18</b>, 032001 (2016).</div>
</li>
<li>
<sup class="xref big">80.</sup><div> J. Carolan, J.D.A. Meinecke, P.J. Shadbolt, N.J. Russell, N. Ismail, K.Wörhoff, T. Rudolph, M.G. Thompson, J.L. O’Brien, J.C.F. Matthews, et al.,Nat. Photon. <b>8</b>, 621 (2014).</div>
</li>
<li>
<sup class="xref big">81.</sup><div> N. Spagnolo, C. Vitelli, M. Bentivegna, D.J. Brod, A. Crespi, F. Flamini, S.Giacomini, G. Milani, R. Ramponi, P. Mataloni, et al., Nat. Photon. <b>8</b>, 615 (2014).</div>
</li>
<li>
<sup class="xref big">82.</sup><div> A.P. Lund, A. Laing, S. Rahimi-Keshari, T. Rudolph, J.L. O’Brien and T.C. Ralph, Phys. Rev. Lett. <b>113</b>, 100502 (2014).</div>
</li>
<li>
<sup class="xref big">83.</sup><div> C.S. Hamilton, R. Kruse, L. Sansoni, S. Barkhofen, C. Silberhorn and I. Jex, Phys.Rev. Lett. <b>119</b>, 170501 (2017).</div>
</li>
<li>
<sup class="xref big">84.</sup><div> S. Mullane, arXiv:2007.07872 (2020).</div>
</li>
<li>
<sup class="xref big">85.</sup><div> M. Oszmaniec and Z. Zimborás, Phys. Rev. Lett. <b>119</b>, 220502 (2017).</div>
</li>
<li>
<sup class="xref big">86.</sup><div> M. Troyer and U.-J. Wiese, Phys. Rev. Lett. <b>94</b>, 170201 (2005).</div>
</li>
<li>
<sup class="xref big">87.</sup><div> R. Oliveira and B.M. Terhal, Quantum Information and Computation <b>8</b>, 900 (2008).</div>
</li>
<li>
<sup class="xref big">88.</sup><div> A.D. Bookatz, Quantum Information and Computation <b>14</b>, 361 (2014).</div>
</li>
<li>
<sup class="xref big">89.</sup><div> K. Binder and D. Heermann, <i>Monte Carlo Simulation in Statistical Physics: An Introduction</i>, Graduate Texts in Physics (Springer, Berlin, Heidelberg, 2010).</div>
</li>
<li>
<sup class="xref big">90.</sup><div> H. Fehske, R. Schneider and A. Weiße, <i>Computational Many-ParticlePhysics</i>, (Springer, Berlin, Heidelberg, 2008).</div>
</li>
<li>
<sup class="xref big">91.</sup><div> J. Klassen, M. Marvian, S. Piddock, M. Ioannou, I. Hen and B. Terhal, arXiv:1906.08800 (2019).</div>
</li>
<li>
<sup class="xref big">92.</sup><div> N. Schuch and F. Verstraete, Nature Physics <b>5</b>, 732 (2009).</div>
</li>
<li>
<sup class="xref big">93.</sup><div> J.D. Whitfield, P.J. Love and A. Aspuru-Guzik, Phys. Chem. Chem. Phys. <b>15</b>, 397 (2012).</div>
</li>
<li>
<sup class="xref big">94.</sup><div> T.-C. Wei, M. Mosca and A. Nayak, Phys. Rev. Lett. <b>104</b>, 040501 (2010).</div>
</li>
</ul></div>
</div>
<div>
<h1></h1>
<div class="ref-list"><ul class="refList footnote">
      <li>
        <span class="xref big">1</span>
        <div>If we refer to a degree of freedom that is continuous, such as direction of propagation, the reader can assume that we are using some suitable coarse-grained discretization of it.</div>
      </li>
      <li>
        <span class="xref big">2</span>
        <div>Some readers might object to this, given that second quantization was developed precisely to deal with states with varying particle numbers. Though that might be historically accurate, this does not mean that this formalism cannot prove valuable in other circumstances. Hopefully this paper showcases an example where second quantization is the appropriate description even in the case of fixed particle number, as most of what we discuss would be considerably more complex to write in first quantization.</div>
      </li>
      <li>
        <span class="xref big">3</span>
        <div>It can also be thought of as a discretized version of the standard scattering formalism.</div>
      </li>
      <li>
        <div>In the jargon of graph theory, this problem is called GRAPH CONNECTIVITY.</div>
      </li>
      <li>
        <span class="xref big">5</span>
        <div>In complexity theory and algorithm analysis this is denoted as O(<i>n</i><sup>3</sup>). Given two functions <i>f</i>(<i>n</i>) and <i>g</i>(<i>n</i>), then <i>f</i> = O(<i>g</i>) means that <i>f</i>(<i>n</i>) is upper bounded by some positive multiple of <i>g</i>(<i>n</i>) in the limit <i>n</i>→∞. Note that a similar notation is used in the physics literature with a similar spirit but different technical meaning. We refer the reader to chapter 0 of [<span class="ref"><sup class="xref xrefblue">1</sup><span class="refCtt closed"><span>1. S. Arora and B. Barak, Computational Complexity: A Modern Approach (Cambridge University Press, Cambridge, 2009).</span></span></span>].</div>
      </li>
      <li>
        <div>This problem is known as 2-COLORING, or more generally <i>k</i>-COLORING if the king had <i>k</i> children.</div>
      </li>
      <li>
        <span class="xref big">7</span>
        <div>This is one the first major theorems proven using a computer!</div>
      </li>
      <li>
        <span class="xref big">8</span>
        <div>One caveat is that this algorithm can produce intermediate numbers with exponentially many digits [<span class="ref"><sup class="xref xrefblue">29</sup><span class="refCtt closed"><span>29. X.G. Fang and G. Havas, in Proceedings of the 1997 International Symposiumon Symbolic and Algebraic Computation (Hawaii, 1997).</span></span></span>], but there are better algorithms which are truly polynomial [<span class="ref"><sup class="xref xrefblue">30</sup><span class="refCtt closed"><span>30. E.H. Bareiss, Mathematics of Computation 22, 565 (1968).</span></span></span>].</div>
      </li>
      <li>
        <span class="xref big">9</span>
        <div>The alert reader may protest that computing the determinant is not a decision problem, so it cannot be in <b>P</b>. This is technically true, though it is possible to replace the problem of computing det⁡<i>A</i> by a sequence of decision problems of the type “is the <i>n</i>th digit of det⁡<i>A</i> greater than 5?”, which allows us to reconstruct det⁡<i>A</i> to a desired precision. So we stick to standard imprecise terminology and state that the determinant is in <b>P</b>.</div>
      </li>
      <li>
        <span class="xref big">10</span>
        <div>Interestingly, they observed that the variance for the corresponding fermionic observable encoding det⁡<i>A</i> was zero.</div>
      </li>
      <li>
        <span class="xref big">11</span>
        <div>Often, in the definition of strong simulation one is also required to computer conditional probabilities. That is, not only the probabilities over the outcomes, as in equations (<a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalSchemeS4_E14_1"><span class="sci-ico-fileFormula"></span>14</a>), but also quantities like “the probability of observing a particle on mode 2 given that a particle is known to occupy output mode 1”. This is necessary for the notion of strong simulation to be strictly stronger than that of weak simulation.</div>
      </li>
      <li>
        <span class="xref big">12</span>
        <div>The whole argument spans over 80 pages and is much too technical for the scope of this paper.</div>
      </li>
      <li>
        <span class="xref big">13</span>
        <div>Readers familiar with quantum computing might be interested in an alternative version of this argument, based on post-selection and the Knill-Laflamme-Milburn protocol for universal quantum computing with linear optics, see [<span class="ref"><sup class="xref xrefblue">14</sup><span class="refCtt closed"><span>14. S. Aaronson and A. Arkhipov, Theory of Computing 4, 143 (2013).</span></span></span>, <span class="ref"><sup class="xref xrefblue">48</sup><span class="refCtt closed"><span>48. D.J. Brod, arXiv:1412.7637 (2014).</span></span></span>].</div>
      </li>
      <li>
        <span class="xref big">14</span>
        <div>For technical reasons, while Stockmeyer’s algorithm mentions the second level of the hierarchy, the final conclusion refers to its third level. This comes from the fact that we need to compare problems in <b>PH</b> to <b>P</b><sup>#<b>P</b></sup>. This does not change the final conclusion too much.</div>
      </li>
      <li>
        <span class="xref big">15</span>
        <div>I should point out that linear optics is also universal for quantum computing. It requires resources beyond BosonSampling, such as the ability to perform projective measurements and change the subsequent circuit depending on the outcome [<span class="ref"><sup class="xref xrefblue">58</sup><span class="refCtt closed"><span>58. E. Knill, R. Laflamme and G.J. Milburn, Nature 409, 46 (2001).</span></span></span>]. A natural qubit present in these systems is the polarization of a single photon, though any two modes that a photon may occupy can be used to encode a qubit. This technological platform is also currently being pursued as a viable candidate for quantum computing [<span class="ref"><sup class="xref xrefblue">59</sup><span class="refCtt closed"><span>59. T. Rudolph, arXiv:1607.08535 (2016).</span></span></span>, <span class="ref"><sup class="xref xrefblue">60</sup><span class="refCtt closed"><span>60. T.R. Bromley, J.M. Arrazola, S. Jahangiri, J. Izaac, N. Quesada, A.D. Gran, M.Schuld, J. Swinarton, Z. Zabaneh and N. Killoran, Quantum Sci. Technol. 5, 034010 (2020).</span></span></span>].</div>
      </li>
      <li>
        <span class="xref big">16</span>
        <div>The authors claim that a classical supercomputer would take ten thousand years to simulate this experiment. This has been challenged in the literature, with claims that an optimized classical algorithm would take in fact only a few days instead [<span class="ref"><sup class="xref xrefblue">61</sup><span class="refCtt closed"><span>61. E. Pednault, J. A. Gunnels, G. Nannicini, L. Horesh and R. Wisnieff, arXiv:1910.09534 (2019).</span></span></span>]. Some debate remains whether the latter algorithm is a fair comparison, as it requires such massive amount of data storage that it would not work if the experiment had been a bit larger. In any case, if the best classical supercomputer takes a few days to do what the quantum device did in a few seconds, I would argue that a quantum computational advantage is hard to dismiss.</div>
      </li>
      <li>
        <div>There is a further technical constraint that the norm of each <i>H</i><sub><i>i</i></sub> be at most polynomially large in <i>n</i>.</div>
      </li>
    </ul></div>
</div>
<div class="articleSection" data-anchor="Publication Dates">
<h1 class="articleSectionTitle">Publication Dates</h1>
<div class="row"><div class="col-md-12 col-sm-12"><ul class="articleTimeline">
<li>
<strong>Publication in this collection</strong><br>05 Mar 2021</li>
<li>
<strong>Date of issue</strong><br>2021</li>
</ul></div></div>
</div>
<div class="articleSection" data-anchor="History">
<h1 class="articleSectionTitle">History</h1>
<div class="row"><div class="col-md-12 col-sm-12"><ul class="articleTimeline">
<li>
<strong>Received</strong><br>22 Sept 2020</li>
<li>
<strong>Reviewed</strong><br>10 Nov 2020</li>
<li>
<strong>Accepted</strong><br>17 Nov 2020</li>
</ul></div></div>
</div>
<section class="documentLicense"><div class="container-license"><div class="row">
<div class="col-sm-3 col-md-2"><a href="https://creativecommons.org/licenses/by/4.0/deed.en" target="_blank" title=""><img src="https://licensebuttons.net/l/by/4.0/deed.en/88x31.png" alt="Creative Common - by 4.0 deed.en"></a></div>
<div class="col-sm-9 col-md-10"><a href="https://creativecommons.org/licenses/by/4.0/deed.en" target="_blank" title="">This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</a></div>
</div></div></section></article>
</div>
</div></div></section><div class="modal fade ModalDefault ModalTutors" id="ModalTutors" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">About the author</h4>
</div>
<div class="modal-body">
<div class="info"><div class="tutors">
<strong> Daniel Jost Brod </strong><strong>
            *
          </strong><br><div>Universidade Federal Fluminense, Instituto de Física, Niterói, RJ, Brasil</div>
<ul class="md-list inline"><li><a href="http://orcid.org/0000-0002-5925-4158" class="btnContribLinks orcid">http://orcid.org/0000-0002-5925-4158</a></li></ul>
<div class="clearfix"></div>
</div></div>
        <div class="info">* Correspondence email address: <a href="mailto:danieljostbrod@id.uff.br">danieljostbrod@id.uff.br</a> </div>
      </div>
</div></div></div>
<div class="modal fade ModalDefault" id="ModalTablesFigures" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">Figures | Formulas</h4>
</div>
<div class="modal-body">
<ul class="nav nav-tabs md-tabs" role="tablist">
<li role="presentation" class="col-md-4 col-sm-4 active"><a href="#figures" aria-controls="figures" role="tab" data-toggle="tab">Figures
                    (8)
                </a></li>
<li role="presentation" class="col-md-4 col-sm-4 "><a href="#schemes" aria-controls="schemes" role="tab" data-toggle="tab">Formulas
                    (74)
                </a></li>
</ul>
<div class="clearfix"></div>
<div class="tab-content">
<div role="tabpanel" class="tab-pane active" id="figures">
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalFigS2_F1"><div class="thumbImg">
<img src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/ab150b3aa9a423d1f0bfa480dc5da2360bdca55e.jpg">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8">
<strong>Figure 1</strong><br>
              Elementary two-mode linear-optical transformations. (a) A phase shifter. (b) A beam splitter. (c) An arbitrary SU(2) element, with three free parameters.
            </div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalFigS2_F2"><div class="thumbImg">
<img src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/ec33dbc9ae1b604b040556fcb4e08571149c12a3.jpg">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8">
<strong>Figure 2</strong><br>
              Effect of a 50:50 beam splitter on different particle types. In each diagram, the circles represent particles, which are input on the left of the beamsplitter. At the output, columns represent possible outcomes with their correct relative frequencies. (a) For a single particle (yellow), there is no difference in behavior between bosons and fermions. (b) The Hong-Ou-Mandel effect, where two photons (blue) impinging on a balanced beam splitter always leave it together. (c) The Pauli exclusion principle, which states that two fermions (red) cannot occupy the same mode. (d) For comparison, the behavior of distinguishable particles (white), which exit the beam splitter together or separately with equal probabilities.
            </div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalFigS2_F3"><div class="thumbImg">
<img src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/db501ff6b8067cbe8cc29cd1ca30613bab62719d.jpg">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8">
<strong>Figure 3</strong><br>
              The standard linear-optical setup we consider, composed of (i) Fock state input with <i>n</i> particles (bosons or fermions) in <i>m</i> modes, (ii) arbitrary <i>m</i>-mode linear-optical transformations (which can be decomposed as a circuit of <i>m</i>(<i>m</i>−1) elementary transformations [<span class="ref"><sup class="xref xrefblue">20</sup><span class="refCtt closed"><span>20. M. Reck, A. Zeilinger, H.J. Bernstein and P. Bertani, Phys. Rev. Lett. 73, 58 (1994).</span></span></span>]), and (iii) detection of occupation number at all output ports, repeated to build statistics.
            </div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalFigS3_F4"><div class="thumbImg">
<img src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/dbaf2feaf0916202d5b7249ef106715a9d9f91fd.jpg">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8">
<strong>Figure 4</strong><br>
            On the left, two ancient tablets, one with a list of cities and the other with a list of borders. To decide whether all cities are in the same island, you represent this data as a graph, on the right, where cities are vertices and edges correspond to shared borders. This does not yield a visual answer to the problem, so you resort to the procedure described in the text. You choose one city and label it as 1, its neighbors as 2, subsequent neighbors as 3, and so on. As the procedure terminates, you realize that three cities have not been labeled, and you conclude they are located on a second island.
          </div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalFigS3_F5"><div class="thumbImg">
<img src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/051f0db58daaed985fc93572d8700cc8df284d3c.jpg">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8">
<strong>Figure 5</strong><br>
            A map of the king’s island, which he wishes to divide between his children according to the rules of problem 2. If the king only has two children, this task is impossible, as this map is not 2-colorable. A proof of this fact follows by analyzing the possibilities around the triple border in the center or the map. The map is 3-colorable, so the division is possible if the king has three children, as shown above. (If the king evicts everyone from the green region and removes it from the kingdom, the map does become 2-colorable.)
          </div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalFigS3_F6"><div class="thumbImg">
<img src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/85dc22b3e4384236b1b514b02ddf7bf80ecf69c6.jpg">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8">
<strong>Figure 6</strong><br>
            Abridged version of the petting zoo of complexity classes [<span class="ref"><sup class="xref xrefblue">3</sup><span class="refCtt closed"><span>3. https://complexityzoo.net/Complexity_Zoo.</span><br><a href="https://complexityzoo.net/Complexity_Zoo" target="_blank">https://complexityzoo.net/Complexity_Zoo...
            </a></span></span>], focusing on the most common classes and those important for this work. The only classes not mentioned in the main text are <b>PSPACE</b>, corresponding to problems solvable by a classical computer with polynomial memory (regardless of how long it takes), and <b>EXP</b>, which corresponds to problems which classical computers can solve given exponential time. Lines indicates inclusions, from bottom to top (e.g. <b>P</b> ⊆ <b>NP</b>), though not necessarily strict inclusions (e.g. it is unknown whether <b>NP</b> ⊆ <b>P</b>).
          </div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalFigS3_F7"><div class="thumbImg">
<img src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/88dccff995a208d31e8e30627ba3bb04aa203428.jpg">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8">
<strong>Figure 7</strong><br>
            The problem of finding a perfect matching between a group of students. Blue and orange dots represent senior and junior students, respectively. For every pair of students that are willing to work together, we draw an edge between them. In blue, we represent one possible solution to this problem. For this example, there are three possible perfect matchings.
          </div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalFigS4_F8"><div class="thumbImg">
<img src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/9cf7059db276e5b15620f006cfb066edb4588fa0.jpg">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8">
<strong>Figure 8</strong><br>
            Two notions of classical simulation. (a) A quantum experiment within the setup of Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS2_F3"><span class="sci-ico-fileFigure"></span>3</a> is completely defined by its interferometer matrix <i>U</i>. (b) A strong classical simulator takes as input <i>U</i> and outputs the value of any outcome probability. (c) A weak classical simulator takes as input <i>U</i> and outputs samples from the corresponding distribution.
          </div>
</div>
</div>
<div role="tabpanel" class="tab-pane " id="schemes">
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex1"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex3"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex4"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex5"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex6"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_E1_1"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(1a)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_E1_2"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(1b)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_E2_1"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(2a)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_E2_2"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(2b)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex7"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex8"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex9"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex10"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex11"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex12"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex13"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex14"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex15"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex16"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex17"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex18"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_E3"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(3)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_E4"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(4)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex19"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex20"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex21"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex22"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex23"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex24"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex25"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex26"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex27"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex28"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex29"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_E5"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(5)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_E6"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(6)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_E7"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(7)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex31"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex32"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex33"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex34"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_E8_1"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(8a)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_E8_2"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(8b)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_E9_1"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(9a)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_E9_2"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(9b)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS2_Ex35"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(10)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS3_Ex36"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS3_Ex37"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS3_Ex38"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS3_Ex39"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS3_E11"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(11)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS3_E12"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(12)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS3_Ex40"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS3_Ex42"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS3_E13"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(13)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS3_Ex43"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_Ex44"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_Ex45"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_E14_1"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(14a)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_E14_2"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(14b)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_Ex46"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_Ex47"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_Ex48"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_Ex49"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_E15"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(15)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_Ex51"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_Ex52"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_E16"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"><strong>(16)</strong></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_Ex53"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_Ex54"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_Ex55"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_Ex56"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_Ex59"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
<div class="row fig">
<div class="col-md-4"><a data-toggle="modal" data-target="#ModalSchemeS4_Ex60"><div class="thumbOff">
                        Thumbnail
                        <div class="zoom"><span class="sci-ico-zoom"></span></div>
</div></a></div>
<div class="col-md-8"></div>
</div>
</div>
</div>
</div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalFigS2_F1" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><a class="link-newWindow showTooltip" target="_blank" data-placement="left" title="Open new window" href="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/5a2bed5c4ddd5ecf773355c5f38003f031766cf7.jpg"><span class="sci-ico-newWindow"></span></a><h4 class="modal-title">
<span class="sci-ico-fileFigure"></span>Figure 1   
              Elementary two-mode linear-optical transformations. (a) A phase shifter. (b) A beam splitter. (c) An arbitrary SU(2) element, with three free parameters.
            <br>
</h4>
</div>
<div class="modal-body"><img style="max-width:100%" src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/5a2bed5c4ddd5ecf773355c5f38003f031766cf7.jpg"></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalFigS2_F2" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><a class="link-newWindow showTooltip" target="_blank" data-placement="left" title="Open new window" href="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/73750a31a5d8cebb773c139c2f73cbf6fcbdcd63.jpg"><span class="sci-ico-newWindow"></span></a><h4 class="modal-title">
<span class="sci-ico-fileFigure"></span>Figure 2   
              Effect of a 50:50 beam splitter on different particle types. In each diagram, the circles represent particles, which are input on the left of the beamsplitter. At the output, columns represent possible outcomes with their correct relative frequencies. (a) For a single particle (yellow), there is no difference in behavior between bosons and fermions. (b) The Hong-Ou-Mandel effect, where two photons (blue) impinging on a balanced beam splitter always leave it together. (c) The Pauli exclusion principle, which states that two fermions (red) cannot occupy the same mode. (d) For comparison, the behavior of distinguishable particles (white), which exit the beam splitter together or separately with equal probabilities.
            <br>
</h4>
</div>
<div class="modal-body"><img style="max-width:100%" src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/73750a31a5d8cebb773c139c2f73cbf6fcbdcd63.jpg"></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalFigS2_F3" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><a class="link-newWindow showTooltip" target="_blank" data-placement="left" title="Open new window" href="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/9d10f4737271dd58122033eecec36ab4c692760b.jpg"><span class="sci-ico-newWindow"></span></a><h4 class="modal-title">
<span class="sci-ico-fileFigure"></span>Figure 3   
              The standard linear-optical setup we consider, composed of (i) Fock state input with <i>n</i> particles (bosons or fermions) in <i>m</i> modes, (ii) arbitrary <i>m</i>-mode linear-optical transformations (which can be decomposed as a circuit of <i>m</i>(<i>m</i>−1) elementary transformations [<span class="ref"><sup class="xref xrefblue">20</sup><span class="refCtt closed"><span>20. M. Reck, A. Zeilinger, H.J. Bernstein and P. Bertani, Phys. Rev. Lett. 73, 58 (1994).</span></span></span>]), and (iii) detection of occupation number at all output ports, repeated to build statistics.
            <br>
</h4>
</div>
<div class="modal-body"><img style="max-width:100%" src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/9d10f4737271dd58122033eecec36ab4c692760b.jpg"></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalFigS3_F4" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><a class="link-newWindow showTooltip" target="_blank" data-placement="left" title="Open new window" href="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/ed089bde0039337dac367a1509c68f123bc3ae50.jpg"><span class="sci-ico-newWindow"></span></a><h4 class="modal-title">
<span class="sci-ico-fileFigure"></span>Figure 4   
            On the left, two ancient tablets, one with a list of cities and the other with a list of borders. To decide whether all cities are in the same island, you represent this data as a graph, on the right, where cities are vertices and edges correspond to shared borders. This does not yield a visual answer to the problem, so you resort to the procedure described in the text. You choose one city and label it as 1, its neighbors as 2, subsequent neighbors as 3, and so on. As the procedure terminates, you realize that three cities have not been labeled, and you conclude they are located on a second island.
          <br>
</h4>
</div>
<div class="modal-body"><img style="max-width:100%" src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/ed089bde0039337dac367a1509c68f123bc3ae50.jpg"></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalFigS3_F5" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><a class="link-newWindow showTooltip" target="_blank" data-placement="left" title="Open new window" href="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/497bc73d3244e1bcb93b266a90790da13c1deaad.jpg"><span class="sci-ico-newWindow"></span></a><h4 class="modal-title">
<span class="sci-ico-fileFigure"></span>Figure 5   
            A map of the king’s island, which he wishes to divide between his children according to the rules of problem 2. If the king only has two children, this task is impossible, as this map is not 2-colorable. A proof of this fact follows by analyzing the possibilities around the triple border in the center or the map. The map is 3-colorable, so the division is possible if the king has three children, as shown above. (If the king evicts everyone from the green region and removes it from the kingdom, the map does become 2-colorable.)
          <br>
</h4>
</div>
<div class="modal-body"><img style="max-width:100%" src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/497bc73d3244e1bcb93b266a90790da13c1deaad.jpg"></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalFigS3_F6" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><a class="link-newWindow showTooltip" target="_blank" data-placement="left" title="Open new window" href="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/84aebe97608bdbb370b5b80ec8a33f7ee859af53.jpg"><span class="sci-ico-newWindow"></span></a><h4 class="modal-title">
<span class="sci-ico-fileFigure"></span>Figure 6   
            Abridged version of the petting zoo of complexity classes [<span class="ref"><sup class="xref xrefblue">3</sup><span class="refCtt closed"><span>3. https://complexityzoo.net/Complexity_Zoo.</span><br><a href="https://complexityzoo.net/Complexity_Zoo" target="_blank">https://complexityzoo.net/Complexity_Zoo...
            </a></span></span>], focusing on the most common classes and those important for this work. The only classes not mentioned in the main text are <b>PSPACE</b>, corresponding to problems solvable by a classical computer with polynomial memory (regardless of how long it takes), and <b>EXP</b>, which corresponds to problems which classical computers can solve given exponential time. Lines indicates inclusions, from bottom to top (e.g. <b>P</b> ⊆ <b>NP</b>), though not necessarily strict inclusions (e.g. it is unknown whether <b>NP</b> ⊆ <b>P</b>).
          <br>
</h4>
</div>
<div class="modal-body"><img style="max-width:100%" src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/84aebe97608bdbb370b5b80ec8a33f7ee859af53.jpg"></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalFigS3_F7" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><a class="link-newWindow showTooltip" target="_blank" data-placement="left" title="Open new window" href="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/dd352500db610b66ba587ab5905dea0308ccf120.jpg"><span class="sci-ico-newWindow"></span></a><h4 class="modal-title">
<span class="sci-ico-fileFigure"></span>Figure 7   
            The problem of finding a perfect matching between a group of students. Blue and orange dots represent senior and junior students, respectively. For every pair of students that are willing to work together, we draw an edge between them. In blue, we represent one possible solution to this problem. For this example, there are three possible perfect matchings.
          <br>
</h4>
</div>
<div class="modal-body"><img style="max-width:100%" src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/dd352500db610b66ba587ab5905dea0308ccf120.jpg"></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalFigS4_F8" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><a class="link-newWindow showTooltip" target="_blank" data-placement="left" title="Open new window" href="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/83042515ac858e84bbd71a5670cc73c6c6902fba.jpg"><span class="sci-ico-newWindow"></span></a><h4 class="modal-title">
<span class="sci-ico-fileFigure"></span>Figure 8   
            Two notions of classical simulation. (a) A quantum experiment within the setup of Figure <a href="" class="open-asset-modal" data-toggle="modal" data-target="#ModalFigS2_F3"><span class="sci-ico-fileFigure"></span>3</a> is completely defined by its interferometer matrix <i>U</i>. (b) A strong classical simulator takes as input <i>U</i> and outputs the value of any outcome probability. (c) A weak classical simulator takes as input <i>U</i> and outputs samples from the corresponding distribution.
          <br>
</h4>
</div>
<div class="modal-body"><img style="max-width:100%" src="https://minio.scielo.br/documentstore/1806-9126/JDtGnH8jDn8yCKwXBfFXMpR/83042515ac858e84bbd71a5670cc73c6c6902fba.jpg"></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex1" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mo stretchy="false">[</mo>
                  <msub>
                    <mi>b</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>,</mo>
                  <msubsup>
                    <mi>b</mi>
                    <mi>j</mi>
                    <mo>†</mo>
                  </msubsup>
                  <mo stretchy="false">]</mo>
                </mrow>
                <mo>=</mo>
                <msub>
                  <mi>δ</mi>
                  <mrow>
                    <mi>i</mi>
                    <mo>⁢</mo>
                    <mi>j</mi>
                  </mrow>
                </msub>
              </mrow>
              <mo>,</mo>
            </mrow>
            <mrow>
              <mrow>
                <mi></mi>
                <mo>=</mo>
                <mn>0</mn>
                <mo>=</mo>
                <mrow>
                  <mo stretchy="false">[</mo>
                  <msubsup>
                    <mi>b</mi>
                    <mi>i</mi>
                    <mo>†</mo>
                  </msubsup>
                  <mo>,</mo>
                  <msubsup>
                    <mi>b</mi>
                    <mi>j</mi>
                    <mo>†</mo>
                  </msubsup>
                  <mo stretchy="false">]</mo>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex3" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mi mathvariant="normal">{</mi>
              <msub>
                <mi>f</mi>
                <mi>i</mi>
              </msub>
              <mo>,</mo>
              <msubsup>
                <mi>f</mi>
                <mi>j</mi>
                <mo>†</mo>
              </msubsup>
              <mo stretchy="false">}</mo>
              <mo>=</mo>
              <mi>δ</mi>
              <msub>
                <mi></mi>
                <mrow>
                  <mi>i</mi>
                  <mo>⁢</mo>
                  <mi>j</mi>
                </mrow>
              </msub>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex4" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mi mathvariant="normal">{</mi>
              <msub>
                <mi>f</mi>
                <mi>i</mi>
              </msub>
              <mo>,</mo>
              <msub>
                <mi>f</mi>
                <mi>j</mi>
              </msub>
              <mo stretchy="false">}</mo>
              <mo>=</mo>
              <mn>0</mn>
              <mo>=</mo>
              <mo stretchy="false">{</mo>
              <msubsup>
                <mi>f</mi>
                <mi>i</mi>
                <mo>†</mo>
              </msubsup>
              <mo>,</mo>
              <msubsup>
                <mi>f</mi>
                <mi>j</mi>
                <mo>†</mo>
              </msubsup>
              <mo stretchy="false">}</mo>
              <mo>.</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex5" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msup>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <msup>
                        <mi>b</mi>
                        <mo>†</mo>
                      </msup>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mi>n</mi>
                  </msup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>0</mn>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msqrt>
                    <mrow>
                      <mi>n</mi>
                      <mo lspace="0pt" rspace="3.5pt">!</mo>
                    </mrow>
                  </msqrt>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex6" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msup>
                      <mi>f</mi>
                      <mo>†</mo>
                    </msup>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>0</mn>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mo fence="true" stretchy="false">|</mo>
                  <mn>1</mn>
                  <mo stretchy="false">⟩</mo>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_E1_1" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(1a)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msup>
                    <mi>b</mi>
                    <mo>†</mo>
                  </msup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msqrt>
                    <mrow>
                      <mi>n</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                  </msqrt>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mrow>
                      <mi>n</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_E1_2" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(1b)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mi>b</mi>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msqrt>
                    <mi>n</mi>
                  </msqrt>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_E2_1" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(2a)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msup>
                    <mi>f</mi>
                    <mo>†</mo>
                  </msup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <mi>n</mi>
                      <mo>,</mo>
                      <mn>0</mn>
                    </mrow>
                  </msub>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mrow>
                      <mi>n</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_E2_2" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(2b)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mi>f</mi>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <mi>n</mi>
                      <mo>,</mo>
                      <mn>1</mn>
                    </mrow>
                  </msub>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex7" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msup>
                    <mi>a</mi>
                    <mo>†</mo>
                  </msup>
                  <mo>⁢</mo>
                  <mi>a</mi>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mi>n</mi>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>n</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex8" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <munderover>
                    <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>=</mo>
                      <mn>1</mn>
                    </mrow>
                    <mi>m</mi>
                  </munderover>
                  <mrow>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <msubsup>
                          <mi>b</mi>
                          <mi>i</mi>
                          <mo>†</mo>
                        </msubsup>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <msub>
                        <mi>n</mi>
                        <mi>i</mi>
                      </msub>
                    </msup>
                    <mo>⁢</mo>
                    <mrow>
                      <mo fence="true" stretchy="false">|</mo>
                      <mn>0</mn>
                      <mo stretchy="false">⟩</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msup>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <munderover>
                          <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
                          <mrow>
                            <mi>i</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mi>m</mi>
                        </munderover>
                        <mrow>
                          <msub>
                            <mi>n</mi>
                            <mi>i</mi>
                          </msub>
                          <mo lspace="0pt" rspace="3.5pt">!</mo>
                        </mrow>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mfrac>
                      <mn>1</mn>
                      <mn>2</mn>
                    </mfrac>
                  </msup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>N</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex9" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msubsup>
                    <mi>b</mi>
                    <mi>i</mi>
                    <mo>†</mo>
                  </msubsup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>N</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msqrt>
                    <mrow>
                      <msub>
                        <mi>n</mi>
                        <mi>i</mi>
                      </msub>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                  </msqrt>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mrow>
                      <msub>
                        <mi>n</mi>
                        <mn>1</mn>
                      </msub>
                      <mo>,</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>,</mo>
                      <mrow>
                        <msub>
                          <mi>n</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>,</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>,</mo>
                      <msub>
                        <mi>n</mi>
                        <mi>m</mi>
                      </msub>
                    </mrow>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex10" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msubsup>
                    <mi>b</mi>
                    <mi>i</mi>
                    <mo>†</mo>
                  </msubsup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>N</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msqrt>
                    <msub>
                      <mi>n</mi>
                      <mi>i</mi>
                    </msub>
                  </msqrt>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mrow>
                      <msub>
                        <mi>n</mi>
                        <mn>1</mn>
                      </msub>
                      <mo>,</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>,</mo>
                      <mrow>
                        <msub>
                          <mi>n</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>,</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>,</mo>
                      <msub>
                        <mi>n</mi>
                        <mi>m</mi>
                      </msub>
                    </mrow>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex11" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msup>
                    <mrow>
                      <mo>(</mo>
                      <msubsup>
                        <mi>f</mi>
                        <mn>1</mn>
                        <mo>†</mo>
                      </msubsup>
                      <mo>)</mo>
                    </mrow>
                    <msub>
                      <mi>n</mi>
                      <mn>1</mn>
                    </msub>
                  </msup>
                  <mo>⁢</mo>
                  <msup>
                    <mrow>
                      <mo>(</mo>
                      <msubsup>
                        <mi>f</mi>
                        <mn>2</mn>
                        <mo>†</mo>
                      </msubsup>
                      <mo>)</mo>
                    </mrow>
                    <msub>
                      <mi>n</mi>
                      <mn>2</mn>
                    </msub>
                  </msup>
                  <mo>⁢</mo>
                  <mi mathvariant="normal">…</mi>
                  <mo>⁢</mo>
                  <msup>
                    <mrow>
                      <mo>(</mo>
                      <msubsup>
                        <mi>f</mi>
                        <mi>m</mi>
                        <mo>†</mo>
                      </msubsup>
                      <mo>)</mo>
                    </mrow>
                    <msub>
                      <mi>n</mi>
                      <mi>m</mi>
                    </msub>
                  </msup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>0</mn>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mo fence="true" stretchy="false">|</mo>
                  <mi>N</mi>
                  <mo stretchy="false">⟩</mo>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex12" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msubsup>
                    <mi>f</mi>
                    <mi>i</mi>
                    <mo>†</mo>
                  </msubsup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>N</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <msub>
                        <mi>n</mi>
                        <mi>i</mi>
                      </msub>
                      <mo>,</mo>
                      <mn>0</mn>
                    </mrow>
                  </msub>
                  <mo>⁢</mo>
                  <msup>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mrow>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mstyle displaystyle="false">
                        <msub>
                          <mo largeop="true" symmetric="true">∑</mo>
                          <mrow>
                            <mi>j</mi>
                            <mo>&lt;</mo>
                            <mi>i</mi>
                          </mrow>
                        </msub>
                      </mstyle>
                      <msub>
                        <mi>n</mi>
                        <mi>j</mi>
                      </msub>
                    </mrow>
                  </msup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mrow>
                      <msub>
                        <mi>n</mi>
                        <mn>1</mn>
                      </msub>
                      <mo>,</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>,</mo>
                      <mrow>
                        <msub>
                          <mi>n</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>,</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>,</mo>
                      <msub>
                        <mi>n</mi>
                        <mi>m</mi>
                      </msub>
                    </mrow>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex13" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msub>
                    <mi>f</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>N</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <msub>
                        <mi>n</mi>
                        <mi>i</mi>
                      </msub>
                      <mo>,</mo>
                      <mn>1</mn>
                    </mrow>
                  </msub>
                  <mo>⁢</mo>
                  <msup>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mrow>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mstyle displaystyle="false">
                        <msub>
                          <mo largeop="true" symmetric="true">∑</mo>
                          <mrow>
                            <mi>j</mi>
                            <mo>&lt;</mo>
                            <mi>i</mi>
                          </mrow>
                        </msub>
                      </mstyle>
                      <msub>
                        <mi>n</mi>
                        <mi>j</mi>
                      </msub>
                    </mrow>
                  </msup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mrow>
                      <msub>
                        <mi>n</mi>
                        <mn>1</mn>
                      </msub>
                      <mo>,</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>,</mo>
                      <mrow>
                        <msub>
                          <mi>n</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>,</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>,</mo>
                      <msub>
                        <mi>n</mi>
                        <mi>m</mi>
                      </msub>
                    </mrow>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex14" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msubsup>
                    <mi>a</mi>
                    <mi>i</mi>
                    <mo>†</mo>
                  </msubsup>
                  <mo>⁢</mo>
                  <msub>
                    <mi>a</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>N</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msub>
                    <mi>n</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mi>N</mi>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex15" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mfrac>
                  <mn>1</mn>
                  <msqrt>
                    <mn>2</mn>
                  </msqrt>
                </mfrac>
                <mo>⁢</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <msub>
                      <mrow>
                        <mo fence="true" stretchy="false">|</mo>
                        <mn>01</mn>
                        <mo stretchy="false">⟩</mo>
                      </mrow>
                      <mn>1</mn>
                    </msub>
                    <mo>+</mo>
                    <msub>
                      <mrow>
                        <mo fence="true" stretchy="false">|</mo>
                        <mn>10</mn>
                        <mo stretchy="false">⟩</mo>
                      </mrow>
                      <mn>1</mn>
                    </msub>
                  </mrow>
                  <mo rspace="0.8pt">)</mo>
                </mrow>
              </mrow>
              <mo>,</mo>
              <mtext> for bosons, and</mtext>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex16" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mfrac>
                  <mn>1</mn>
                  <msqrt>
                    <mn>2</mn>
                  </msqrt>
                </mfrac>
                <mo>⁢</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <msub>
                      <mrow>
                        <mo fence="true" stretchy="false">|</mo>
                        <mn>01</mn>
                        <mo stretchy="false">⟩</mo>
                      </mrow>
                      <mn>1</mn>
                    </msub>
                    <mo>-</mo>
                    <msub>
                      <mrow>
                        <mo fence="true" stretchy="false">|</mo>
                        <mn>10</mn>
                        <mo stretchy="false">⟩</mo>
                      </mrow>
                      <mn>1</mn>
                    </msub>
                  </mrow>
                  <mo rspace="0.8pt">)</mo>
                </mrow>
              </mrow>
              <mo>,</mo>
              <mtext> for fermions.</mtext>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex17" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mo fence="true">|</mo>
                <msub>
                  <mi>F</mi>
                  <mrow>
                    <mi>m</mi>
                    <mo>,</mo>
                    <mi>n</mi>
                  </mrow>
                </msub>
                <mrow>
                  <mo fence="true" stretchy="false">|</mo>
                  <mo>=</mo>
                  <mfrac>
                    <mrow>
                      <mi>m</mi>
                      <mo lspace="0pt" rspace="3.5pt">!</mo>
                    </mrow>
                    <mrow>
                      <mrow>
                        <mi>n</mi>
                        <mo lspace="0pt" rspace="3.5pt">!</mo>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <mrow>
                            <mi>m</mi>
                            <mo>-</mo>
                            <mi>n</mi>
                          </mrow>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mo lspace="0pt" rspace="3.5pt">!</mo>
                      </mrow>
                    </mrow>
                  </mfrac>
                  <mo>=</mo>
                  <mpadded width="-1.7pt">
                    <mrow>
                      <mo>(</mo>
                      <mfrac linethickness="0pt">
                        <mi>m</mi>
                        <mi>n</mi>
                      </mfrac>
                      <mo>)</mo>
                    </mrow>
                  </mpadded>
                  <mo>.</mo>
                </mrow>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex18" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mo fence="true">|</mo>
                <msub>
                  <mi>B</mi>
                  <mrow>
                    <mi>m</mi>
                    <mo>,</mo>
                    <mi>n</mi>
                  </mrow>
                </msub>
                <mrow>
                  <mo fence="true" stretchy="false">|</mo>
                  <mo>=</mo>
                  <mfrac>
                    <mrow>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mrow>
                          <mrow>
                            <mi>m</mi>
                            <mo>+</mo>
                            <mi>n</mi>
                          </mrow>
                          <mo>-</mo>
                          <mn>1</mn>
                        </mrow>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo lspace="0pt" rspace="3.5pt">!</mo>
                    </mrow>
                    <mrow>
                      <mrow>
                        <mi>n</mi>
                        <mo lspace="0pt" rspace="3.5pt">!</mo>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <mrow>
                            <mi>m</mi>
                            <mo>-</mo>
                            <mn>1</mn>
                          </mrow>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mo lspace="0pt" rspace="3.5pt">!</mo>
                      </mrow>
                    </mrow>
                  </mfrac>
                  <mo>=</mo>
                  <mpadded width="-1.7pt">
                    <mrow>
                      <mo>(</mo>
                      <mfrac linethickness="0pt">
                        <mrow>
                          <mrow>
                            <mi>m</mi>
                            <mo>+</mo>
                            <mi>n</mi>
                          </mrow>
                          <mo>-</mo>
                          <mn>1</mn>
                        </mrow>
                        <mi>n</mi>
                      </mfrac>
                      <mo>)</mo>
                    </mrow>
                  </mpadded>
                  <mo>.</mo>
                </mrow>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_E3" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(3)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <msub>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <msubsup>
                        <mi>a</mi>
                        <mi>i</mi>
                        <mo>†</mo>
                      </msubsup>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mtext>out</mtext>
                      <mtext mathsize="142%"> </mtext>
                    </mrow>
                  </msub>
                  <mo>=</mo>
                  <mrow>
                    <munderover>
                      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                      <mrow>
                        <mi>j</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mi>m</mi>
                    </munderover>
                    <mrow>
                      <msub>
                        <mi>U</mi>
                        <mrow>
                          <mi>i</mi>
                          <mo>⁢</mo>
                          <mi>j</mi>
                        </mrow>
                      </msub>
                      <mo>⁢</mo>
                      <msub>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <msubsup>
                            <mi>a</mi>
                            <mi>j</mi>
                            <mo>†</mo>
                          </msubsup>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mrow>
                          <mtext>in</mtext>
                          <mtext mathsize="142%"> </mtext>
                        </mrow>
                      </msub>
                    </mrow>
                  </mrow>
                </mrow>
                <mo rspace="12.5pt">,</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mrow>
                    <mn>1</mn>
                    <mo>,</mo>
                    <mn>2</mn>
                    <mo>,</mo>
                    <mi mathvariant="normal">…</mi>
                    <mo>,</mo>
                    <mi>m</mi>
                  </mrow>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_E4" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(4)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mi>H</mi>
                <mo>=</mo>
                <mrow>
                  <munder>
                    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>⁢</mo>
                      <mi>j</mi>
                    </mrow>
                  </munder>
                  <mrow>
                    <msub>
                      <mi>h</mi>
                      <mrow>
                        <mi>i</mi>
                        <mo>⁢</mo>
                        <mi>j</mi>
                      </mrow>
                    </msub>
                    <mo>⁢</mo>
                    <msub>
                      <mi>a</mi>
                      <mi>i</mi>
                    </msub>
                    <mo>⁢</mo>
                    <msubsup>
                      <mi>a</mi>
                      <mi>j</mi>
                      <mo>†</mo>
                    </msubsup>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex19" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mfrac>
                  <mi>d</mi>
                  <mrow>
                    <mi>d</mi>
                    <mo>⁢</mo>
                    <mi>t</mi>
                  </mrow>
                </mfrac>
                <mo>⁢</mo>
                <msubsup>
                  <mi>b</mi>
                  <mi>i</mi>
                  <mo>†</mo>
                </msubsup>
                <mo>⁢</mo>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <mi>t</mi>
                  <mo stretchy="false">)</mo>
                </mrow>
              </mrow>
              <mo>=</mo>
              <mrow>
                <mpadded width="+0.6pt">
                  <mi mathvariant="normal">i</mi>
                </mpadded>
                <mo>⁢</mo>
                <mrow>
                  <mo stretchy="false">[</mo>
                  <mi>H</mi>
                  <mo>,</mo>
                  <mrow>
                    <msubsup>
                      <mi>b</mi>
                      <mi>i</mi>
                      <mo>†</mo>
                    </msubsup>
                    <mo>⁢</mo>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>t</mi>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </mrow>
                  <mo stretchy="false">]</mo>
                </mrow>
              </mrow>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex20" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mfrac>
                  <mi>d</mi>
                  <mrow>
                    <mi>d</mi>
                    <mo>⁢</mo>
                    <mi>t</mi>
                  </mrow>
                </mfrac>
                <mo>⁢</mo>
                <msubsup>
                  <mi>b</mi>
                  <mi>i</mi>
                  <mo>†</mo>
                </msubsup>
                <mo>⁢</mo>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <mi>t</mi>
                  <mo stretchy="false">)</mo>
                </mrow>
              </mrow>
              <mo>=</mo>
              <mrow>
                <mpadded width="+0.6pt">
                  <mi mathvariant="normal">i</mi>
                </mpadded>
                <mo>⁢</mo>
                <mrow>
                  <munder>
                    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                    <mi>j</mi>
                  </munder>
                  <mrow>
                    <msub>
                      <mi>h</mi>
                      <mrow>
                        <mi>i</mi>
                        <mo>⁢</mo>
                        <mi>j</mi>
                      </mrow>
                    </msub>
                    <mo>⁢</mo>
                    <msubsup>
                      <mi>b</mi>
                      <mi>j</mi>
                      <mo>†</mo>
                    </msubsup>
                    <mo>⁢</mo>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>t</mi>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex21" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <msubsup>
                  <mi>b</mi>
                  <mi>i</mi>
                  <mo>†</mo>
                </msubsup>
                <mo>⁢</mo>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <mi>t</mi>
                  <mo stretchy="false">)</mo>
                </mrow>
              </mrow>
              <mo>=</mo>
              <mrow>
                <munder>
                  <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                  <mi>j</mi>
                </munder>
                <mrow>
                  <msub>
                    <mi>U</mi>
                    <mrow>
                      <mi>i</mi>
                      <mo>⁢</mo>
                      <mi>j</mi>
                    </mrow>
                  </msub>
                  <mo>⁢</mo>
                  <msubsup>
                    <mi>b</mi>
                    <mi>j</mi>
                    <mo>†</mo>
                  </msubsup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <mn>0</mn>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex22" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mrow>
                  <msub>
                    <mi>H</mi>
                    <mrow>
                      <mi>P</mi>
                      <mo>⁢</mo>
                      <mi>S</mi>
                    </mrow>
                  </msub>
                  <mo>=</mo>
                  <mrow>
                    <mi>ϕ</mi>
                    <mo>⁢</mo>
                    <msup>
                      <mi>a</mi>
                      <mo>†</mo>
                    </msup>
                    <mo>⁢</mo>
                    <mi>a</mi>
                  </mrow>
                </mrow>
                <mo>,</mo>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex23" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mrow>
                  <msub>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <msup>
                        <mi>a</mi>
                        <mo>†</mo>
                      </msup>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mtext>out</mtext>
                      <mtext mathsize="142%"> </mtext>
                    </mrow>
                  </msub>
                  <mo>=</mo>
                  <mrow>
                    <msup>
                      <mi>e</mi>
                      <mrow>
                        <mpadded width="+0.6pt">
                          <mi mathvariant="normal">i</mi>
                        </mpadded>
                        <mo>⁢</mo>
                        <mi>ϕ</mi>
                      </mrow>
                    </msup>
                    <mo>⁢</mo>
                    <msub>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <msup>
                          <mi>a</mi>
                          <mo>†</mo>
                        </msup>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mrow>
                        <mtext>in</mtext>
                        <mtext mathsize="142%"> </mtext>
                      </mrow>
                    </msub>
                  </mrow>
                </mrow>
                <mo>.</mo>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex24" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mrow>
                  <msub>
                    <mi>H</mi>
                    <mrow>
                      <mi>B</mi>
                      <mo>⁢</mo>
                      <mi>S</mi>
                    </mrow>
                  </msub>
                  <mo>=</mo>
                  <mrow>
                    <mi>θ</mi>
                    <mo>⁢</mo>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mrow>
                        <mrow>
                          <msubsup>
                            <mi>a</mi>
                            <mn>1</mn>
                            <mo>†</mo>
                          </msubsup>
                          <mo>⁢</mo>
                          <msub>
                            <mi>a</mi>
                            <mn>2</mn>
                          </msub>
                        </mrow>
                        <mo>+</mo>
                        <mrow>
                          <msubsup>
                            <mi>a</mi>
                            <mn>2</mn>
                            <mo>†</mo>
                          </msubsup>
                          <mo>⁢</mo>
                          <msub>
                            <mi>a</mi>
                            <mn>1</mn>
                          </msub>
                        </mrow>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>,</mo>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex25" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <msub>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msubsup>
                      <mi>a</mi>
                      <mn>1</mn>
                      <mo>†</mo>
                    </msubsup>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mrow>
                    <mtext>out</mtext>
                    <mtext mathsize="142%"> </mtext>
                  </mrow>
                </msub>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <mrow>
                      <mi>cos</mi>
                      <mo>⁡</mo>
                      <mi>θ</mi>
                    </mrow>
                    <mo>⁢</mo>
                    <msub>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <msubsup>
                          <mi>a</mi>
                          <mn>1</mn>
                          <mo>†</mo>
                        </msubsup>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mrow>
                        <mtext>in</mtext>
                        <mtext mathsize="142%"> </mtext>
                      </mrow>
                    </msub>
                  </mrow>
                  <mo>-</mo>
                  <mrow>
                    <mpadded width="+0.6pt">
                      <mi mathvariant="normal">i</mi>
                    </mpadded>
                    <mo>⁢</mo>
                    <mrow>
                      <mi>sin</mi>
                      <mo>⁡</mo>
                      <mi>θ</mi>
                    </mrow>
                    <mo>⁢</mo>
                    <msub>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <msubsup>
                          <mi>a</mi>
                          <mn>2</mn>
                          <mo>†</mo>
                        </msubsup>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mrow>
                        <mtext>in</mtext>
                        <mtext mathsize="142%"> </mtext>
                      </mrow>
                    </msub>
                  </mrow>
                </mrow>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex26" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mrow>
                  <msub>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <msubsup>
                        <mi>a</mi>
                        <mn>2</mn>
                        <mo>†</mo>
                      </msubsup>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mtext>out</mtext>
                      <mtext mathsize="142%"> </mtext>
                    </mrow>
                  </msub>
                  <mo>=</mo>
                  <mrow>
                    <mrow>
                      <mo>-</mo>
                      <mrow>
                        <mpadded width="+0.6pt">
                          <mi mathvariant="normal">i</mi>
                        </mpadded>
                        <mo>⁢</mo>
                        <mrow>
                          <mi>sin</mi>
                          <mo>⁡</mo>
                          <mi>θ</mi>
                        </mrow>
                        <mo>⁢</mo>
                        <msub>
                          <mrow>
                            <mo stretchy="false">(</mo>
                            <msubsup>
                              <mi>a</mi>
                              <mn>1</mn>
                              <mo>†</mo>
                            </msubsup>
                            <mo stretchy="false">)</mo>
                          </mrow>
                          <mrow>
                            <mtext>in</mtext>
                            <mtext mathsize="142%"> </mtext>
                          </mrow>
                        </msub>
                      </mrow>
                    </mrow>
                    <mo>+</mo>
                    <mrow>
                      <mrow>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <mi>θ</mi>
                      </mrow>
                      <mo>⁢</mo>
                      <msub>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <msubsup>
                            <mi>a</mi>
                            <mn>2</mn>
                            <mo>†</mo>
                          </msubsup>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mrow>
                          <mtext>in</mtext>
                          <mtext mathsize="142%"> </mtext>
                        </mrow>
                      </msub>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>.</mo>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex27" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mrow>
                  <mi>U</mi>
                  <mo>=</mo>
                  <mpadded width="-1.7pt">
                    <mrow>
                      <mo>(</mo>
                      <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                        <mtr>
                          <mtd columnalign="center">
                            <mrow>
                              <msup>
                                <mi>e</mi>
                                <mrow>
                                  <mrow>
                                    <mpadded width="+0.6pt">
                                      <mi mathvariant="normal">i</mi>
                                    </mpadded>
                                    <mo>⁢</mo>
                                    <mrow>
                                      <mo stretchy="false">(</mo>
                                      <mrow>
                                        <msub>
                                          <mi>ϕ</mi>
                                          <mn>1</mn>
                                        </msub>
                                        <mo>+</mo>
                                        <msub>
                                          <mi>ϕ</mi>
                                          <mn>2</mn>
                                        </msub>
                                      </mrow>
                                      <mo stretchy="false">)</mo>
                                    </mrow>
                                  </mrow>
                                  <mo>/</mo>
                                  <mn>2</mn>
                                </mrow>
                              </msup>
                              <mo>⁢</mo>
                              <mrow>
                                <mi>cos</mi>
                                <mo>⁡</mo>
                                <mi>θ</mi>
                              </mrow>
                            </mrow>
                          </mtd>
                          <mtd columnalign="center">
                            <mrow>
                              <mo>-</mo>
                              <mrow>
                                <mpadded width="+0.6pt">
                                  <mi mathvariant="normal">i</mi>
                                </mpadded>
                                <mo>⁢</mo>
                                <msup>
                                  <mi>e</mi>
                                  <mrow>
                                    <mrow>
                                      <mpadded width="+0.6pt">
                                        <mi mathvariant="normal">i</mi>
                                      </mpadded>
                                      <mo>⁢</mo>
                                      <mrow>
                                        <mo stretchy="false">(</mo>
                                        <mrow>
                                          <msub>
                                            <mi>ϕ</mi>
                                            <mn>2</mn>
                                          </msub>
                                          <mo>-</mo>
                                          <msub>
                                            <mi>ϕ</mi>
                                            <mn>1</mn>
                                          </msub>
                                        </mrow>
                                        <mo stretchy="false">)</mo>
                                      </mrow>
                                    </mrow>
                                    <mo>/</mo>
                                    <mn>2</mn>
                                  </mrow>
                                </msup>
                                <mo>⁢</mo>
                                <mrow>
                                  <mi>sin</mi>
                                  <mo>⁡</mo>
                                  <mi>θ</mi>
                                </mrow>
                              </mrow>
                            </mrow>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd columnalign="center">
                            <mrow>
                              <mo>-</mo>
                              <mrow>
                                <mpadded width="+0.6pt">
                                  <mi mathvariant="normal">i</mi>
                                </mpadded>
                                <mo>⁢</mo>
                                <msup>
                                  <mi>e</mi>
                                  <mrow>
                                    <mrow>
                                      <mpadded width="+0.6pt">
                                        <mi mathvariant="normal">i</mi>
                                      </mpadded>
                                      <mo>⁢</mo>
                                      <mrow>
                                        <mo stretchy="false">(</mo>
                                        <mrow>
                                          <msub>
                                            <mi>ϕ</mi>
                                            <mn>1</mn>
                                          </msub>
                                          <mo>-</mo>
                                          <msub>
                                            <mi>ϕ</mi>
                                            <mn>2</mn>
                                          </msub>
                                        </mrow>
                                        <mo stretchy="false">)</mo>
                                      </mrow>
                                    </mrow>
                                    <mo>/</mo>
                                    <mn>2</mn>
                                  </mrow>
                                </msup>
                                <mo>⁢</mo>
                                <mrow>
                                  <mi>sin</mi>
                                  <mo>⁡</mo>
                                  <mi>θ</mi>
                                </mrow>
                              </mrow>
                            </mrow>
                          </mtd>
                          <mtd columnalign="center">
                            <mrow>
                              <msup>
                                <mi>e</mi>
                                <mrow>
                                  <mrow>
                                    <mpadded width="+0.6pt">
                                      <mi mathvariant="normal">i</mi>
                                    </mpadded>
                                    <mo>⁢</mo>
                                    <mrow>
                                      <mo stretchy="false">(</mo>
                                      <mrow>
                                        <mrow>
                                          <mo>-</mo>
                                          <msub>
                                            <mi>ϕ</mi>
                                            <mn>1</mn>
                                          </msub>
                                        </mrow>
                                        <mo>-</mo>
                                        <msub>
                                          <mi>ϕ</mi>
                                          <mn>2</mn>
                                        </msub>
                                      </mrow>
                                      <mo stretchy="false">)</mo>
                                    </mrow>
                                  </mrow>
                                  <mo>/</mo>
                                  <mn>2</mn>
                                </mrow>
                              </msup>
                              <mo>⁢</mo>
                              <mrow>
                                <mi>cos</mi>
                                <mo>⁡</mo>
                                <mi>θ</mi>
                              </mrow>
                            </mrow>
                          </mtd>
                        </mtr>
                      </mtable>
                      <mo>)</mo>
                    </mrow>
                  </mpadded>
                </mrow>
                <mo>.</mo>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex28" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mrow>
                  <mi>U</mi>
                  <mo>=</mo>
                  <mpadded width="-1.7pt">
                    <mrow>
                      <mo>(</mo>
                      <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                        <mtr>
                          <mtd columnalign="center">
                            <mi>α</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>β</mi>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd columnalign="center">
                            <mi>γ</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>δ</mi>
                          </mtd>
                        </mtr>
                      </mtable>
                      <mo>)</mo>
                    </mrow>
                  </mpadded>
                </mrow>
                <mo>.</mo>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex29" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <mrow>
                    <mrow>
                      <mi>α</mi>
                      <mo>⁢</mo>
                      <msubsup>
                        <mi>a</mi>
                        <mn>1</mn>
                        <mo>†</mo>
                      </msubsup>
                    </mrow>
                    <mo>+</mo>
                    <mrow>
                      <mi>β</mi>
                      <mo>⁢</mo>
                      <msubsup>
                        <mi>a</mi>
                        <mn>2</mn>
                        <mo>†</mo>
                      </msubsup>
                    </mrow>
                  </mrow>
                  <mo stretchy="false">)</mo>
                </mrow>
                <mo>⁢</mo>
                <mrow>
                  <mo fence="true" stretchy="false">|</mo>
                  <mn>0</mn>
                  <mo stretchy="false">⟩</mo>
                </mrow>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_E5" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(5)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mrow>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <mrow>
                      <mrow>
                        <mi>α</mi>
                        <mo>⁢</mo>
                        <msubsup>
                          <mi>b</mi>
                          <mn>1</mn>
                          <mo>†</mo>
                        </msubsup>
                      </mrow>
                      <mo>+</mo>
                      <mrow>
                        <mi>β</mi>
                        <mo>⁢</mo>
                        <msubsup>
                          <mi>b</mi>
                          <mn>2</mn>
                          <mo>†</mo>
                        </msubsup>
                      </mrow>
                    </mrow>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <mrow>
                      <mrow>
                        <mi>γ</mi>
                        <mo>⁢</mo>
                        <msubsup>
                          <mi>b</mi>
                          <mn>1</mn>
                          <mo>†</mo>
                        </msubsup>
                      </mrow>
                      <mo>+</mo>
                      <mrow>
                        <mi>δ</mi>
                        <mo>⁢</mo>
                        <msubsup>
                          <mi>b</mi>
                          <mn>2</mn>
                          <mo>†</mo>
                        </msubsup>
                      </mrow>
                    </mrow>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>0</mn>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <mi mathvariant="normal"> </mi>
                    <mo>⁢</mo>
                    <msqrt>
                      <mn>2</mn>
                    </msqrt>
                    <mo>⁢</mo>
                    <mi>α</mi>
                    <mo>⁢</mo>
                    <mi>γ</mi>
                    <mo>⁢</mo>
                    <mrow>
                      <mo fence="true" stretchy="false">|</mo>
                      <mrow>
                        <mn>2</mn>
                        <mo>,</mo>
                        <mn>0</mn>
                      </mrow>
                      <mo stretchy="false">⟩</mo>
                    </mrow>
                  </mrow>
                  <mo>+</mo>
                  <mrow>
                    <msqrt>
                      <mn>2</mn>
                    </msqrt>
                    <mo>⁢</mo>
                    <mi>β</mi>
                    <mo>⁢</mo>
                    <mi>δ</mi>
                    <mo>⁢</mo>
                    <mrow>
                      <mo fence="true" stretchy="false">|</mo>
                      <mrow>
                        <mn>0</mn>
                        <mo>,</mo>
                        <mn>2</mn>
                      </mrow>
                      <mo stretchy="false">⟩</mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
              <mrow>
                <mrow>
                  <mtext>£</mtext>
                  <mo>+</mo>
                  <mrow>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mrow>
                        <mrow>
                          <mi>α</mi>
                          <mo>⁢</mo>
                          <mi>δ</mi>
                        </mrow>
                        <mo>+</mo>
                        <mrow>
                          <mi>β</mi>
                          <mo>⁢</mo>
                          <mi>γ</mi>
                        </mrow>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mrow>
                      <mo fence="true" stretchy="false">|</mo>
                      <mrow>
                        <mn>1</mn>
                        <mo>,</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo stretchy="false">⟩</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>.</mo>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_E6" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(6)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mrow>
                  <mrow>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mrow>
                        <mrow>
                          <mi>α</mi>
                          <mo>⁢</mo>
                          <msubsup>
                            <mi>f</mi>
                            <mn>1</mn>
                            <mo>†</mo>
                          </msubsup>
                        </mrow>
                        <mo>+</mo>
                        <mrow>
                          <mi>β</mi>
                          <mo>⁢</mo>
                          <msubsup>
                            <mi>f</mi>
                            <mn>2</mn>
                            <mo>†</mo>
                          </msubsup>
                        </mrow>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mrow>
                        <mrow>
                          <mi>γ</mi>
                          <mo>⁢</mo>
                          <msubsup>
                            <mi>f</mi>
                            <mn>1</mn>
                            <mo>†</mo>
                          </msubsup>
                        </mrow>
                        <mo>+</mo>
                        <mrow>
                          <mi>δ</mi>
                          <mo>⁢</mo>
                          <msubsup>
                            <mi>f</mi>
                            <mn>2</mn>
                            <mo>†</mo>
                          </msubsup>
                        </mrow>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mrow>
                      <mo fence="true" stretchy="false">|</mo>
                      <mn>0</mn>
                      <mo stretchy="false">⟩</mo>
                    </mrow>
                  </mrow>
                  <mo>=</mo>
                  <mrow>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mrow>
                        <mrow>
                          <mi>α</mi>
                          <mo>⁢</mo>
                          <mi>δ</mi>
                        </mrow>
                        <mo>-</mo>
                        <mrow>
                          <mi>β</mi>
                          <mo>⁢</mo>
                          <mi>γ</mi>
                        </mrow>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mrow>
                      <mo fence="true" stretchy="false">|</mo>
                      <mrow>
                        <mn>1</mn>
                        <mo>,</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo stretchy="false">⟩</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>,</mo>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_E7" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(7)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mi>U</mi>
                <mo>=</mo>
                <mrow>
                  <mfrac>
                    <mn>1</mn>
                    <msqrt>
                      <mn>2</mn>
                    </msqrt>
                  </mfrac>
                  <mo>⁢</mo>
                  <mrow>
                    <mo>(</mo>
                    <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                      <mtr>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mi mathvariant="normal">i</mi>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <mi mathvariant="normal">i</mi>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                      </mtr>
                    </mtable>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex31" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mrow>
                  <mrow>
                    <mfrac>
                      <mpadded width="+0.6pt">
                        <mi mathvariant="normal">i</mi>
                      </mpadded>
                      <msqrt>
                        <mn>2</mn>
                      </msqrt>
                    </mfrac>
                    <mo>⁢</mo>
                    <mrow>
                      <mo fence="true" stretchy="false">|</mo>
                      <mrow>
                        <mn>2</mn>
                        <mo>,</mo>
                        <mn>0</mn>
                      </mrow>
                      <mo stretchy="false">⟩</mo>
                    </mrow>
                  </mrow>
                  <mo>+</mo>
                  <mrow>
                    <mfrac>
                      <mpadded width="+0.6pt">
                        <mi mathvariant="normal">i</mi>
                      </mpadded>
                      <msqrt>
                        <mn>2</mn>
                      </msqrt>
                    </mfrac>
                    <mo>⁢</mo>
                    <mrow>
                      <mo fence="true" stretchy="false">|</mo>
                      <mrow>
                        <mn>0</mn>
                        <mo>,</mo>
                        <mn>2</mn>
                      </mrow>
                      <mo stretchy="false">⟩</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>,</mo>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex32" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mrow>
                  <mo fence="true" stretchy="false">|</mo>
                  <mi>S</mi>
                  <mo stretchy="false">⟩</mo>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mo fence="true" stretchy="false">|</mo>
                  <mrow>
                    <msub>
                      <mi>s</mi>
                      <mn>1</mn>
                    </msub>
                    <mo>,</mo>
                    <msub>
                      <mi>s</mi>
                      <mn>2</mn>
                    </msub>
                    <mo>,</mo>
                    <mi mathvariant="normal">…</mi>
                    <mo>,</mo>
                    <msub>
                      <mi>s</mi>
                      <mi>m</mi>
                    </msub>
                  </mrow>
                  <mo stretchy="false">⟩</mo>
                </mrow>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex33" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mrow>
                  <mi>U</mi>
                  <mo>=</mo>
                  <mpadded width="-1.7pt">
                    <mrow>
                      <mo>(</mo>
                      <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                        <mtr>
                          <mtd columnalign="center">
                            <mi>α</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>β</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>γ</mi>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd columnalign="center">
                            <mi>δ</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>ϵ</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>ζ</mi>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd columnalign="center">
                            <mi>η</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>θ</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>ι</mi>
                          </mtd>
                        </mtr>
                      </mtable>
                      <mo>)</mo>
                    </mrow>
                  </mpadded>
                </mrow>
                <mo>,</mo>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex34" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mrow>
                  <msub>
                    <mi>U</mi>
                    <mi>T</mi>
                  </msub>
                  <mo>=</mo>
                  <mpadded width="-1.7pt">
                    <mrow>
                      <mo>(</mo>
                      <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                        <mtr>
                          <mtd columnalign="center">
                            <mi>α</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>α</mi>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd columnalign="center">
                            <mi>δ</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>δ</mi>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd columnalign="center">
                            <mi>η</mi>
                          </mtd>
                          <mtd columnalign="center">
                            <mi>η</mi>
                          </mtd>
                        </mtr>
                      </mtable>
                      <mo>)</mo>
                    </mrow>
                  </mpadded>
                </mrow>
                <mo>,</mo>
                <mrow>
                  <mrow>
                    <mtext> </mtext>
                    <mtext>and</mtext>
                    <mtext> </mtext>
                    <mo>⁢</mo>
                    <msub>
                      <mi>U</mi>
                      <mrow>
                        <mi>S</mi>
                        <mo>,</mo>
                        <mi>T</mi>
                      </mrow>
                    </msub>
                  </mrow>
                  <mo>=</mo>
                  <mrow>
                    <mo>(</mo>
                    <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                      <mtr>
                        <mtd columnalign="center">
                          <mi>δ</mi>
                        </mtd>
                        <mtd columnalign="center">
                          <mi>δ</mi>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <mi>η</mi>
                        </mtd>
                        <mtd columnalign="center">
                          <mi>η</mi>
                        </mtd>
                      </mtr>
                    </mtable>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_E8_1" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(8a)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mtext>Pr</mtext>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <mi>S</mi>
                  <mo>→</mo>
                  <mi>T</mi>
                  <mo stretchy="false">)</mo>
                </mrow>
                <mo>=</mo>
                <mstyle displaystyle="true">
                  <mfrac>
                    <mrow>
                      <mo fence="true">|</mo>
                      <mtext>per</mtext>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <msub>
                          <mi>U</mi>
                          <mrow>
                            <mi>S</mi>
                            <mo>,</mo>
                            <mi>T</mi>
                          </mrow>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <msup>
                        <mo fence="true" stretchy="false">|</mo>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                    <mrow>
                      <msub>
                        <mo largeop="true" symmetric="true">∏</mo>
                        <mi>i</mi>
                      </msub>
                      <mrow>
                        <mrow>
                          <msub>
                            <mi>s</mi>
                            <mi>i</mi>
                          </msub>
                          <mo lspace="0pt" rspace="3.5pt">!</mo>
                        </mrow>
                        <mo>⁢</mo>
                        <mrow>
                          <msub>
                            <mo largeop="true" symmetric="true">∏</mo>
                            <mi>j</mi>
                          </msub>
                          <mrow>
                            <msub>
                              <mi>t</mi>
                              <mi>j</mi>
                            </msub>
                            <mo lspace="0pt" rspace="3.5pt">!</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                    </mrow>
                  </mfrac>
                </mstyle>
                <mtext>for bosons,</mtext>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_E8_2" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(8b)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mtext>Pr</mtext>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <mi>S</mi>
                  <mo>→</mo>
                  <mi>T</mi>
                  <mo stretchy="false">)</mo>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mo fence="true">|</mo>
                  <mo movablelimits="false">det</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>U</mi>
                      <mrow>
                        <mi>S</mi>
                        <mo>,</mo>
                        <mi>T</mi>
                      </mrow>
                    </msub>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <msup>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>2</mn>
                  </msup>
                </mrow>
                <mtext>for fermions.</mtext>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_E9_1" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(9a)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mrow>
                  <mrow>
                    <mo movablelimits="false">det</mo>
                    <mo>⁡</mo>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>A</mi>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </mrow>
                  <mo>=</mo>
                  <mrow>
                    <mstyle displaystyle="true">
                      <munder>
                        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                        <mrow>
                          <mi>σ</mi>
                          <mo>∈</mo>
                          <msub>
                            <mi>S</mi>
                            <mi>n</mi>
                          </msub>
                        </mrow>
                      </munder>
                    </mstyle>
                    <mrow>
                      <mtext>sgn</mtext>
                      <mo>⁢</mo>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>σ</mi>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mstyle displaystyle="true">
                          <munderover>
                            <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
                            <mrow>
                              <mi>i</mi>
                              <mo>=</mo>
                              <mn>1</mn>
                            </mrow>
                            <mi>n</mi>
                          </munderover>
                        </mstyle>
                        <msub>
                          <mi>A</mi>
                          <mrow>
                            <mi>i</mi>
                            <mo>,</mo>
                            <msub>
                              <mi>σ</mi>
                              <mi>i</mi>
                            </msub>
                          </mrow>
                        </msub>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>,</mo>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_E9_2" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(9b)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mrow>
                  <mrow>
                    <mtext>per</mtext>
                    <mo>⁢</mo>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>A</mi>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </mrow>
                  <mo>=</mo>
                  <mrow>
                    <mstyle displaystyle="true">
                      <munder>
                        <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                        <mrow>
                          <mi>σ</mi>
                          <mo>∈</mo>
                          <msub>
                            <mi>S</mi>
                            <mi>n</mi>
                          </msub>
                        </mrow>
                      </munder>
                    </mstyle>
                    <mrow>
                      <mstyle displaystyle="true">
                        <munderover>
                          <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
                          <mrow>
                            <mi>i</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mi>n</mi>
                        </munderover>
                      </mstyle>
                      <msub>
                        <mi>A</mi>
                        <mrow>
                          <mi>i</mi>
                          <mo>,</mo>
                          <msub>
                            <mi>σ</mi>
                            <mi>i</mi>
                          </msub>
                        </mrow>
                      </msub>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>,</mo>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS2_Ex35" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(10)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
              <mrow>
                <mtext>Pr</mtext>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <mi>S</mi>
                  <mo>→</mo>
                  <mi>T</mi>
                  <mo stretchy="false">)</mo>
                </mrow>
                <mo>=</mo>
                <mstyle displaystyle="true">
                  <mfrac>
                    <mrow>
                      <mtext>per</mtext>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mrow>
                          <mo fence="true">|</mo>
                          <msub>
                            <mi>U</mi>
                            <mrow>
                              <mi>S</mi>
                              <mo>,</mo>
                              <mi>T</mi>
                            </mrow>
                          </msub>
                          <mrow>
                            <msup>
                              <mo fence="true" stretchy="false">|</mo>
                              <mn>2</mn>
                            </msup>
                            <mo stretchy="false">)</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mrow>
                      <msub>
                        <mo largeop="true" symmetric="true">∏</mo>
                        <mi>i</mi>
                      </msub>
                      <mrow>
                        <mrow>
                          <msub>
                            <mi>s</mi>
                            <mi>i</mi>
                          </msub>
                          <mo lspace="0pt" rspace="3.5pt">!</mo>
                        </mrow>
                        <mo>⁢</mo>
                        <mrow>
                          <msub>
                            <mo largeop="true" symmetric="true">∏</mo>
                            <mi>j</mi>
                          </msub>
                          <mrow>
                            <msub>
                              <mi>t</mi>
                              <mi>j</mi>
                            </msub>
                            <mo lspace="0pt" rspace="3.5pt">!</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                    </mrow>
                  </mfrac>
                </mstyle>
                <mtext> for classical particles,</mtext>
              </mrow>
            </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS3_Ex36" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mo movablelimits="false">det</mo>
                  <mo>⁡</mo>
                  <mi>A</mi>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <munder>
                    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                    <mrow>
                      <mi>σ</mi>
                      <mo>∈</mo>
                      <msub>
                        <mi>S</mi>
                        <mi>n</mi>
                      </msub>
                    </mrow>
                  </munder>
                  <mrow>
                    <mtext>sgn</mtext>
                    <mo>⁢</mo>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>σ</mi>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mrow>
                      <munderover>
                        <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
                        <mrow>
                          <mi>i</mi>
                          <mo>=</mo>
                          <mn>1</mn>
                        </mrow>
                        <mi>n</mi>
                      </munderover>
                      <mpadded width="-1.7pt">
                        <msub>
                          <mi>A</mi>
                          <mrow>
                            <mi>i</mi>
                            <mo>,</mo>
                            <msub>
                              <mi>σ</mi>
                              <mi>i</mi>
                            </msub>
                          </mrow>
                        </msub>
                      </mpadded>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS3_Ex37" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mo movablelimits="false">det</mo>
                  <mo>⁡</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <mrow>
                      <mi>X</mi>
                      <mo>⁢</mo>
                      <mi>Y</mi>
                    </mrow>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mo movablelimits="false">det</mo>
                  <mo>⁡</mo>
                  <mrow>
                    <mi>X</mi>
                    <mo>⁢</mo>
                    <mrow>
                      <mo movablelimits="false">det</mo>
                      <mo>⁡</mo>
                      <mi>Y</mi>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS3_Ex38" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mi>A</mi>
                  <mo>⁢</mo>
                  <msub>
                    <mi>B</mi>
                    <mn>1</mn>
                  </msub>
                  <mo>⁢</mo>
                  <msub>
                    <mi>B</mi>
                    <mn>2</mn>
                  </msub>
                  <mo>⁢</mo>
                  <mi mathvariant="normal">…</mi>
                  <mo>⁢</mo>
                  <msub>
                    <mi>B</mi>
                    <mi>m</mi>
                  </msub>
                </mrow>
                <mo>=</mo>
                <msup>
                  <mi>A</mi>
                  <mo>′</mo>
                </msup>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS3_Ex39" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mo movablelimits="false">det</mo>
                  <mo>⁡</mo>
                  <mi>A</mi>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msup>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mrow>
                        <mo movablelimits="false">det</mo>
                        <mo>⁡</mo>
                        <mrow>
                          <msub>
                            <mi>B</mi>
                            <mn>1</mn>
                          </msub>
                          <mo>⁢</mo>
                          <mi mathvariant="normal">…</mi>
                          <mo>⁢</mo>
                          <mrow>
                            <mo movablelimits="false">det</mo>
                            <mo>⁡</mo>
                            <msub>
                              <mi>B</mi>
                              <mi>m</mi>
                            </msub>
                          </mrow>
                        </mrow>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                  <mo>⁢</mo>
                  <mrow>
                    <mo movablelimits="false">det</mo>
                    <mo>⁡</mo>
                    <msup>
                      <mi>A</mi>
                      <mo>′</mo>
                    </msup>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS3_E11" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(11)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <msub>
                <mi>A</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>⁢</mo>
                  <mi>k</mi>
                </mrow>
              </msub>
              <mo>=</mo>
              <mrow>
                <mo>{</mo>
                <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                  <mtr>
                    <mtd columnalign="left">
                      <msub>
                        <mi>x</mi>
                        <mrow>
                          <mi>i</mi>
                          <mo>⁢</mo>
                          <mi>k</mi>
                        </mrow>
                      </msub>
                    </mtd>
                    <mtd columnalign="left">
                      <mrow>
                        <mtext> if </mtext>
                        <mo>⁢</mo>
                        <msub>
                          <mi>s</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>⁢</mo>
                        <mtext> and </mtext>
                        <mo>⁢</mo>
                        <msub>
                          <mi>j</mi>
                          <mi>k</mi>
                        </msub>
                        <mo>⁢</mo>
                        <mtext> would work together,</mtext>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd columnalign="left">
                      <mn>0</mn>
                    </mtd>
                    <mtd columnalign="left">
                      <mrow>
                        <mtext> otherwise</mtext>
                        <mo>.</mo>
                      </mrow>
                    </mtd>
                  </mtr>
                </mtable>
              </mrow>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS3_E12" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(12)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mi>A</mi>
                <mo>=</mo>
                <mpadded width="-1.7pt">
                  <mrow>
                    <mo>(</mo>
                    <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                      <mtr>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>12</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>13</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>21</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>22</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>24</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>31</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>34</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>44</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>45</mn>
                          </msub>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>53</mn>
                          </msub>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <msub>
                            <mi>x</mi>
                            <mn>55</mn>
                          </msub>
                        </mtd>
                      </mtr>
                    </mtable>
                    <mo>)</mo>
                  </mrow>
                </mpadded>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS3_Ex40" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mi>det</mi>
              <mi>A</mi>
              <mo>=</mo>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>12</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>24</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>31</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>45</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>53</mn>
                </mrow>
              </msub>
              <mo>−</mo>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>12</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>21</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>34</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>45</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>53</mn>
                </mrow>
              </msub>
              <mtext> </mtext>
              <mo>−</mo>
              <mtext> </mtext>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>13</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>22</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>31</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>44</mn>
                </mrow>
              </msub>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mn>55</mn>
                </mrow>
              </msub>
              <mo>.</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS3_Ex42" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mtext mathvariant="italic">Pr</mtext>
                <mtext> </mtext>
              </mrow>
              <mrow>
                <mo stretchy="false">[</mo>
                <mi>P</mi>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <msub>
                    <mi>a</mi>
                    <mn>1</mn>
                  </msub>
                  <mo>,</mo>
                  <msub>
                    <mi>a</mi>
                    <mn>2</mn>
                  </msub>
                  <mi mathvariant="normal">…</mi>
                  <msub>
                    <mi>a</mi>
                    <mi>n</mi>
                  </msub>
                  <mo stretchy="false">)</mo>
                </mrow>
                <mo>=</mo>
                <mn>0</mn>
                <mo stretchy="false">]</mo>
              </mrow>
              <mo>≤</mo>
              <mfrac>
                <mi>d</mi>
                <mrow>
                  <mo fence="true" stretchy="false">|</mo>
                  <mi>S</mi>
                  <mo fence="true" stretchy="false">|</mo>
                </mrow>
              </mfrac>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS3_E13" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(13)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <msup>
                  <mi>A</mi>
                  <mo>′</mo>
                </msup>
                <mo>=</mo>
                <mpadded width="-1.7pt">
                  <mrow>
                    <mo>(</mo>
                    <mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt">
                      <mtr>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                      </mtr>
                      <mtr>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>0</mn>
                        </mtd>
                        <mtd columnalign="center">
                          <mn>1</mn>
                        </mtd>
                      </mtr>
                    </mtable>
                    <mo>)</mo>
                  </mrow>
                </mpadded>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS3_Ex43" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mpadded width="+5pt">
                    <mtext>per</mtext>
                  </mpadded>
                  <mo>⁢</mo>
                  <msup>
                    <mi>A</mi>
                    <mo>′</mo>
                  </msup>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <munder>
                    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                    <mrow>
                      <mi>σ</mi>
                      <mo>∈</mo>
                      <msub>
                        <mi>S</mi>
                        <mi>n</mi>
                      </msub>
                    </mrow>
                  </munder>
                  <mrow>
                    <munderover>
                      <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
                      <mrow>
                        <mi>i</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mi>n</mi>
                    </munderover>
                    <mpadded width="-1.7pt">
                      <msubsup>
                        <mi>A</mi>
                        <mrow>
                          <mi>i</mi>
                          <mo>,</mo>
                          <msub>
                            <mi>σ</mi>
                            <mi>i</mi>
                          </msub>
                        </mrow>
                        <mo>′</mo>
                      </msubsup>
                    </mpadded>
                  </mrow>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_Ex44" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mtext>Pr</mtext>
              <mrow>
                <mo stretchy="false">(</mo>
                <mi>S</mi>
                <mo>→</mo>
                <mi>T</mi>
                <mo stretchy="false">)</mo>
              </mrow>
              <mo>=</mo>
              <mfrac>
                <mrow>
                  <mo fence="true">|</mo>
                  <mtext>per</mtext>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>U</mi>
                      <mrow>
                        <mi>S</mi>
                        <mo>,</mo>
                        <mi>T</mi>
                      </mrow>
                    </msub>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <msup>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>2</mn>
                  </msup>
                </mrow>
                <mrow>
                  <msub>
                    <mo largeop="true" symmetric="true">∏</mo>
                    <mi>i</mi>
                  </msub>
                  <mrow>
                    <mrow>
                      <msub>
                        <mi>t</mi>
                        <mi>i</mi>
                      </msub>
                      <mo lspace="0pt" rspace="3.5pt">!</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mrow>
                      <msub>
                        <mo largeop="true" symmetric="true">∏</mo>
                        <mi>j</mi>
                      </msub>
                      <mrow>
                        <msub>
                          <mi>s</mi>
                          <mi>j</mi>
                        </msub>
                        <mo lspace="0pt" rspace="3.5pt">!</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
              </mfrac>
              <mtext>, for bosons,</mtext>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_Ex45" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mtext>Pr</mtext>
              <mrow>
                <mo stretchy="false">(</mo>
                <mi>S</mi>
                <mo>→</mo>
                <mi>T</mi>
                <mo stretchy="false">)</mo>
              </mrow>
              <mo>=</mo>
              <mrow>
                <mo fence="true">|</mo>
                <mo movablelimits="false">det</mo>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <msub>
                    <mi>U</mi>
                    <mrow>
                      <mi>S</mi>
                      <mo>,</mo>
                      <mi>T</mi>
                    </mrow>
                  </msub>
                  <mo stretchy="false">)</mo>
                </mrow>
                <mrow>
                  <msup>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>2</mn>
                  </msup>
                  <mtext>, for fermions.</mtext>
                </mrow>
              </mrow>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_E14_1" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(14a)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <munder accentunder="true">
                <mrow>
                  <mtext>Pr</mtext>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <mi>T</mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </mrow>
                <mo class="ltx_font_mathcaligraphic">ℬ</mo>
              </munder>
              <mo>=</mo>
              <mrow>
                <mo fence="true">|</mo>
                <mtext>per</mtext>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <msub>
                    <mi>U</mi>
                    <mrow>
                      <mi>S</mi>
                      <mo>,</mo>
                      <mi>T</mi>
                    </mrow>
                  </msub>
                  <mo stretchy="false">)</mo>
                </mrow>
                <mrow>
                  <msup>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>2</mn>
                  </msup>
                  <mtext>, for bosons,</mtext>
                </mrow>
              </mrow>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_E14_2" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(14b)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <munder accentunder="true">
                <mrow>
                  <mtext>Pr</mtext>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <mi>T</mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </mrow>
                <mo class="ltx_font_mathcaligraphic">ℱ</mo>
              </munder>
              <mo>=</mo>
              <mrow>
                <mo fence="true">|</mo>
                <mo movablelimits="false">det</mo>
                <mrow>
                  <mo stretchy="false">(</mo>
                  <msub>
                    <mi>U</mi>
                    <mrow>
                      <mi>S</mi>
                      <mo>,</mo>
                      <mi>T</mi>
                    </mrow>
                  </msub>
                  <mo stretchy="false">)</mo>
                </mrow>
                <mrow>
                  <msup>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>2</mn>
                  </msup>
                  <mtext>, for fermions,</mtext>
                </mrow>
              </mrow>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_Ex46" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <msubsup>
                  <mi>f</mi>
                  <mi>j</mi>
                  <mo>†</mo>
                </msubsup>
                <mo>=</mo>
                <mrow>
                  <munder>
                    <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
                    <mrow>
                      <mi>k</mi>
                      <mo>&lt;</mo>
                      <mi>j</mi>
                    </mrow>
                  </munder>
                  <mrow>
                    <mrow>
                      <msub>
                        <mi>Z</mi>
                        <mi>k</mi>
                      </msub>
                      <mo>⁢</mo>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mrow>
                          <msub>
                            <mi>X</mi>
                            <mi>j</mi>
                          </msub>
                          <mo>+</mo>
                          <mrow>
                            <mpadded width="+0.6pt">
                              <mi mathvariant="normal">i</mi>
                            </mpadded>
                            <mo>⁢</mo>
                            <msub>
                              <mi>Y</mi>
                              <mi>j</mi>
                            </msub>
                          </mrow>
                        </mrow>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </mrow>
                    <mo>/</mo>
                    <mn>2</mn>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_Ex47" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <msub>
                  <mi>f</mi>
                  <mi>j</mi>
                </msub>
                <mo>=</mo>
                <mrow>
                  <munder>
                    <mo largeop="true" movablelimits="false" symmetric="true">∏</mo>
                    <mrow>
                      <mi>k</mi>
                      <mo>&lt;</mo>
                      <mi>j</mi>
                    </mrow>
                  </munder>
                  <mrow>
                    <mrow>
                      <msub>
                        <mi>Z</mi>
                        <mi>k</mi>
                      </msub>
                      <mo>⁢</mo>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mrow>
                          <msub>
                            <mi>X</mi>
                            <mi>j</mi>
                          </msub>
                          <mo>-</mo>
                          <mrow>
                            <mpadded width="+0.6pt">
                              <mi mathvariant="normal">i</mi>
                            </mpadded>
                            <mo>⁢</mo>
                            <msub>
                              <mi>Y</mi>
                              <mi>j</mi>
                            </msub>
                          </mrow>
                        </mrow>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </mrow>
                    <mo>/</mo>
                    <mn>2</mn>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_Ex48" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mo>-</mo>
                  <mrow>
                    <mrow>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mrow>
                          <msub>
                            <mi>X</mi>
                            <mn>3</mn>
                          </msub>
                          <mo>+</mo>
                          <mrow>
                            <mpadded width="+0.6pt">
                              <mi mathvariant="normal">i</mi>
                            </mpadded>
                            <mo>⁢</mo>
                            <msub>
                              <mi>Y</mi>
                              <mn>3</mn>
                            </msub>
                          </mrow>
                        </mrow>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mrow>
                          <msub>
                            <mi>X</mi>
                            <mn>4</mn>
                          </msub>
                          <mo>-</mo>
                          <mrow>
                            <mpadded width="+0.6pt">
                              <mi mathvariant="normal">i</mi>
                            </mpadded>
                            <mo>⁢</mo>
                            <msub>
                              <mi>Y</mi>
                              <mn>4</mn>
                            </msub>
                          </mrow>
                        </mrow>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </mrow>
                    <mo>/</mo>
                    <mn>4</mn>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <msubsup>
                    <mi>f</mi>
                    <mn>3</mn>
                    <mo>†</mo>
                  </msubsup>
                  <mo>⁢</mo>
                  <msub>
                    <mi>f</mi>
                    <mn>4</mn>
                  </msub>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_Ex49" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mi class="ltx_font_mathcaligraphic">ℳ</mi>
              <mo>=</mo>
              <mrow>
                <mo stretchy="false">{</mo>
                <msub>
                  <mi>X</mi>
                  <mi>i</mi>
                </msub>
                <msub>
                  <mi>Y</mi>
                  <mrow>
                    <mi>i</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
                <mo>,</mo>
                <msub>
                  <mi>Y</mi>
                  <mi>i</mi>
                </msub>
                <msub>
                  <mi>Y</mi>
                  <mrow>
                    <mi>i</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
                <mo>,</mo>
                <msub>
                  <mi>X</mi>
                  <mi>i</mi>
                </msub>
                <msub>
                  <mi>X</mi>
                  <mrow>
                    <mi>i</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
                <mo>,</mo>
              </mrow>
            </mrow>
            <mrow>
              <mtext> </mtext>
              <msub>
                <mi>Y</mi>
                <mi>i</mi>
              </msub>
              <msub>
                <mi>X</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>+</mo>
                  <mn>1</mn>
                </mrow>
              </msub>
              <mo>,</mo>
              <msub>
                <mi>Z</mi>
                <mi>i</mi>
              </msub>
              <mo>,</mo>
              <msub>
                <mi>Z</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>+</mo>
                  <mn>1</mn>
                </mrow>
              </msub>
              <mo stretchy="false">}</mo>
              <msub>
                <mi></mi>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mrow>
                    <mrow>
                      <mn>1</mn>
                      <mo>⁢</mo>
                      <mi mathvariant="normal">…</mi>
                      <mo>⁢</mo>
                      <mi>m</mi>
                    </mrow>
                    <mo>-</mo>
                    <mn>1</mn>
                  </mrow>
                </mrow>
              </msub>
              <mo>.</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_E15" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(15)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mfrac>
                  <msub>
                    <mi>p</mi>
                    <mi>x</mi>
                  </msub>
                  <mi>g</mi>
                </mfrac>
                <mo>≤</mo>
                <msub>
                  <mi>q</mi>
                  <mi>x</mi>
                </msub>
                <mo>≤</mo>
                <mrow>
                  <msub>
                    <mi>p</mi>
                    <mi>x</mi>
                  </msub>
                  <mo>⁢</mo>
                  <mi>g</mi>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_Ex51" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mo>∥</mo>
                  <mrow>
                    <msup>
                      <mi class="ltx_font_mathcaligraphic">ℬ</mi>
                      <mo>′</mo>
                    </msup>
                    <mo>-</mo>
                    <mi class="ltx_font_mathcaligraphic">ℬ</mi>
                  </mrow>
                  <mo>∥</mo>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mfrac>
                    <mn>1</mn>
                    <mn>2</mn>
                  </mfrac>
                  <mo>⁢</mo>
                  <mrow>
                    <munder>
                      <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                      <mi>x</mi>
                    </munder>
                    <mrow>
                      <mo stretchy="false">|</mo>
                      <mrow>
                        <msub>
                          <mi>p</mi>
                          <mi>x</mi>
                        </msub>
                        <mo>-</mo>
                        <msub>
                          <mi>q</mi>
                          <mi>x</mi>
                        </msub>
                      </mrow>
                      <mo stretchy="false">|</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>&lt;</mo>
                <mi>ϵ</mi>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_Ex52" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mi>H</mi>
              <mo>=</mo>
              <mrow>
                <mi>χ</mi>
                <mo>⁢</mo>
                <msub>
                  <mi>a</mi>
                  <mn>1</mn>
                </msub>
                <mo>⁢</mo>
                <msubsup>
                  <mi>a</mi>
                  <mn>1</mn>
                  <mo>†</mo>
                </msubsup>
                <mo>⁢</mo>
                <msub>
                  <mi>a</mi>
                  <mn>2</mn>
                </msub>
                <mo>⁢</mo>
                <msubsup>
                  <mi>a</mi>
                  <mn>2</mn>
                  <mo>†</mo>
                </msubsup>
              </mrow>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_E16" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">
<span class="sci-ico-fileFormula"></span><strong>(16)</strong>
</h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mi>H</mi>
              <mo>=</mo>
              <mrow>
                <munder>
                  <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                  <mi>i</mi>
                </munder>
                <msub>
                  <mi>H</mi>
                  <mi>i</mi>
                </msub>
              </mrow>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_Ex53" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <msub>
                  <mi>H</mi>
                  <mi>i</mi>
                </msub>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>00</mn>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">⟨</mo>
                    <mn>00</mn>
                    <mo fence="true" stretchy="false">|</mo>
                    <mo>+</mo>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>11</mn>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">⟨</mo>
                    <mn>11</mn>
                    <mo fence="true" stretchy="false">|</mo>
                    <mo>+</mo>
                    <mo fence="true" stretchy="false">|</mo>
                    <mn>22</mn>
                    <mo stretchy="false">⟩</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">⟨</mo>
                    <mn>22</mn>
                    <mo fence="true" stretchy="false">|</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_Ex54" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mrow>
                  <mo stretchy="false">⟨</mo>
                  <mi>A</mi>
                  <mo stretchy="false">⟩</mo>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mfrac>
                    <mn>1</mn>
                    <mi>Z</mi>
                  </mfrac>
                  <mo>⁢</mo>
                  <mtext>tr</mtext>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">[</mo>
                    <mrow>
                      <mi>A</mi>
                      <mo>⁢</mo>
                      <mrow>
                        <mi>exp</mi>
                        <mo>⁡</mo>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <mrow>
                            <mo>-</mo>
                            <mrow>
                              <mi>β</mi>
                              <mo>⁢</mo>
                              <mi>H</mi>
                            </mrow>
                          </mrow>
                          <mo stretchy="false">)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo stretchy="false">]</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_Ex55" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mi>Z</mi>
                <mo>=</mo>
                <mrow>
                  <mtext>tr</mtext>
                  <mo>⁢</mo>
                  <mrow>
                    <mo stretchy="false">[</mo>
                    <mrow>
                      <mi>exp</mi>
                      <mo>⁡</mo>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mrow>
                          <mo>-</mo>
                          <mrow>
                            <mi>β</mi>
                            <mo>⁢</mo>
                            <mi>H</mi>
                          </mrow>
                        </mrow>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </mrow>
                    <mo stretchy="false">]</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_Ex56" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mtable columnalign="left">
              <mtr>
                <mtd>
                  <mi>Z</mi>
                  <mo>=</mo>
                  <mtext> </mtext>
                  <mtext>tr</mtext>
                  <mtext> </mtext>
                  <mo stretchy="false">[</mo>
                  <mi>exp</mi>
                  <mo stretchy="false">(</mo>
                  <mo>−</mo>
                  <mi>β</mi>
                  <mi>H</mi>
                  <mo stretchy="false">)</mo>
                  <mo stretchy="false">]</mo>
                  <mo>=</mo>
                  <munder>
                    <mstyle displaystyle="true" mathsize="140%">
                      <mo>∑</mo>
                    </mstyle>
                    <mi>n</mi>
                  </munder>
                  <mfrac>
                    <mrow>
                      <msup>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <mo>−</mo>
                          <mi>β</mi>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mi>n</mi>
                      </msup>
                    </mrow>
                    <mrow>
                      <mi>n</mi>
                      <mo>!</mo>
                    </mrow>
                  </mfrac>
                  <mtext>tr</mtext>
                  <msup>
                    <mi>H</mi>
                    <mi>n</mi>
                  </msup>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mtext> </mtext>
                  <mo>=</mo>
                  <munder>
                    <mstyle displaystyle="true" mathsize="140%">
                      <mo>∑</mo>
                    </mstyle>
                    <mi>n</mi>
                  </munder>
                  <munder>
                    <mstyle displaystyle="true" mathsize="140%">
                      <mo>∑</mo>
                    </mstyle>
                    <mrow>
                      <msub>
                        <mi>i</mi>
                        <mn>1</mn>
                      </msub>
                      <mtext>…</mtext>
                      <msub>
                        <mi>i</mi>
                        <mi>n</mi>
                      </msub>
                    </mrow>
                  </munder>
                  <mfrac>
                    <mrow>
                      <msup>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <mo>−</mo>
                          <mi>β</mi>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mi>n</mi>
                      </msup>
                    </mrow>
                    <mrow>
                      <mi>n</mi>
                      <mo>!</mo>
                    </mrow>
                  </mfrac>
                  <mtext> </mtext>
                  <mtext> </mtext>
                  <mrow>
                    <mo>〈</mo>
                    <mrow>
                      <msub>
                        <mi>i</mi>
                        <mn>1</mn>
                      </msub>
                      <mo>|</mo>
                      <mi>H</mi>
                      <mo>|</mo>
                      <msub>
                        <mi>i</mi>
                        <mn>2</mn>
                      </msub>
                    </mrow>
                    <mo>〉</mo>
                  </mrow>
                  <mtext> </mtext>
                  <mtext>…</mtext>
                  <mtext> </mtext>
                  <mtext> </mtext>
                  <mrow>
                    <mo>〈</mo>
                    <mrow>
                      <msub>
                        <mi>i</mi>
                        <mi>n</mi>
                      </msub>
                      <mo>|</mo>
                      <mi>H</mi>
                      <mo>|</mo>
                      <msub>
                        <mi>i</mi>
                        <mn>1</mn>
                      </msub>
                    </mrow>
                    <mo>〉</mo>
                  </mrow>
                  <mtext> </mtext>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mtext> </mtext>
                  <mo>=</mo>
                  <munder>
                    <mstyle displaystyle="true" mathsize="140%">
                      <mo>∑</mo>
                    </mstyle>
                    <mi>x</mi>
                  </munder>
                  <msub>
                    <mi>p</mi>
                    <mi>x</mi>
                  </msub>
                  <mo>,</mo>
                </mtd>
              </mtr>
            </mtable>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_Ex59" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mo stretchy="false">⟨</mo>
                <mi>A</mi>
                <mo stretchy="false">⟩</mo>
              </mrow>
              <mo>=</mo>
              <mrow>
                <mfrac>
                  <mn>1</mn>
                  <mi>Z</mi>
                </mfrac>
                <mo>⁢</mo>
                <mrow>
                  <munder>
                    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                    <mi>x</mi>
                  </munder>
                  <mrow>
                    <msub>
                      <mi>p</mi>
                      <mi>x</mi>
                    </msub>
                    <mo>⁢</mo>
                    <msub>
                      <mi>A</mi>
                      <mi>x</mi>
                    </msub>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalFigs" id="ModalSchemeS4_Ex60" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title"><span class="sci-ico-fileFormula"></span></h4>
</div>
<div class="modal-body"><math display="block">
            <mrow>
              <mrow>
                <mi>H</mi>
                <mo>=</mo>
                <mrow>
                  <munder>
                    <mo largeop="true" movablelimits="false" symmetric="true">∑</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>⁢</mo>
                      <mi>j</mi>
                      <mo>⁢</mo>
                      <mi>k</mi>
                      <mo>⁢</mo>
                      <mi>l</mi>
                    </mrow>
                  </munder>
                  <mrow>
                    <msub>
                      <mi>H</mi>
                      <mrow>
                        <mi>i</mi>
                        <mo>⁢</mo>
                        <mi>j</mi>
                        <mo>⁢</mo>
                        <mi>k</mi>
                        <mo>⁢</mo>
                        <mi>l</mi>
                      </mrow>
                    </msub>
                    <mo>⁢</mo>
                    <msub>
                      <mi>a</mi>
                      <mi>i</mi>
                    </msub>
                    <mo>⁢</mo>
                    <msub>
                      <mi>a</mi>
                      <mi>j</mi>
                    </msub>
                    <mo>⁢</mo>
                    <msubsup>
                      <mi>a</mi>
                      <mi>k</mi>
                      <mo>†</mo>
                    </msubsup>
                    <mo>⁢</mo>
                    <msubsup>
                      <mi>a</mi>
                      <mi>l</mi>
                      <mo>†</mo>
                    </msubsup>
                  </mrow>
                </mrow>
              </mrow>
              <mo>,</mo>
            </mrow>
          </math></div>
</div></div></div>
<div class="modal fade ModalDefault" id="ModalArticles" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog"><div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><h4 class="modal-title">How to cite</h4>
</div>
<div class="modal-body">
<p id="citation"></p>
<input id="citationCut" type="text" value=""><a class="copyLink" data-clipboard-target="#citationCut"><span class="glyphBtn copyIcon"></span>copy</a>
</div>
</div></div></div>
<script type="text/javascript">
            function currentDate() {
            var today = new Date();
            var months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']
            today.setTime(today.getTime());
            return today.getDate() + " " + months[today.getMonth()] + " " + today.getFullYear();
            }
            var citation = 'Brod, Daniel JostBosons vs. Fermions – A computational complexity perspective. Revista Brasileira de Ensino de Física [online]. 2021, v. 43, n. Suppl 1 [Accessed CURRENTDATE] , e20200403. Available from: &lt;https://doi.org/10.1590/1806-9126-RBEF-2020-0403&gt;. Epub 05 Mar 2021. ISSN 1806-9126. https://doi.org/10.1590/1806-9126-RBEF-2020-0403.'.replace('CURRENTDATE', currentDate());
            document.getElementById('citation').innerHTML = citation;
            document.getElementById('citationCut').value = citation.replace('&lt;', '<').replace('&gt;', ">");
        </script>
</div>

        
      
      <div class="floatingMenuCtt">
  <a class="floatingMenuItem fm-button-child item-goto" data-fm-label="Ir para o topo" href="#top">
    <span class="sci-ico-top glyphFloatMenu"></span>
  </a>

  <a href="javascript:;" class="floatingMenuItem fm-button-child item-download" data-fm-label="PDFs" data-toggle="modal" data-target="#ModalDownloads">
    <span class="sci-ico-download glyphFloatMenu"></span>
  </a>

  
  <a href="javascript:;" data-toggle="modal" data-target="#metric_modal_id" class="floatingMenuItem fm-button-child item-metrics" data-fm-label="Métricas" target="_blank">
    <span class="sci-ico-metrics glyphFloatMenu"></span>
  </a>
  

  <ul class="floatingMenu fm-slidein" data-fm-toogle="hover">
    <li class="fm-wrap">
      <a href="javascript:;" class="fm-button-main">
        <span class="sci-ico-floatingMenuDefault glyphFloatMenu"></span>
        <span class="sci-ico-floatingMenuClose glyphFloatMenu"></span>
      </a>
      <ul class="fm-list">
        
          
          <li>
            <a class="fm-button-child" data-fm-label="Figuras e tabelas" data-toggle="modal" data-target="#ModalTablesFigures">
              <span class="sci-ico-figures glyphFloatMenu"></span>
            </a>
          </li>
        
        <li>
          <a class="fm-button-child" data-fm-label="Versões e traduções" data-toggle="modal" data-target="#ModalVersionsTranslations">
            <span class="sci-ico-translation glyphFloatMenu"></span>
          </a>
        </li>
        <li>
          <a class="fm-button-child" data-fm-label="Como citar este artigo" data-toggle="modal" data-target="#ModalArticles">
            <span class="sci-ico-citation glyphFloatMenu"></span>
          </a>
        </li>
        <li>
          <a class="fm-button-child" data-fm-label="Artigos relacionados" data-toggle="modal" data-target="#ModalRelatedArticles">
            <span class="sci-ico-similar glyphFloatMenu"></span>
          </a>
        </li>
      </ul>
    </li>
  </ul>
</div>

<!-- FLOATING MENU ONLY FOR IPAD-->
<ul class="floatingMenuMobile fm-slidein" data-fm-toogle="hover">
  <li class="fm-wrap">
    <a href="javascript:;" class="fm-button-main">
      <span class="sci-ico-floatingMenuDefault glyphFloatMenu"></span>
      <span class="sci-ico-floatingMenuClose glyphFloatMenu"></span>
    </a>
    <ul class="fm-list">
      <li>
        <a class="fm-button-child item-goto" data-fm-label="Ir para o topo" href="#top">
          <span class="sci-ico-top glyphFloatMenu"></span>
        </a>
      </li>
      <li>
        <a class="fm-button-child item-download" data-fm-label="PDFs" data-toggle="modal" data-target="#ModalDownloads" href="#">
          <span class="sci-ico-download glyphFloatMenu"></span>
        </a>
      </li>
      <li>
        <a data-toggle="modal" data-target="#metric_modal_id" class="fm-button-child item-metrics" data-fm-label="Métricas" href="#" target="_blank">
          <span class="sci-ico-metrics glyphFloatMenu"></span>
        </a>
      </li>
      
        
        <li>
          <a class="fm-button-child" data-fm-label="Figuras e tabelas" data-toggle="modal" data-target="#ModalTablesFigures" href="#">
            <span class="sci-ico-figures glyphFloatMenu"></span>
          </a>
        </li>
      
      <li>
        <a class="fm-button-child" data-fm-label="Versões e traduções" data-toggle="modal" data-target="#ModalVersionsTranslations" href="#">
          <span class="sci-ico-translation glyphFloatMenu"></span>
        </a>
      </li>
      <li>
        <a class="fm-button-child" data-fm-label="Como citar este artigo" data-toggle="modal" data-target="#ModalArticles" href="#">
          <span class="sci-ico-citation glyphFloatMenu"></span>
        </a>
      </li>
      <li>
        <a class="fm-button-child" data-fm-label="Artigos e similares" data-toggle="modal" data-target="#ModalRelatedArticles" href="#">
          <span class="sci-ico-similar glyphFloatMenu"></span>
        </a>
      </li>
    </ul>
  </li>
</ul>
<!-- FLOATING MENU ONLY FOR IPAD-->

      <section class="journalContacts">
  <div class="container">
    <div class="col-md-5 col-sm-5 journalAddress">
      <div class="col-md-1 col-sm-2">
        <span class="glyphBtn pin"></span>
      </div>
      <div class="col-md-10 col-sm-9">
        <strong>Sociedade Brasileira de Física</strong>
        
          Caixa Postal 66328, 05389-970 São Paulo  SP -  Brazil -
        
        
          São Paulo -
        
        
           SP -
        
        
           Brazil <br/>
        
        
        
          <b>E-mail:</b> marcio@sbfisica.org.br
        
      </div>
    </div>
    <div id="followus" class="col-md-4 col-sm-4 journalLinks">
      
    </div>
    <div class="col-md-3 col-sm-3 journalLinks">
      <a href="/journal/rbef/feed/" data-toggle="tooltip" title="RSS do número mais recente do periódico" target="_blank">
        <span class="glyphBtn bigRSS"></span>
      </a>
      <span class="text" style="width: 70%;">
        Acompanhe os números deste periódico no seu leitor de RSS
      </span>
    </div>
    <div class="clearfix"></div>
  </div>
</section>

      



  <div class="modal fade ModalDefault" id="ModalDownloads" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">
          <span aria-hidden="true">&times;</span><span class="sr-only">Fechar</span>
        </button>
        <h4 class="modal-title">Versão para download de PDF</h4>
      </div>
      <div class="modal-body">
        <div class="row modal-center">

          
            <div class="col-md-12">
              <span class="sci-ico-filePDF"></span>
              <br/>
              <strong>PDF</strong>
              <ul class="md-list">
              
                
                  <li>
                    <a target='_blank' href="/j/rbef/a/JDtGnH8jDn8yCKwXBfFXMpR/?lang=en&amp;format=pdf">
                      
                        Inglês
                      
                    </a>
                  </li>
                
              
              </ul>
            </div>
          
          
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="modal fade ModalDefault" id="ModalRelatedArticles" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">
          <span aria-hidden="true">&times;</span>
          <span class="sr-only">Fechar</span>
        </button>
        <h4 class="modal-title">Artigos relacionados</h4>
      </div>
      <div class="modal-body">
        <div class="modal-center">
          <ul class="md-list inline">
            
              <li>
                <a href="https://www.google.com/search?q=&#34;Bosons vs. Fermions – A computational complexity perspective&#34; &#34;Brod, Daniel Jost&#34; &#34;2021&#34; &#34;Revista Brasileira de Ensino de Física&#34;" target="_blank">
                  Google
                </a>
              </li>
            
              <li>
                <a href="https://scholar.google.com/scholar?q=&#34;Bosons vs. Fermions – A computational complexity perspective&#34; &#34;Brod, Daniel Jost&#34; &#34;2021&#34; &#34;Revista Brasileira de Ensino de Física&#34;" target="_blank">
                  Google Scholar
                </a>
              </li>
            
          </ul>
          <div class="clearfix"></div>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="modal fade ModalDefault" id="ModalVersionsTranslations" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title">Versões e tradução automática</h4>
      </div>
      <div class="modal-body">
        <div class="row modal-center">
          <div class="col-md-4 col-md-offset-1">
            <strong>Versão original do texto</strong>
            <ul class="md-list">
            
              
                <li>
                  <a href="/j/rbef/a/JDtGnH8jDn8yCKwXBfFXMpR/?lang=en">English</a>
                </li>
              
            
            </ul>
          </div>
          <div class="col-md-2 md-body-dashVertical"></div>
          <div class="col-md-4">
            <strong>Tradução automática</strong>
            <ul class="md-list">
              <li><a href="">Google Translator</a></li>
              <li><a href="">Microsoft Translator</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

    
  
  <footer>
  <div class="collectionSignature">
    <div class="container">
      <div class="col-md-2 col-sm-2">
        <span class="logo-svg-footer"></span>
      </div>
      <div class="col-md-8 col-sm-9">
        <strong>SciELO - Scientific Electronic Library Online</strong><br/>
        Rua Dr. Diogo de Faria, 1087 – 9º andar – Vila Clementino 04037-003 São Paulo/SP - Brasil<br/>
        E-mail: scielo@scielo.org 
      </div>
    </div>
  </div>
  
    <div class="partners">
      
        
          <a href="http://www.fapesp.br/" target="_blank">
            
                <img src="https://www.scielo.br/media/images/FAPESP.png" alt="FAPESP">
            
          </a>
        
      
        
          <a href="http://www.capes.gov.br/" target="_blank">
            
                <img src="https://www.scielo.br/media/images/CAPES.png" alt="CAPES">
            
          </a>
        
      
        
          <a href="http://www.cnpq.br/" target="_blank">
            
                <img src="https://www.scielo.br/media/images/CNPq.png" alt="CNPq">
            
          </a>
        
      
        
          <a href="http://bvsalud.org/" target="_blank">
            
                <img src="https://www.scielo.br/media/images/BVS.png" alt="BVS">
            
          </a>
        
      
        
          <a href="http://regional.bvsalud.org/bvs/bireme/homepage.htm" target="_blank">
            
                <img src="https://www.scielo.br/media/images/BIREME.png" alt="BIREME">
            
          </a>
        
      
        
          <a href="https://www.fapunifesp.edu.br/" target="_blank">
            
                <img src="https://www.scielo.br/media/images/FAP-UNIFESP.png" alt="FAP-UNIFESP">
            
          </a>
        
      
    </div>
  

  <div class="container collectionLicense">
    <a href="/about/">
      <img alt="Open Access" style="border-width:0" class="image" src="/static/img/oa_logo_32.png">
      <span>
        <strong>Leia</strong> a Declaração de Acesso Aberto
      </span>
    </a>
  </div>

</footer>

  

  <div class="modal fade ModalDefault" id="metric_modal_id" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content" style="width: 673px;">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Fechar</span></button>
          <h4 class="modal-title">Métricas</h4>
        </div>
        <div class="modal-body row" style="margin-left: 30px;">
            

                
                    <div class="col-md-4">
                        <div class="badge-link col-center">
                            <a target="_blank"
                                href="http://analytics.scielo.org/w/accesses?document=S1806-11172021000500217&amp;collection=scl">
                                <div class="logo-statistc logo-statistc-scielo"></div>
                                <div>SciELO Analytics</div>
                            </a>
                        </div>
                    </div>
                

                
                    
                    <div class="col-md-4">
                        <div class="badge-link col-center">
                            <div class="logo-statistc logo-statistc-dimension">
                                <div class="badge-logo">
                                    <span class="__dimensions_badge_embed__" data-doi="10.1590/1806-9126-RBEF-2020-0403" data-legend="never"
                                        data-style="small_circle">
                                    </span>
                                </div>
                            </div>
                            <a target="_blank" href="https://badge.dimensions.ai/details/doi/10.1590/1806-9126-RBEF-2020-0403">
                                <div>Dimensions</div>
                            </a>
                        </div>
                    </div>
                    
                

                
                    <div class="col-md-4">
                        <div class="badge-link col-center">
                            <div class="logo-statistc logo-statistc-altmetric">
                                <div class="badge-logo">
                                    <div class='altmetric-embed' data-badge-type='donut' data-doi="10.1590/1806-9126-RBEF-2020-0403" data-link-target='_blank'>
                                    </div>
                                </div>
                            </div>
                            <a target="_blank" href="https://www.altmetric.com/details.php?&doi=10.1590/1806-9126-RBEF-2020-0403">
                                <div>Altmetric</div>
                            </a>
                        </div>
                    </div>
                

                
                <div class="col-md-4" style="margin-top: 50px;">
                    <div class="badge-link col-center">
                        <div id="scienceopen" data-doi="10.1590/1806-9126-RBEF-2020-0403"></div>
                    </div>
                </div>
                

                
                <div class="col-md-4" style="margin-top: 18px;">
                    <div class="badge-link col-center">
                        <div class="scite-badge" data-doi="10.1590/1806-9126-RBEF-2020-0403" data-layout="vertical" data-tooltip-placement="right"
                            data-show-zero="false" data-show-labels="false">
                        </div>
                        <a target="_blank" href="https://scite.ai/reports/10.1590/1806-9126-RBEF-2020-0403">
                            <div>Scite_</div>
                        </a>
                    </div>
                </div>
                

                
                <div class="col-md-4" style="margin-top: 50px;">
                    <div class="badge-link col-center">
                        <div class="logo-statistc logo-statistc-plumx">
                            <div class="badge-logo">
                                <a href="//cdn.plu.mx/widget-popup.js/?doi=10.1590/1806-9126-RBEF-2020-0403" data-popup="right" data-size="large"
                                    class="plumx-plum-print-popup plum-liberty-theme" data-site="plum" data-hide-when-empty="true"
                                    data-no-link="true" target="_blank">
            Bosons vs. Fermions – A computational complexity perspective
            </a>
                            </div>
                        </div>
                        <a target="_blank" href="//cdn.plu.mx/widget-popup.js/?doi=10.1590/1806-9126-RBEF-2020-0403">
                            <div>PlumX</div>
                        </a>
                    </div>
                </div>
                

            
        </div>
    </div>
  </div>
</div>



    <!-- share modal -->
    <div class="modal fade" id="share_modal_id" tabindex="-1" role="dialog" aria-hidden="true"></div>

    <div class="modal fade in" id="share_modal_confirm_id" tabindex="-1" role="dialog" aria-hidden="false">
      <div class="modal-dialog modal-sm">
          <div class="modal-content">
              <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
                  <h4 class="modal-title">Mensagem</h4>
              </div>
              <div class="modal-body">
                  <div class="midGlyph">

                      <br><br>
                  </div>
              </div>
          </div>
      </div>
    </div>
    <!-- share modal -->

    <!-- error modal -->
    <div class="modal fade" id="error_modal_id" tabindex="-1" role="dialog" aria-hidden="true"></div>

    <div class="modal fade in" id="error_modal_confirm_id" tabindex="-1" role="dialog" aria-hidden="false">
      <div class="modal-dialog modal-sm">
          <div class="modal-content">
              <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
                  <h4 class="modal-title">Mensagem</h4>
              </div>
              <div class="modal-body">
                  <div class="midGlyph">
                  </div>
              </div>
          </div>
      </div>
    </div>

    <a class="floatingBtnError" href="#" id="#floatingBtnError"></a>
    <!-- error modal -->

    <script src="/static/js/scielo-bundle-min.js"></script>

    
      <script src="https://static.scielo.org/js/cookiePolicy.min.js"></script>
    

    <script src="//www.google.com/recaptcha/api.js"></script>

    
  <script type="text/javascript" src="/static/js/scielo-article-min.js"></script>

  
    <script type="text/javascript" src="//cdn.plu.mx/widget-popup.js"></script>
  

  
    <script type="text/javascript" src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>
  

  
    <script id="9cf9cf8f-3a99-fe86-4013-f630edbf80ac" src="https://www.scienceopen.com/script/badge2.js" async defer></script>
    <script type="text/javascript" src="/static/js/scienceopen.js"></script>
  

  
    <script async type="application/javascript" src="//cdn.scite.ai/badge/scite-badge-latest.min.js"></script>
  

  
    <script sync src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_SVG" charset="utf-8"></script>

    <script>
      var insertScript = function(url, callback, parentNode) {
        var scriptNode = document.createElement("script");
        scriptNode.src = url;
        scriptNode.onload = callback;
        parentNode.appendChild(scriptNode)
      }
      var headNode = document.getElementsByTagName("head")[0];
      setTimeout(MathJax.Callback([insertScript, "//badge.dimensions.ai/badge.js", console.log, headNode]), 1500);
    </script>
  

  <!-- Verifica se o artigo contém artigos relacionados -->
  

  <!-- Verifica se o artigo contém suplemento -->
  



    <script>

      // Garante que o valor do campo share_url é a URL corrente.
      $('#share_url').val(window.location.href);

      moment.locale('pt_BR');

      $("#date").text(moment().format("L HH:mm:ss ZZ"));

    </script>

    
    
  </body>
</html>